function l(a,b,c,d){a.G.lc(a.pc,b,c,d)}function aa(a,b,c){return a.G.yf(a.pc,b,c)}function ba(a,b,c,d){a.G.Ca?l(a,b,c,d):a.G.mh()._OnMessageFromDOM({type:"event",component:a.pc,handler:b,dispatchOpts:d||null,data:c,responseId:null})}function n(a,b,c){a.G.K(a.pc,b,c)}function ca(a,b){for(const [c,d]of b)n(a,c,d)}function da(a){a.nd||(a.G.zf(a.og),a.nd=!0)}window.ec=class{constructor(a,b){this.G=a;this.pc=b;this.nd=!1;this.og=()=>this.na()}nf(){}na(){}};
window.ai=class{constructor(){this.ff=-1}o(){-1!==this.ff&&(self.clearTimeout(this.ff),this.ff=-1)}};"use strict";class ea{constructor(a){this.ye=a;this.De=!1;this.Oe=!0}}function fa(a,b){const c=b.elementId,d=a.Wc(c,b),e=new ea(d);a.tc.set(c,e);d.style.boxSizing="border-box";d.style.display="none";e.Oe=!!b.isVisible;b=a.je(d);b.addEventListener("focus",()=>{ja(a,"elem-focused",c)});b.addEventListener("blur",()=>{ja(a,"elem-blurred",c)});a.dd&&document.body.appendChild(d)}
function q(a,b,c){n(a,b,d=>{const e=u(a,d.elementId);return c(e,d)})}function u(a,b){a=a.tc.get(b);if(!a)throw Error(`no element with id ${b}`);return a.ye}function ja(a,b,c,d){d||(d={});d.elementId=c;l(a,b,d)}function ka(a,b,c,d){d||(d={});d.elementId=c;ba(a,b,d)}
window.Vd=class extends self.ec{constructor(a,b){super(a,b);this.tc=new Map;this.dd=!0;ca(this,[["create",c=>fa(this,c)],["destroy",c=>{c=c.elementId;const d=u(this,c);this.dd&&d.parentElement.removeChild(d);this.tc.delete(c)}],["set-visible",c=>{if(this.dd){var d=this.tc.get(c.elementId),e=d.ye;d.De?e.style.display=c.isVisible?"":"none":d.Oe=!!c.isVisible}}],["update-position",c=>{if(this.dd){var d=this.tc.get(c.elementId),e=d.ye;e.style.left=c.left+"px";e.style.top=c.top+"px";e.style.width=c.width+
"px";e.style.height=c.height+"px";c=c.fontSize;null!==c&&(e.style.fontSize=c+"em");d.De||(d.De=!0,d.Oe&&(e.style.display=""))}}],["update-state",c=>{const d=u(this,c.elementId);this.sb(d,c)}],["focus",c=>{const d=this.je(u(this,c.elementId));c.focus?d.focus():d.blur()}],["set-css-style",c=>{const d=u(this,c.elementId),e=c.prop;c=c.val;e.startsWith("--")?d.style.setProperty(e,c):d.style[e]=c}],["set-attribute",c=>{u(this,c.elementId).setAttribute(c.name,c.val)}],["remove-attribute",c=>{u(this,c.elementId).removeAttribute(c.name)}]]);
q(this,"get-element",c=>c)}Wc(){throw Error("required override");}sb(){throw Error("required override");}je(a){return a}};"use strict";const la=/(iphone|ipod|ipad|macos|macintosh|mac os x)/i.test(navigator.userAgent),ma=/android/i.test(navigator.userAgent),na=/safari/i.test(navigator.userAgent)&&!/(chrome|chromium|edg\/|OPR\/|nwjs)/i.test(navigator.userAgent);let oa=0;
function pa(a){const b=document.createElement("script");b.async=!1;b.type="module";return a.Rh?new Promise(c=>{const d="c3_resolve_"+oa;++oa;self[d]=c;b.textContent=a.Vh+`\n\nself["${d}"]();`;document.head.appendChild(b)}):new Promise((c,d)=>{b.onload=c;b.onerror=d;b.src=a;document.head.appendChild(b)})}let qa=!1,ra=!1;function sa(){if(!qa){try{new Worker("blob://",{get type(){ra=!0}})}catch(a){}qa=!0}return ra}let z=new Audio;
const ua={"audio/webm; codecs=opus":!!z.canPlayType("audio/webm; codecs=opus"),"audio/ogg; codecs=opus":!!z.canPlayType("audio/ogg; codecs=opus"),"audio/webm; codecs=vorbis":!!z.canPlayType("audio/webm; codecs=vorbis"),"audio/ogg; codecs=vorbis":!!z.canPlayType("audio/ogg; codecs=vorbis"),"audio/mp4":!!z.canPlayType("audio/mp4"),"audio/mpeg":!!z.canPlayType("audio/mpeg")};z=null;async function va(a){a=await wa(a);return(new TextDecoder("utf-8")).decode(a)}
function wa(a){return new Promise((b,c)=>{const d=new FileReader;d.onload=e=>b(e.target.result);d.onerror=e=>c(e);d.readAsArrayBuffer(a)})}const xa=[];let ya=0;window.RealFile=window.File;const za=[],Aa=new Map,Ba=new Map;let Ca=0;const Da=[];self.runOnStartup=function(a){if("function"!==typeof a)throw Error("runOnStartup called without a function");Da.push(a)};const Ea=new Set(["cordova","playable-ad","instant-games"]);let Fa=!1;
window.hb=class a{constructor(b){this.Ca=b.Xh;this.kb=null;this.Ba="";this.Yb=b.Uh;this.Tc={};this.Pb=this.fb=null;this.jd=[];this.V=this.Va=null;this.Le=!1;this.Rf=0;this.Bc=null;this.Wb=-1;this.Jh=()=>this.uh();this.Vb=[];this.gf=null;this.pg=[];this.I=b.qg;this.od="file"===location.protocol.substr(0,4);!this.Ca||"undefined"!==typeof OffscreenCanvas&&navigator.userActivation&&sa()||(this.Ca=!1);this.Ca&&na&&(this.Ca=!1);if("playable-ad"===this.I||"instant-games"===this.I)this.Ca=!1;if("cordova"===
this.I&&this.Ca)if(ma){const c=/Chrome\/(\d+)/i.exec(navigator.userAgent);c&&90<=parseInt(c[1],10)||(this.Ca=!1)}else this.Ca=!1;this.jc()?self.chrome.webview.addEventListener("message",c=>this.Ef(c.data)):"macos-wkwebview"===this.I&&(self.C3WrapperOnMessage=c=>this.Ef(c));this.ud=this.$a=null;"html5"!==this.I||window.isSecureContext||console.warn("[Construct] Warning: the browser indicates this is not a secure context. Some features may be unavailable. Use secure (HTTPS) hosting to ensure all features are available.");
this.K("runtime","cordova-fetch-local-file",c=>this.qh(c));this.K("runtime","create-job-worker",()=>this.rh());this.K("runtime","send-wrapper-extension-message",c=>this.xh(c));"cordova"===this.I?document.addEventListener("deviceready",()=>this.Cf(b)):this.Cf(b)}o(){this.he();this.kb&&(this.kb=this.kb.onmessage=null);this.fb&&(this.fb.terminate(),this.fb=null);this.Pb&&(this.Pb.o(),this.Pb=null);this.V&&(this.V.parentElement.removeChild(this.V),this.V=null)}ah(){return la&&"cordova"===this.I}ae(){const b=
navigator.userAgent;return la&&Ea.has(this.I)||navigator.standalone||/crios\/|fxios\/|edgios\//i.test(b)}Zg(){return ma}vf(){return ma&&Ea.has(this.I)}jc(){return"windows-webview2"===this.I||!!("preview"===this.I&&window.chrome&&window.chrome.webview&&window.chrome.webview.postMessage)}async Cf(b){"macos-wkwebview"===this.I?this.mc({type:"ready"}):this.jc()&&(this.Ah(),this.pg=(await this.ph()).registeredComponentIds);if("playable-ad"===this.I){this.$a=self.c3_base64files;this.ud={};await this.ih();
for(let d=0,e=b.bc.length;d<e;++d){var c=b.bc[d];this.ud.hasOwnProperty(c)?b.bc[d]={Rh:!0,Vh:this.ud[c]}:this.$a.hasOwnProperty(c)&&(b.bc[d]=URL.createObjectURL(this.$a[c]))}b.Qd=[]}if("nwjs"===this.I&&self.nw&&self.nw.App.manifest["c3-steam-mode"]){let d=0;this.zf(()=>{d++;document.body.style.opacity=0===d%2?"1":"0.999"})}b.Th?this.Ba=b.Th:(c=location.origin,this.Ba=("null"===c?"file:///":c)+location.pathname,c=this.Ba.lastIndexOf("/"),-1!==c&&(this.Ba=this.Ba.substr(0,c+1)));b.Zh&&(this.Tc=b.Zh);
c=new MessageChannel;this.kb=c.port1;this.kb.onmessage=d=>this._OnMessageFromRuntime(d.data);window.c3_addPortMessageHandler&&window.c3_addPortMessageHandler(d=>this.th(d));this.Bc=new self.bh(this);await Ga(this.Bc);"object"===typeof window.StatusBar&&window.StatusBar.hide();if("object"===typeof window.AndroidFullScreen)try{await new Promise((d,e)=>{window.AndroidFullScreen.immersiveMode(d,e)})}catch(d){console.error("Failed to enter Android immersive mode: ",d)}this.Ca?await this.oh(b,c.port2):
await this.nh(b,c.port2)}ke(b){b=this.Tc.hasOwnProperty(b)?this.Tc[b]:b.endsWith("/workermain.js")&&this.Tc.hasOwnProperty("workermain.js")?this.Tc["workermain.js"]:"playable-ad"===this.I&&this.$a.hasOwnProperty(b)?this.$a[b]:b;b instanceof Blob&&(b=URL.createObjectURL(b));return b}async Ud(b,c,d){if(b.startsWith("blob:"))return new Worker(b,d);if("cordova"===this.I&&this.od)return b=await this.Vc(d.Qh?b:this.Yb+b),new Worker(URL.createObjectURL(new Blob([b],{type:"application/javascript"})),d);b=
new URL(b,c);if(location.origin!==b.origin){b=await fetch(b);if(!b.ok)throw Error("failed to fetch worker script");b=await b.blob();return new Worker(URL.createObjectURL(b),d)}return new Worker(b,d)}Xa(){return Math.max(window.innerWidth,1)}Na(){return Math.max(window.innerHeight,1)}Bf(b){var c=this.Ba,d=location.href,e=this.Xa(),f=this.Na(),g=window.devicePixelRatio,h=a.ic(),k=b.di,v=window.cr_previewImageBlobs||this.$a,p=window.cr_previewProjectFileBlobs,D=window.cr_previewProjectFiles,y=window.cr_swClientId||
"";b=b.qg;var r=(new URLSearchParams(self.location.search)).has("debug"),t=this.Bc;return{runtimeBaseUrl:c,previewUrl:d,windowInnerWidth:e,windowInnerHeight:f,devicePixelRatio:g,isFullscreen:h,projectData:k,previewImageBlobs:v,previewProjectFileBlobs:p,previewProjectFileSWUrls:D,swClientId:y,exportType:b,isDebug:r,ife:!!self.ci,jobScheduler:{inputPort:t.Je,outputPort:t.Xe,maxNumWorkers:t.Eh},supportedAudioFormats:ua,opusWasmScriptUrl:window.cr_opusWasmScriptUrl||this.Yb+"opus.wasm.js",opusWasmBinaryUrl:window.cr_opusWasmBinaryUrl||
this.Yb+"opus.wasm.wasm",isFileProtocol:this.od,isiOSCordova:this.ah(),isiOSWebView:this.ae(),isWebView2Wrapper:this.jc(),wrapperComponentIds:this.pg,isFBInstantAvailable:"undefined"!==typeof self.FBInstant}}async oh(b,c){const d=this.ke(b.Yh);"preview"===this.I?(this.fb=new Worker("previewworker.js",{type:"module",name:"Runtime"}),await new Promise((h,k)=>{const v=p=>{this.fb.removeEventListener("message",v);p.data&&"ok"===p.data.type?h():k()};this.fb.addEventListener("message",v);this.fb.postMessage({type:"construct-worker-init",
"import":(new URL(d,this.Ba)).toString()})})):this.fb=await this.Ud(d,this.Ba,{type:"module",name:"Runtime",Qh:!0});this.V=document.createElement("canvas");this.V.style.display="none";const e=this.V.transferControlToOffscreen();document.body.appendChild(this.V);window.c3canvas=this.V;self.C3_InsertHTMLPlaceholders&&self.C3_InsertHTMLPlaceholders();let f=b.Qd||[],g=b.bc;f=await Promise.all(f.map(h=>this.Jb(h)));g=await Promise.all(g.map(h=>this.Jb(h)));if("cordova"===this.I)for(let h=0,k=b.Pd.length;h<
k;++h){const v=b.Pd[h],p=v[0];if(p===b.kf||"scriptsInEvents.js"===p||p.endsWith("/scriptsInEvents.js"))v[1]=await this.Jb(p)}this.fb.postMessage(Object.assign(this.Bf(b),{type:"init-runtime",isInWorker:!0,messagePort:c,canvas:e,workerDependencyScripts:f,engineScripts:g,projectScripts:b.Pd,mainProjectScript:b.kf,projectScriptsStatus:self.C3_ProjectScriptsStatus}),[c,e,...Ha(this.Bc)]);this.jd=za.map(h=>new h(this));this.Af();Ia(this.Va);self.c3_callFunction=(h,k)=>aa(this.Va,"js-invoke-function",{name:h,
params:k});"preview"===this.I&&(self.goToLastErrorScript=()=>this.lc("runtime","go-to-last-error-script"))}async nh(b,c){this.V=document.createElement("canvas");this.V.style.display="none";document.body.appendChild(this.V);window.c3canvas=this.V;self.C3_InsertHTMLPlaceholders&&self.C3_InsertHTMLPlaceholders();this.jd=za.map(g=>new g(this));this.Af();var d=b.bc.map(g=>"string"===typeof g?(new URL(g,this.Ba)).toString():g);if(Array.isArray(b.Qd)){var e=[...b.Qd].map(g=>g instanceof Blob?URL.createObjectURL(g):
g);d.unshift(...e)}d=await Promise.all(d.map(g=>this.Jb(g)));await Promise.all(d.map(g=>pa(g)));d=self.C3_ProjectScriptsStatus;e=b.kf;const f=b.Pd;for(let [g,h]of f)if(h||(h=g),g===e)try{h=await this.Jb(h),await pa(h),"preview"!==this.I||d[g]||this.Ff(g,"main script did not run to completion")}catch(k){this.Ff(g,k)}else if("scriptsInEvents.js"===g||g.endsWith("/scriptsInEvents.js"))h=await this.Jb(h),await pa(h);"preview"===this.I&&"object"!==typeof self.$h.bi?(this.ad(),console.error("[C3 runtime] Failed to load JavaScript code used in events. Check all your JavaScript code has valid syntax."),
alert("Failed to load JavaScript code used in events. Check all your JavaScript code has valid syntax.")):(b=Object.assign(this.Bf(b),{isInWorker:!1,messagePort:c,canvas:this.V,runOnStartupFunctions:Da}),Ia(this.Va),this.Df(),this.Pb=self.C3_CreateRuntime(b),await self.C3_InitRuntime(this.Pb,b))}Ff(b,c){this.ad();console.error(`[Preview] Failed to load project main script (${b}): `,c);alert(`Failed to load project main script (${b}). Check all your JavaScript code has valid syntax. Press F12 and check the console for error details.`)}Df(){this.ad()}ad(){const b=
window.cr_previewLoadingElem;b&&(b.parentElement.removeChild(b),window.cr_previewLoadingElem=null)}async rh(){const b=await Ja(this.Bc);return{outputPort:b,transferables:[b]}}mh(){if(this.Ca)throw Error("not available in worker mode");return this.Pb}lc(b,c,d,e,f){this.kb.postMessage({type:"event",component:b,handler:c,dispatchOpts:e||null,data:d,responseId:null},f)}yf(b,c,d,e,f){const g=Ca++,h=new Promise((k,v)=>{Ba.set(g,{resolve:k,reject:v})});this.kb.postMessage({type:"event",component:b,handler:c,
dispatchOpts:e||null,data:d,responseId:g},f);return h}_OnMessageFromRuntime(b){const c=b.type;if("event"===c)return this.sh(b);if("result"===c)this.vh(b);else if("runtime-ready"===c)this.wh();else if("alert-error"===c)this.ad(),alert(b.message);else if("creating-runtime"===c)this.Df();else throw Error(`unknown message '${c}'`);}sh(b){const c=b.component,d=b.handler,e=b.data,f=b.responseId;if(b=Aa.get(c))if(b=b.get(d)){var g=null;try{g=b(e)}catch(h){console.error(`Exception in '${c}' handler '${d}':`,
h);null!==f&&this.$c(f,!1,""+h);return}if(null===f)return g;g&&g.then?g.then(h=>this.$c(f,!0,h)).catch(h=>{console.error(`Rejection from '${c}' handler '${d}':`,h);this.$c(f,!1,""+h)}):this.$c(f,!0,g)}else console.warn(`[DOM] No handler '${d}' for component '${c}'`);else console.warn(`[DOM] No event handlers for component '${c}'`)}$c(b,c,d){let e;d&&d.transferables&&(e=d.transferables);this.kb.postMessage({type:"result",responseId:b,isOk:c,result:d},e)}vh(b){const c=b.responseId,d=b.isOk;b=b.result;
const e=Ba.get(c);d?e.resolve(b):e.reject(b);Ba.delete(c)}K(b,c,d){let e=Aa.get(b);e||(e=new Map,Aa.set(b,e));if(e.has(c))throw Error(`[DOM] Component '${b}' already has handler '${c}'`);e.set(c,d)}static ob(b){if(za.includes(b))throw Error("DOM handler already added");za.push(b)}Af(){for(const b of this.jd)if("runtime"===b.pc){this.Va=b;return}throw Error("cannot find runtime DOM handler");}th(b){this.lc("debugger","message",b)}wh(){for(const b of this.jd)b.nf()}static ic(){return!!(document.fullscreenElement||
document.webkitFullscreenElement||document.mozFullScreenElement||Fa)}static Gf(b){Fa=!!b}zf(b){this.Vb.push(b);this.qe()}zh(b){b=this.Vb.indexOf(b);if(-1===b)throw Error("invalid callback");this.Vb.splice(b,1);this.Vb.length||this.he()}qe(){-1===this.Wb&&this.Vb.length&&(this.Wb=requestAnimationFrame(this.Jh))}he(){-1!==this.Wb&&(cancelAnimationFrame(this.Wb),this.Wb=-1)}uh(){this.Wb=-1;for(const b of this.Vb)b();this.qe()}rb(b){this.Va.rb(b)}Ib(b){this.Va.Ib(b)}pe(){this.Va.pe()}Zc(b){this.Va.Zc(b)}$g(){return!!ua["audio/webm; codecs=opus"]}async Bh(b){b=
await this.yf("runtime","opus-decode",{arrayBuffer:b},null,[b]);return new Float32Array(b)}eh(b){this.Le=!0;this.Rf=b}Yg(b){return/^(?:[a-z\-]+:)?\/\//.test(b)||"data:"===b.substr(0,5)||"blob:"===b.substr(0,5)}wf(b){return!this.Yg(b)}async Jb(b){return"cordova"===this.I&&(b.startsWith("file:")||this.od&&this.wf(b))?(b.startsWith(this.Ba)&&(b=b.substr(this.Ba.length)),b=await this.Vc(b),URL.createObjectURL(new Blob([b],{type:"application/javascript"}))):b}async qh(b){const c=b.filename;switch(b.as){case "text":return await this.Wg(c);
case "buffer":return await this.Vc(c);default:throw Error("unsupported type");}}rf(b){const c=window.cordova.file.applicationDirectory+"www/"+b;return new Promise((d,e)=>{window.resolveLocalFileSystemURL(c,f=>{f.file(d,e)},e)})}async Wg(b){b=await this.rf(b);return await va(b)}ie(){if(xa.length&&!(8<=ya)){ya++;var b=xa.shift();this.jh(b.filename,b.Wh,b.Oh)}}Vc(b){return new Promise((c,d)=>{xa.push({filename:b,Wh:e=>{ya--;this.ie();c(e)},Oh:e=>{ya--;this.ie();d(e)}});this.ie()})}async jh(b,c,d){try{const e=
await this.rf(b),f=await wa(e);c(f)}catch(e){d(e)}}Ef(b){if("entered-fullscreen"===b)a.Gf(!0),Ka(this.Va);else if("exited-fullscreen"===b)a.Gf(!1),Ka(this.Va);else if("object"===typeof b){const c=b.type;"wrapper-init-response"===c?(this.gf(b),this.gf=null):"extension-message"===c?this.lc("runtime","wrapper-extension-message",b):console.warn("Unknown wrapper message: ",b)}else console.warn("Unknown wrapper message: ",b)}xh(b){this.mc({type:"extension-message",componentId:b.componentId,messageId:b.messageId,
params:b.params||[],asyncId:b.asyncId})}mc(b){this.jc()?window.chrome.webview.postMessage(JSON.stringify(b)):"macos-wkwebview"===this.I&&window.webkit.messageHandlers.C3Wrapper.postMessage(JSON.stringify(b))}Ah(){window.moveTo=(b,c)=>{this.mc({type:"set-window-position",windowX:Math.ceil(b),windowY:Math.ceil(c)})};window.resizeTo=(b,c)=>{this.mc({type:"set-window-size",windowWidth:Math.ceil(b),windowHeight:Math.ceil(c)})}}ph(){return this.jc()?new Promise(b=>{this.gf=b;this.mc({type:"wrapper-init"})}):
Promise.resolve()}async ih(){const b=[];for(const [c,d]of Object.entries(this.$a))b.push(this.hh(c,d));await Promise.all(b)}async hh(b,c){if("object"===typeof c)this.$a[b]=new Blob([c.str],{type:c.type}),this.ud[b]=c.str;else{let d=await this.lh(c);d||(d=this.kh(c));this.$a[b]=d}}async lh(b){try{return await (await fetch(b)).blob()}catch(c){return console.warn("Failed to fetch a data: URI. Falling back to a slower workaround. This is probably because the Content Security Policy unnecessarily blocked it. Allow data: URIs in your CSP to avoid this.",
c),null}}kh(b){b=this.yh(b);return this.gh(b.data,b.Sh)}yh(b){var c=b.indexOf(",");if(0>c)throw new URIError("expected comma in data: uri");var d=b.substring(c+1);c=b.substring(5,c).split(";");b=c[0]||"";const e=c[2];d="base64"===c[1]||"base64"===e?atob(d):decodeURIComponent(d);return{Sh:b,data:d}}gh(b,c){var d=b.length;let e=d>>2,f=new Uint8Array(d),g=new Uint32Array(f.buffer,0,e),h,k;for(k=h=0;h<e;++h)g[h]=b.charCodeAt(k++)|b.charCodeAt(k++)<<8|b.charCodeAt(k++)<<16|b.charCodeAt(k++)<<24;for(d&=
3;d--;)f[k]=b.charCodeAt(k),++k;return new Blob([f],{type:c})}};"use strict";const La=self.hb;function Ma(a){return a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||a.originalEvent&&a.originalEvent.sourceCapabilities&&a.originalEvent.sourceCapabilities.firesTouchEvents}const Na=new Map([["OSLeft","MetaLeft"],["OSRight","MetaRight"]]),B={dispatchRuntimeEvent:!0,dispatchUserScriptEvent:!0},Oa={dispatchUserScriptEvent:!0},Pa={dispatchRuntimeEvent:!0};
function Qa(a){return new Promise((b,c)=>{const d=document.createElement("link");d.onload=()=>b(d);d.onerror=e=>c(e);d.rel="stylesheet";d.href=a;document.head.appendChild(d)})}function Ra(a){return new Promise((b,c)=>{const d=new Image;d.onload=()=>b(d);d.onerror=e=>c(e);d.src=a})}async function Sa(a){a=URL.createObjectURL(a);try{return await Ra(a)}finally{URL.revokeObjectURL(a)}}
function Ta(a){return new Promise((b,c)=>{let d=new FileReader;d.onload=e=>b(e.target.result);d.onerror=e=>c(e);d.readAsText(a)})}
async function Ua(a,b,c){if(!/firefox/i.test(navigator.userAgent))return await Sa(a);var d=await Ta(a);d=(new DOMParser).parseFromString(d,"image/svg+xml");const e=d.documentElement;if(e.hasAttribute("width")&&e.hasAttribute("height")){const f=e.getAttribute("width"),g=e.getAttribute("height");if(!f.includes("%")&&!g.includes("%"))return await Sa(a)}e.setAttribute("width",b+"px");e.setAttribute("height",c+"px");d=(new XMLSerializer).serializeToString(d);a=new Blob([d],{type:"image/svg+xml"});return await Sa(a)}
function Va(a){do{if(a.parentNode&&a.hasAttribute("contenteditable"))return!0;a=a.parentNode}while(a);return!1}const Wa=new Set(["input","textarea","datalist","select"]),Xa=new Set(["canvas","body","html"]);function H(a){a.target.tagName&&Xa.has(a.target.tagName.toLowerCase())&&a.preventDefault()}function Ya(a){(a.metaKey||a.ctrlKey)&&a.preventDefault()}
self.C3_GetSvgImageSize=async function(a){a=await Sa(a);if(0<a.width&&0<a.height)return[a.width,a.height];a.style.position="absolute";a.style.left="0px";a.style.top="0px";a.style.visibility="hidden";document.body.appendChild(a);const b=a.getBoundingClientRect();document.body.removeChild(a);return[b.width,b.height]};self.C3_RasterSvgImageBlob=async function(a,b,c,d,e){a=await Ua(a,b,c);const f=document.createElement("canvas");f.width=d;f.height=e;f.getContext("2d").drawImage(a,0,0,b,c);return f};
let Za=!1;document.addEventListener("pause",()=>Za=!0);document.addEventListener("resume",()=>Za=!1);function Ia(a){a.Qf=!0;a.Se=a.G.Xa();a.Cc=a.G.Na()}function Ka(a){if(!a.wa){var b=La.ic();b&&"any"!==a.df&&$a(a);l(a,"fullscreenchange",{isFullscreen:b,innerWidth:a.Xa(),innerHeight:a.Na()})}}async function ab(a){await Promise.all(a.webfonts.map(async b=>{b=new FontFace(b.name,`url('${b.url}')`);document.fonts.add(b);await b.load()}))}
async function bb(a){var b=a.imageBitmapOpts;a=await self.C3_RasterSvgImageBlob(a.blob,a.imageWidth,a.imageHeight,a.surfaceWidth,a.surfaceHeight);b=b?await createImageBitmap(a,b):await createImageBitmap(a);return{imageBitmap:b,transferables:[b]}}async function cb(a){return await self.C3_GetSvgImageSize(a.blob)}function db(a){window.c3_postToMessagePort&&(a.from="runtime",window.c3_postToMessagePort(a))}
function eb(a){self.setTimeout(()=>{a.Pf=!0},1E3);"cordova"===a.G.I?(document.addEventListener("pause",()=>fb(a,!0)),document.addEventListener("resume",()=>fb(a,!1))):document.addEventListener("visibilitychange",()=>fb(a,"hidden"===document.visibilityState));a.yd=!("hidden"!==document.visibilityState&&!Za);return{isSuspended:a.yd}}
function gb(a){a.If||(a.If=!0,window.addEventListener("deviceorientation",b=>{a.wa||l(a,"deviceorientation",{absolute:!!b.absolute,alpha:b.alpha||0,beta:b.beta||0,gamma:b.gamma||0,timeStamp:b.timeStamp,webkitCompassHeading:b.webkitCompassHeading,webkitCompassAccuracy:b.webkitCompassAccuracy},B)}),window.addEventListener("deviceorientationabsolute",b=>{a.wa||l(a,"deviceorientationabsolute",{absolute:!!b.absolute,alpha:b.alpha||0,beta:b.beta||0,gamma:b.gamma||0,timeStamp:b.timeStamp},B)}))}
function ib(a){a.Hf||(a.Hf=!0,window.addEventListener("devicemotion",b=>{if(!a.wa){var c=null,d=b.acceleration;d&&(c={x:d.x||0,y:d.y||0,z:d.z||0});d=null;var e=b.accelerationIncludingGravity;e&&(d={x:e.x||0,y:e.y||0,z:e.z||0});e=null;var f=b.rotationRate;f&&(e={alpha:f.alpha||0,beta:f.beta||0,gamma:f.gamma||0});l(a,"devicemotion",{acceleration:c,accelerationIncludingGravity:d,rotationRate:e,interval:b.interval,timeStamp:b.timeStamp},B)}}))}async function jb(a){await Qa(a.url)}
function kb(a,b){a.Sf=b.message;-1===a.ze&&(a.ze=setTimeout(()=>{a.ze=-1;const c=document.getElementById("exportToVideoMessage");c&&(c.textContent=a.Sf)},250))}function lb(a,b){console.warn("[Construct] Fullscreen request failed: ",b);l(a,"fullscreenerror",{isFullscreen:La.ic(),innerWidth:a.Xa(),innerHeight:a.Na()})}function fb(a,b){a.yd!==b&&((a.yd=b)?a.G.he():a.G.qe(),l(a,"visibilitychange",{hidden:b}))}
function mb(a,b,c){"Backspace"===c.key&&H(c);if(!a.wa){var d=Na.get(c.code)||c.code;ba(a,b,{code:d,key:c.key,which:c.which,repeat:c.repeat,altKey:c.altKey,ctrlKey:c.ctrlKey,metaKey:c.metaKey,shiftKey:c.shiftKey,timeStamp:c.timeStamp},B)}}function nb(a,b,c,d){a.wa||Ma(c)||ba(a,b,{button:c.button,buttons:c.buttons,clientX:c.clientX,clientY:c.clientY+a.Da,pageX:c.pageX,pageY:c.pageY+a.Da,movementX:c.movementX||0,movementY:c.movementY||0,timeStamp:c.timeStamp},d)}
function ob(a){window!==window.top&&window.focus();pb(a.target)&&document.activeElement&&!pb(document.activeElement)&&document.activeElement.blur()}
function qb(a,b,c){if(!a.wa){var d=0;"mouse"===c.pointerType&&(d=a.Hc);ba(a,b,{pointerId:c.pointerId,pointerType:c.pointerType,button:c.button,buttons:c.buttons,lastButtons:d,clientX:c.clientX,clientY:c.clientY+a.Da,pageX:c.pageX,pageY:c.pageY+a.Da,movementX:c.movementX||0,movementY:c.movementY||0,width:c.width||0,height:c.height||0,pressure:c.pressure||0,tangentialPressure:c.tangentialPressure||0,tiltX:c.tiltX||0,tiltY:c.tiltY||0,twist:c.twist||0,timeStamp:c.timeStamp},B);"mouse"===c.pointerType&&
(d="mousemove","pointerdown"===b?d="mousedown":"pointerup"===b&&(d="mouseup"),nb(a,d,c,Oa),a.Hc=c.buttons)}}
function rb(a,b,c){if(!a.wa&&!Ma(c)){var d=a.Hc;"pointerdown"===b&&0!==d?b="pointermove":"pointerup"===b&&0!==c.buttons&&(b="pointermove");ba(a,b,{pointerId:1,pointerType:"mouse",button:c.button,buttons:c.buttons,lastButtons:d,clientX:c.clientX,clientY:c.clientY+a.Da,pageX:c.pageX,pageY:c.pageY+a.Da,movementX:c.movementX||0,movementY:c.movementY||0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,timeStamp:c.timeStamp},B);a.Hc=c.buttons;nb(a,c.type,c,Oa)}}
function sb(a,b,c){if(!a.wa)for(let d=0,e=c.changedTouches.length;d<e;++d){const f=c.changedTouches[d];ba(a,b,{pointerId:f.identifier,pointerType:"touch",button:0,buttons:0,lastButtons:0,clientX:f.clientX,clientY:f.clientY+a.Da,pageX:f.pageX,pageY:f.pageY+a.Da,movementX:c.movementX||0,movementY:c.movementY||0,width:2*(f.radiusX||f.webkitRadiusX||0),height:2*(f.radiusY||f.webkitRadiusY||0),pressure:f.force||f.webkitForce||0,tangentialPressure:0,tiltX:0,tiltY:0,twist:f.rotationAngle||0,timeStamp:c.timeStamp},
B)}}function tb(a,b,c){document.body.style.transform="";a.Da=0;if(0<c){var d=document.activeElement;d&&(d=d.getBoundingClientRect(),b=(d.top+d.bottom)/2-(b-c)/2,b>c&&(b=c),0>b&&(b=0),0<b&&(document.body.style.transform=`translateY(${-b}px)`,a.Da=b))}}function ub(a,b,c,d){const e=a.Xa(),f=a.Na();a.Zb=-1;e!=b||f!=c?l(a,"window-resize",{innerWidth:e,innerHeight:f,devicePixelRatio:window.devicePixelRatio,isFullscreen:La.ic()}):10>d&&vb(a,e,f,d+1)}
function vb(a,b,c,d){-1!==a.Zb&&clearTimeout(a.Zb);a.Zb=setTimeout(()=>ub(a,b,c,d),48)}
function $a(a){a=a.df;if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(a).catch(b=>console.warn("[Construct] Failed to lock orientation: ",b));else try{let b=!1;screen.lockOrientation?b=screen.lockOrientation(a):screen.webkitLockOrientation?b=screen.webkitLockOrientation(a):screen.mozLockOrientation?b=screen.mozLockOrientation(a):screen.msLockOrientation&&(b=screen.msLockOrientation(a));b||console.warn("[Construct] Failed to lock orientation")}catch(b){console.warn("[Construct] Failed to lock orientation: ",
b)}}function pb(a){return!a||a===document||a===window||a===document.body||"canvas"===a.tagName.toLowerCase()}
La.ob(class extends self.ec{constructor(a){super(a,"runtime");this.Wf=!0;this.Qf=!1;this.Zb=-1;this.df="any";this.yd=this.Hf=this.If=!1;this.Ed=document.createElement("div");this.Ed.className="c3-screen-reader-text";this.Ed.setAttribute("aria-live","polite");document.body.appendChild(this.Ed);this.zb=null;this.wa=!1;this.Sf="";this.ze=-1;this.Pf=!1;this.Se=a.Xa();this.Cc=a.Na();this.Da=this.Sc=0;a.K("canvas","update-size",d=>{var e=this.G;e.Le||(e=e.V,e.style.width=d.styleWidth+"px",e.style.height=
d.styleHeight+"px",e.style.marginLeft=d.marginLeft+"px",e.style.marginTop=d.marginTop+"px",document.documentElement.style.setProperty("--construct-scale",d.displayScale),this.Wf&&(e.style.display="",this.Wf=!1))});a.K("runtime","invoke-download",d=>{const e=d.url;d=d.filename;const f=document.createElement("a"),g=document.body;f.textContent=d;f.href=e;f.download=d;g.appendChild(f);f.click();g.removeChild(f)});a.K("runtime","load-webfonts",d=>ab(d));a.K("runtime","raster-svg-image",d=>bb(d));a.K("runtime",
"get-svg-image-size",d=>cb(d));a.K("runtime","set-target-orientation",d=>{this.df=d.targetOrientation});a.K("runtime","register-sw",()=>{window.C3_RegisterSW&&window.C3_RegisterSW()});a.K("runtime","post-to-debugger",d=>db(d));a.K("runtime","go-to-script",d=>db(d));a.K("runtime","before-start-ticking",()=>eb(this));a.K("runtime","debug-highlight",d=>{if(d.show){this.zb||(this.zb=document.createElement("div"),this.zb.id="inspectOutline",document.body.appendChild(this.zb));var e=this.zb;e.style.display=
"";e.style.left=d.left-1+"px";e.style.top=d.top-1+"px";e.style.width=d.width+2+"px";e.style.height=d.height+2+"px";e.textContent=d.name}else this.zb&&(this.zb.style.display="none")});a.K("runtime","enable-device-orientation",()=>gb(this));a.K("runtime","enable-device-motion",()=>ib(this));a.K("runtime","add-stylesheet",d=>jb(d));a.K("runtime","script-create-worker",d=>{const e=d.port2;(new Worker(d.url,d.opts)).postMessage({type:"construct-worker-init",port2:e},[e])});a.K("runtime","alert",d=>{alert(d.message)});
a.K("runtime","screen-reader-text",d=>{var e=d.type;"create"===e?(e=document.createElement("p"),e.id="c3-sr-"+d.id,e.textContent=d.text,this.Ed.appendChild(e)):"update"===e?(e=document.getElementById("c3-sr-"+d.id))?e.textContent=d.text:console.warn(`[Construct] Missing screen reader text with id ${d.id}`):"release"===e?(e=document.getElementById("c3-sr-"+d.id))?e.remove():console.warn(`[Construct] Missing screen reader text with id ${d.id}`):console.warn(`[Construct] Unknown screen reader text update '${e}'`)});
a.K("runtime","hide-cordova-splash",()=>{navigator.splashscreen&&navigator.splashscreen.hide&&navigator.splashscreen.hide()});a.K("runtime","set-exporting-to-video",d=>{this.wa=!0;const e=document.createElement("h1");e.id="exportToVideoMessage";e.textContent=d.message;document.body.prepend(e);document.body.classList.add("exportingToVideo");this.G.V.style.display="";this.G.eh(d.duration)});a.K("runtime","export-to-video-progress",d=>kb(this,d));a.K("runtime","exported-to-video",d=>{window.Nh({type:"exported-video",
arrayBuffer:d.arrayBuffer,contentType:d.contentType,time:d.time})});a.K("runtime","exported-to-image-sequence",d=>{window.Nh({type:"exported-image-sequence",blobArr:d.blobArr,time:d.time,gif:d.gif})});const b=new Set(["input","textarea","datalist"]);window.addEventListener("contextmenu",d=>{const e=d.target;b.has(e.tagName.toLowerCase())||Va(e)||d.preventDefault()});const c=a.V;window.addEventListener("selectstart",H);window.addEventListener("gesturehold",H);c.addEventListener("selectstart",H);c.addEventListener("gesturehold",
H);window.addEventListener("touchstart",H,{passive:!1});"undefined"!==typeof PointerEvent?(window.addEventListener("pointerdown",H,{passive:!1}),c.addEventListener("pointerdown",H)):c.addEventListener("touchstart",H);this.Hc=0;window.addEventListener("mousedown",d=>{1===d.button&&d.preventDefault()});window.addEventListener("mousewheel",Ya,{passive:!1});window.addEventListener("wheel",Ya,{passive:!1});window.addEventListener("resize",()=>{a:{if(!this.wa&&this.Qf){var d=this.Xa();var e=this.Na();if(this.G.vf()){if(this.Pf){if(this.Se===
d&&e<this.Cc){this.Sc=this.Cc-e;tb(this,this.Cc,this.Sc);d=void 0;break a}0<this.Sc&&(this.Sc=0,tb(this,e,this.Sc))}this.Se=d;this.Cc=e}l(this,"window-resize",{innerWidth:d,innerHeight:e,devicePixelRatio:window.devicePixelRatio,isFullscreen:La.ic()});this.G.ae()&&(-1!==this.Zb&&clearTimeout(this.Zb),ub(this,d,e,0))}d=void 0}return d});window.addEventListener("fullscreenchange",()=>Ka(this));window.addEventListener("webkitfullscreenchange",()=>Ka(this));window.addEventListener("mozfullscreenchange",
()=>Ka(this));window.addEventListener("fullscreenerror",d=>lb(this,d));window.addEventListener("webkitfullscreenerror",d=>lb(this,d));window.addEventListener("mozfullscreenerror",d=>lb(this,d));if(a.ae())if(window.visualViewport){let d=Infinity;window.visualViewport.addEventListener("resize",()=>{const e=window.visualViewport.height;e>d&&(document.scrollingElement.scrollTop=0);d=e})}else window.addEventListener("focusout",()=>{{const f=document.activeElement;if(f){var d=f.tagName.toLowerCase();var e=
new Set("email number password search tel text url".split(" "));d="textarea"===d?!0:"input"===d?e.has(f.type.toLowerCase()||"text"):Va(f)}else d=!1}d||(document.scrollingElement.scrollTop=0)});this.Qb=new Set;this.wd=new WeakSet;this.jb=!1}nf(){window.addEventListener("focus",()=>{l(this,"window-focus",null,Pa)});window.addEventListener("blur",()=>{try{var b=window.parent&&window.parent.document.hasFocus()}catch(c){b=!1}l(this,"window-blur",{parentHasFocus:b},Pa);this.Hc=0});window.addEventListener("focusin",
b=>{b=b.target;(Wa.has(b.tagName.toLowerCase())||Va(b))&&l(this,"keyboard-blur",null,Pa)});window.addEventListener("keydown",b=>mb(this,"keydown",b));window.addEventListener("keyup",b=>mb(this,"keyup",b));window.addEventListener("dblclick",b=>nb(this,"dblclick",b,B));window.addEventListener("wheel",b=>{this.wa||l(this,"wheel",{clientX:b.clientX,clientY:b.clientY+this.Da,pageX:b.pageX,pageY:b.pageY+this.Da,deltaX:b.deltaX,deltaY:b.deltaY,deltaZ:b.deltaZ,deltaMode:b.deltaMode,timeStamp:b.timeStamp},
B)});"undefined"!==typeof PointerEvent?(window.addEventListener("pointerdown",b=>{ob(b);qb(this,"pointerdown",b)}),this.G.Ca&&"undefined"!==typeof window.onpointerrawupdate&&self===self.top?window.addEventListener("pointerrawupdate",b=>{qb(this,"pointermove",b)}):window.addEventListener("pointermove",b=>qb(this,"pointermove",b)),window.addEventListener("pointerup",b=>qb(this,"pointerup",b)),window.addEventListener("pointercancel",b=>qb(this,"pointercancel",b))):(window.addEventListener("mousedown",
b=>{ob(b);rb(this,"pointerdown",b)}),window.addEventListener("mousemove",b=>rb(this,"pointermove",b)),window.addEventListener("mouseup",b=>rb(this,"pointerup",b)),window.addEventListener("touchstart",b=>{ob(b);sb(this,"pointerdown",b)}),window.addEventListener("touchmove",b=>sb(this,"pointermove",b)),window.addEventListener("touchend",b=>sb(this,"pointerup",b)),window.addEventListener("touchcancel",b=>sb(this,"pointercancel",b)));const a=()=>this.pe();window.addEventListener("pointerup",a,!0);window.addEventListener("touchend",
a,!0);window.addEventListener("click",a,!0);window.addEventListener("keydown",a,!0);window.addEventListener("gamepadconnected",a,!0);this.G.Zg()&&!this.G.vf()&&navigator.virtualKeyboard&&(navigator.virtualKeyboard.overlaysContent=!0,navigator.virtualKeyboard.addEventListener("geometrychange",()=>{tb(this,this.Na(),navigator.virtualKeyboard.boundingRect.height)}))}Xa(){return this.G.Xa()}Na(){return this.G.Na()}pe(){var a=[...this.Qb];this.Qb.clear();if(!this.jb)for(const b of a)(a=b.play())&&a.catch(()=>
{this.wd.has(b)||this.Qb.add(b)})}rb(a){if("function"!==typeof a.play)throw Error("missing play function");this.wd.delete(a);let b;try{b=a.play()}catch(c){this.Qb.add(a);return}b&&b.catch(()=>{this.wd.has(a)||this.Qb.add(a)})}Ib(a){this.Qb.delete(a);this.wd.add(a)}Zc(a){this.jb=!!a}});"use strict";
async function Ga(a){if(a.Ch)throw Error("already initialised");a.Ch=!0;var b=a.mb.ke(("playable-ad"===a.mb.I?a.mb.Yb:"")+"dispatchworker.js");a.xe=await a.mb.Ud(b,a.oc,{name:"DispatchWorker"});b=new MessageChannel;a.Je=b.port1;a.xe.postMessage({type:"_init","in-port":b.port2},[b.port2]);a.Xe=await Ja(a)}function Ha(a){return[a.Je,a.Xe]}
async function Ja(a){const b=a.Xf.length;var c=a.mb.ke(("playable-ad"===a.mb.I?a.mb.Yb:"")+"jobworker.js");c=await a.mb.Ud(c,a.oc,{name:"JobWorker"+b});const d=new MessageChannel,e=new MessageChannel;a.xe.postMessage({type:"_addJobWorker",port:d.port1},[d.port1]);c.postMessage({type:"init",number:b,"dispatch-port":d.port2,"output-port":e.port2},[d.port2,e.port2]);a.Xf.push(c);return e.port1}
self.bh=class{constructor(a){this.mb=a;this.oc=a.Ba;this.oc="preview"===a.I?this.oc+"workers/":this.oc+a.Yb;this.Eh=Math.min(navigator.hardwareConcurrency||2,16);this.xe=null;this.Xf=[];this.Xe=this.Je=null}};"use strict";window.C3_IsSupported&&(window.c3_runtimeInterface=new self.hb({Xh:!0,Yh:"workermain.js",bc:["scripts/c3runtime.js"],Pd:[],kf:"",Uh:"scripts/",Qd:[],qg:"html5"}));"use strict";function wb(a){a.stopPropagation()}function xb(a){13!==a.which&&27!==a.which&&a.stopPropagation()}
self.hb.ob(class extends self.Vd{constructor(a){super(a,"text-input");q(this,"scroll-to-bottom",b=>{b.scrollTop=b.scrollHeight})}Wc(a,b){let c;const d=b.type;"textarea"===d?(c=document.createElement("textarea"),c.style.resize="none"):(c=document.createElement("input"),c.type=d);c.style.position="absolute";c.autocomplete="off";c.addEventListener("pointerdown",wb);c.addEventListener("pointermove",wb);c.addEventListener("pointerrawupdate",wb);c.addEventListener("pointerup",wb);c.addEventListener("mousedown",
wb);c.addEventListener("mouseup",wb);c.addEventListener("keydown",xb);c.addEventListener("keyup",xb);c.addEventListener("click",e=>{e.stopPropagation();ka(this,"click",a)});c.addEventListener("dblclick",e=>{e.stopPropagation();ka(this,"dblclick",a)});c.addEventListener("input",()=>ja(this,"change",a,{text:c.value}));b.id&&(c.id=b.id);b.className&&(c.className=b.className);this.sb(c,b);return c}sb(a,b){a.value=b.text;a.placeholder=b.placeholder;a.title=b.title;a.disabled=!b.isEnabled;a.readOnly=b.isReadOnly;
a.spellcheck=b.spellCheck;b=b.maxLength;0>b?a.removeAttribute("maxlength"):a.setAttribute("maxlength",b)}});"use strict";function J(a){a.stopPropagation()}
self.hb.ob(class extends self.Vd{constructor(a){super(a,"button")}Wc(a,b){const c=document.createElement("input");var d=c;b.isCheckbox?(c.type="checkbox",d=document.createElement("label"),d.appendChild(c),d.appendChild(document.createTextNode("")),d.style.fontFamily="sans-serif",d.style.userSelect="none",d.style.webkitUserSelect="none",d.style.display="inline-block",d.style.color="black"):c.type="button";d.style.position="absolute";d.addEventListener("pointerdown",J);d.addEventListener("pointermove",
J);d.addEventListener("pointerrawupdate",J);d.addEventListener("pointerup",J);d.addEventListener("mousedown",J);d.addEventListener("mouseup",J);d.addEventListener("keydown",J);d.addEventListener("keyup",J);c.addEventListener("click",()=>ka(this,"click",a,{isChecked:c.checked}));b.id&&(c.id=b.id);b.className&&(c.className=b.className);this.sb(d,b);return d}je(a){return"input"===a.tagName.toLowerCase()?a:a.firstChild}sb(a,b){const c="input"===a.tagName.toLowerCase()?a:a.firstChild;c.checked=b.isChecked;
c.disabled=!b.isEnabled;a.title=b.title;a===c?c.value=b.text:a.lastChild.textContent=b.text}});"use strict";function yb(a){a.stopPropagation()}function zb(a){const b=document.createElement("option");b.text=a;return b}function Ab(a){const b=a.selectedIndex,c=[];for(let d=0,e=a.length;d<e;++d)a.options[d].selected&&c.push(d);return{selectedIndex:b,selectedIndices:c}}
self.hb.ob(class extends self.Vd{constructor(a){super(a,"list");q(this,"set-selected-index",(b,c)=>{b.selectedIndex=c.selectedIndex});q(this,"add-item",(b,c)=>{const d=c.index;c=zb(c.text);0>d?b.add(c):b.add(c,d)});q(this,"remove-item",(b,c)=>{b.remove(c.index)});q(this,"set-item",(b,c)=>{b.options[c.index].text=c.text});q(this,"clear",b=>{b.innerHTML=""});q(this,"load-state",(b,c)=>this.oe(b,c))}Wc(a,b){const c=b.isDropdown,d=b.isMultiSelect,e=b.items,f=document.createElement("select");f.style.position=
"absolute";f.style.userSelect="none";f.style.webkitUserSelect="none";f.multiple=d;c||(f.size=2);for(const g of e)f.add(zb(g));f.addEventListener("pointerdown",yb);f.addEventListener("pointermove",yb);f.addEventListener("pointerrawupdate",yb);f.addEventListener("pointerup",yb);f.addEventListener("mousedown",yb);f.addEventListener("mouseup",yb);f.addEventListener("click",g=>{g.stopPropagation();ka(this,"click",a,Ab(f))});f.addEventListener("dblclick",g=>{g.stopPropagation();ka(this,"dblclick",a,Ab(f))});
f.addEventListener("change",()=>ja(this,"change",a,Ab(f)));b.id&&(f.id=b.id);b.className&&(f.className=b.className);this.sb(f,b);return f}sb(a,b){a.title=b.title;a.disabled=!b.isEnabled;a.multiple=!!b.isMultiSelect}oe(a,b){a.innerHTML="";for(const c of b.items)a.add(zb(c));a.selectedIndex=b.selectedIndex;for(const c of b.selectedIndices)if(b=a.options[c])b.selected=!0}});"use strict";const Bb=[],Cb=2*Math.PI;function Db(a){a%=Cb;0>a&&(a+=Cb);return a}
function Eb(a,b){switch(a.lb){case 0:return b;case 1:return Math.fround(b);case 2:return 2===a.wc&&(b=Db(b),b/=Math.PI,b=32767*(b-1)),a=b|0,-32768>a?-32768:32767<a?32767:a;case 3:return 2===a.wc&&(b=Db(b),b/=Cb,b*=255),a=b|0,0>a?0:255<a?255:a;default:return b}}function Fb(a,b,c,d){switch(a.lb){case 0:b.setFloat64(c,d);c+=8;break;case 1:b.setFloat32(c,d);c+=4;break;case 2:b.setInt16(c,d);c+=2;break;case 3:b.setUint8(c,d);c+=1;break;default:b.setFloat32(c,d),c+=4}return c}
function Gb(a,b){if(2!==a.wc)return b;2===a.lb?b=(b/32767+1)*Math.PI:3===a.lb&&(b=b/255*Cb);return b}function Hb(a,b,c,d,e){switch(a){case 0:return e?c:b;case 1:return b+d*(c-b);case 2:return b===c?a=0:(a=Math.sin(b)*Math.sin(c)+Math.cos(b)*Math.cos(c),a=1<=a?0:-1>=a?Math.PI:Math.acos(a)),0>=Math.cos(c)*Math.sin(b)-Math.sin(c)*Math.cos(b)?Db(b+a*d):Db(b-a*d);default:return e?c:b}}
class Ib{constructor(a,b,c,d,e,f){this.vc=a;this.wc=b;this.lb=c;this.cb=d;this.Jd=e;this.Mf=f}Hb(){return{tag:this.cb,interp:this.wc,userData:this.Jd,cvt:this.Mf}}gb(){return this.wc}}class Jb{constructor(a,b){this.timestamp=a;this.data=b}}
class Kb{constructor(a,b,c){this.sa=a;this.g=a.g;this.H=b;this.X=c;this.rc=[];this.rc.length=this.sa.za.length;this.Re=this.qd=0;this.Ke=this.Hd=!1;this.aa=[];this.O=this.C=this.Ia=null}Hb(){var a=[];for(let c=0,d=this.sa.za.length;c<d;++c)a.push(this.gb(this.sa.Fd,c));a={id:this.H,nid:this.X,isTimedOut:0===this.aa.length?!1:this.aa[this.aa.length-1].timestamp<this.sa.Fd-3E3,interpValues:a,latestUpdate:null};const b=0===this.aa.length?null:this.aa[this.aa.length-1];b&&(a.latestUpdate={timestamp:b.timestamp,
data:b.data});return a}fe(a,b){a=a.netValues;var c=this.sa.za;const d=c.length;this.Hd=!1;for(let e=0;e<d;++e){const f=Eb(c[e],a[e]);this.rc[e]!==f&&(this.rc[e]=f,this.qd=b,this.sa.qd=b)}a=b-this.qd;b-=this.Re;c=this.sa.Jf;(this.Hd=100>a&&0===c?!0:1E3>a&&1>=c?95<=b:495<=b)&&this.sa.Kc++}ge(a,b,c){const d=this.sa.za;this.Re=c;a.setUint16(b,this.X);b+=2;for(let e=0,f=this.rc.length;e<f;++e)b=Fb(d[e],a,b,this.rc[e]);return b}Rd(a,b){for(let c=0,d=this.aa.length;c<d;++c){const e=this.aa[c];if(e.timestamp===
a)return;if(e.timestamp>a){this.aa.splice(c,0,new Jb(a,b));return}}this.aa.push(new Jb(a,b))}na(){for(;2<this.aa.length&&this.aa[0]!==this.Ia&&this.aa[0]!==this.C&&this.aa[0]!==this.O;)this.aa.shift();const a=this.sa.Fd;if(!(this.O&&this.O.timestamp>a&&this.C&&this.C.timestamp<a)){this.O=null;for(let b=0,c=this.aa.length;b<c;++b){const d=this.aa[b];if(d.timestamp<=a){if(!this.C||d.timestamp>this.C.timestamp)this.Ia=this.C,this.C=d}else{this.O=d;break}}}}gb(a,b){if(!this.O&&!this.C)return 0;if(this.O&&
!this.C)return this.O.data[b];const c=this.sa.za;let d,e,f;if(!this.O&&this.C){if(this.Ia){var g=this.Ia.timestamp;d=this.Ia.data[b];e=this.C.timestamp;f=this.C.data[b];a>this.C.timestamp+this.sa.ld&&(a=this.C.timestamp+this.sa.ld);g=g===e?0:(a-g)/(e-g);return Hb(c[b].gb(),d,f,g,!0)}return this.C.data[b]}g=this.C.timestamp;d=this.C.data[b];e=this.O.timestamp;f=this.O.data[b];return Hb(c[b].gb(),d,f,g===e?0:(a-g)/(e-g),!1)}}
function Lb(a,b,c,d,e,f){b=new Ib(a.za.length,b,c,d,e,f);switch(c){case 0:a.Ta+=8;break;case 1:a.Ta+=4;break;case 2:a.Ta+=2;break;case 3:a.Ta+=1}a.za.push(b)}function Mb(a,b){const c=b.H,d=b.X;a.g.s()&&!a.Nb&&a.gd.push(d);a.Bb.delete(c);a.Jc.delete(d);a.$b.delete(d);b=a.Ha.indexOf(b);-1<b&&a.Ha.splice(b,1)}function Nb(a,b){(b=a.Jc.get(b))&&Mb(a,b)}function Ob(a){return{roId:a.Qc,sid:a.Rc,netValues:a.za.map(b=>b.Hb())}}
class Pb{constructor(a,b,c,d){this.g=a;this.Qc=b;this.Rc=c;this.X=this.g.Hh++;this.Jf=d;this.Jd={};this.Ta=0;this.ld=250;switch(this.Jf){case 1:this.ld=500;break;case 2:this.ld=2500}this.za=[];this.Ha=[];this.Bb=new Map;this.$b=new Set;this.Kc=this.Re=this.qd=this.Ic=0;this.Nb=!1;this.gd=[];this.Jc=new Map;this.Fd=0;a=this.g;a.Ea.push(this);a.Oc.set(this.Qc,this);a.Xb.set(this.X,this)}tb(a){this.X=a}Rd(a,b,c){{let d=this.Jc.get(b);d||(d=new Kb(this,-1,b),this.Jc.set(b,d),this.Ha.push(d));b=d}b.Rd(a,
c)}na(){this.Fd=Qb(this.g);for(const a of this.Ha)a.na()}fe(a,b){this.Kc=0;for(var c of this.Ha)c.Ke=!1;for(let f=0,g=a.length;f<g;++f){c=a[f];var d=c.uid;var e=this.Bb.get(d);if(!e){e=d;do this.Ic++,65535<this.Ic&&(this.Ic=0);while(this.$b.has(this.Ic));const h=this.Ic;this.$b.add(h);e=new Kb(this,e,h);this.Bb.set(d,e);this.Ha.push(e)}d=e;d.Ke=!0;d.fe(c,b)}for(const f of this.Ha)f.Ke||Bb.push(f);for(const f of Bb)Mb(this,f);Bb.length=0}ge(a,b,c){a.setUint16(b,this.X);b+=2;let d=0;this.Nb&&(d=1);
a.setUint8(b,d);b+=1;a.setUint16(b,this.Kc);b+=2;a.setUint16(b,this.Ta);b+=2;for(const e of this.Ha)e.Hd&&(b=e.ge(a,b,c));return b}be(a){(a=this.Bb.get(a))&&Mb(this,a)}Hb(){return{hasOverriddenNids:this.Nb,netValues:this.za.map(a=>a.Hb()),netInstances:this.Ha.map(a=>a.Hb())}}}self.Rg=Ib;self.Qg=Jb;self.Tg=Pb;"use strict";const Rb=self.Qg,Sb=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection||window.msRTCPeerConnection;
function Tb(a){if(a)try{a.close()}catch(b){}}const K=[];function Ub(a){return new Promise(b=>setTimeout(b,a))}async function Vb(a){if(a.Ye.length&&!(a.re>=a.Fh)){a.re++;var b=a.Ye.shift();try{const c=await b.Ph();b.resolve(c)}catch(c){b.reject(c)}a.re--;Vb(a)}}function Wb(a,b){return new Promise((c,d)=>{a.Ye.push({Ph:b,resolve:c,reject:d});Vb(a)})}class Xb{constructor(){this.Fh=1;this.Ye=[];this.re=0}}
async function Yb(a,b,c){const d=Zb(a,b,c.data);c=d;"o"===b&&(c=Wb(a.Kh,()=>d));(c=await c)&&$b(a,b,c)}function L(a,b,c){if(!a.ac){a.ac=!0;bc(a,b);M(a,"o",JSON.stringify({c:"disconnect",r:b,k:!!c}));var d=a.wb,e=a.xb,f=a.yb,g=a.L;setTimeout(()=>{Tb(d);Tb(e);Tb(f);Tb(g)},0);a.wb=null;a.xb=null;a.yb=null;a.L=null;a.xc=!1;a.zc=!1;a.Ac=!1;cc(a.g,a)}}
function fc(a,b,c){b.binaryType="arraybuffer";b.onopen=()=>{"o"===c?a.xc=!0:"r"===c?a.zc=!0:"u"===c&&(a.Ac=!0);if(!a.ib&&a.zc&&a.Ac&&a.xc){a.Pe=performance.now();if(a.g.s()){gc(a.g,"o",JSON.stringify({c:"j",i:a.H,n:a.X,a:a.fa}),0,a);var d=M,e=JSON,f=e.stringify,g=a.g.S.X,h=a.X,k=a.g.Fa,v=a.g.Mc,p=a.g;var D={};for(const [r,t]of p.Xb.entries()){p=t.Rc;const F=[];for(var y of t.za){const I={tag:y.cb,precision:y.lb,interp:y.gb(),clientvaluetag:y.Mf};"undefined"!==typeof y.Jd&&(I.userdata=y.Jd);F.push(I)}D[p]=
{nid:r,nvs:F}}y=a.g;p=[];for(const r of y.Oa)p.push({tag:r.cb,precision:r.lb,interp:r.gb()});d(a,"o",f.call(e,{c:"hi",hn:g,n:h,d:k,u:v,objs:D,cvs:p,comp:hc}));for(const r of a.g.Pa)!r.s()&&r!==a&&r.ib&&!r.Ab&&M(a,"o",JSON.stringify({c:"j",i:r.H,n:r.X,a:r.fa}))}else a.Ee=!0,a.s()&&ic(a,performance.now(),!0),M(a,"o",JSON.stringify({c:"comp",comp:hc}));jc(a.g,a);a.ib=!0;a.Ab=!1}};b.onmessage=d=>{Yb(a,c,d)};b.onerror=d=>{console.error("Peer '"+a.H+"' datachannel '"+c+"' error: ",d);N(a,d);a.g.s()&&!a.s()&&
L(a,"network error")};b.onclose=()=>{L(a,"disconnect")}}
function kc(a){if(a!==a.g.N){var b=a.g.s();a.xc=!1;a.zc=!1;a.Ac=!1;a.ib=!1;a.Ab=!1;a.Nf=performance.now();a.L=new Sb({iceServers:a.g.Ie});a.L.onicecandidate=d=>{d.candidate&&P(a.g,{message:"icecandidate",toclientid:a.H,icecandidate:d.candidate})};a.L.onsignalingstatechange=()=>{a.L&&"closed"===a.L.signalingState&&L(a,"disconnect")};a.L.oniceconnectionstatechange=()=>{a.L&&("failed"!==a.L.iceConnectionState&&"closed"!==a.L.iceConnectionState||L(a,"disconnect"))};a.L.onconnectionstatechange=()=>{if(a.L){var d=
a.L.connectionState;"failed"!==d&&"closed"!==d||L(a,"disconnect")}};var c=`c3mp_${a.g.Ae}_${a.g.Be}_${a.g.T}`;b?(a.X=lc(a.g),a.wb=a.L.createDataChannel("o",{ordered:!0,protocol:c}),fc(a,a.wb,"o"),a.xb=a.L.createDataChannel("r",{ordered:!1,protocol:c}),fc(a,a.xb,"r"),a.yb=a.L.createDataChannel("u",{ordered:!1,maxRetransmits:0,protocol:c}),fc(a,a.yb,"u"),a.L.createOffer().then(d=>{a.L.setLocalDescription(d);P(a.g,{message:"offer",toclientid:a.H,offer:d})}).catch(d=>{console.error("Host error creating offer for peer '"+
a.H+"': ",d);N(a,"could not create offer for peer")})):a.L.ondatachannel=d=>{if(d.channel.protocol!==c)console.error("Unexpected datachannel protocol '"+d.channel.protocol+"', should be '"+c+"'"),N(a,"unexpected datachannel protocol '"+d.channel.protocol+"', should be '"+c+"'"),a.ac||(L(a,"datachannel protocol error"),l(a.g,"peer-kicked"));else{var e=d.channel.label;"o"===e?a.wb=d.channel:"r"===e?a.xb=d.channel:"u"===e?a.yb=d.channel:(console.error("Unknown datachannel label: "+d.channel.label),N(a,
"unknown datachannel label '"+d.channel.label+"'"));fc(a,d.channel,e)}}}}async function mc(a,b){if(a.L)try{await a.L.addIceCandidate(b)}catch(c){console.warn("[Multiplayer] Error adding ICE candidate: ",c)}}async function M(a,b,c,d=0){nc(a.g,c);const e=oc(a,b,c,d);c=e;"o"===b&&(c=Wb(a.Lh,()=>e));(c=await c)&&pc(a,b,c)}
function ic(a,b,c){a.ac||(!c&&(!a.ib||a.Ab)&&a.L&&25E3<b-a.Nf?(console.warn("Timed out '"+a.fa+"', could not establish connection after 25sec"),L(a,"timeout")):!c&&a.ib&&!a.Ab&&2E4<b-a.Pe?(console.warn("Timed out '"+a.fa+"', not heard from for 20sec"),L(a,"timeout")):(a.Yf=b,a.ue=!0,a.Qe++,M(a,"u","ping:"+a.Qe)))}function bc(a,b){!a.Ab&&a.ib&&(a.g.s()&&a!==a.g.N&&gc(a.g,"o",JSON.stringify({c:"l",i:a.H,a:a.fa,r:b}),0,a),a===a.g.N||qc(a.g,a,b),a.Ab=!0,a.ib=!1)}
function rc(a,b){const c=hc;for(const d of b)c.includes(d)&&a.te.push(d)}async function sc(a,b){if(0===a.te.length)return{Ld:0,data:b};const c=new Blob([b]);if(64>c.size)return{Ld:0,data:b};a=a.te[0];var d=new CompressionStream(a);d=c.stream().pipeThrough(d);d=await (new Response(d)).arrayBuffer();if(d.byteLength>=c.size)return{Ld:0,data:b};b=Q.Sd.indexOf(a);if(0>b)throw Error("invalid compression type");return{Ld:b,data:d}}
async function oc(a,b,c,d=0){var e="string"===typeof c;const {Ld:f,data:g}=await sc(a,c);c=g;g instanceof ArrayBuffer&&(0!==f&&(d|=f<<4,e&&(d|=Q.uf)),c=new ArrayBuffer(g.byteLength+8),e=new DataView(c),e.setUint32(0,Q.xf),e.setUint32(4,d),(new Uint8Array(c,8)).set(new Uint8Array(g)));a.g.ta.lf++;d=a.g;d.ta.Nd+=tc(c);d=a.g.af;e=a.g.$e;a=a.g.bf;if(0<d&&"u"===b&&Math.random()<d)return null;if(0!==e||0!==a){let h=1;"u"!==b&&Math.random()<d&&(h=3);await Ub((e+Math.random()*a)*h)}return c}
function pc(a,b,c){try{"o"===b?a.xc&&a.wb&&a.wb.send(c):"r"===b?a.zc&&a.xb&&a.xb.send(c):"u"===b&&a.Ac&&a.yb&&a.yb.send(c)}catch(d){a.ac||(a.g.s()?"o"===b||"r"===b?("string"===typeof c?(console.error("Error sending "+c.length+"-char string on '"+b+"' to '"+a.fa+"', host kicking: ",d),console.log("String that failed to send from previous error was: "+c)):console.error("Error sending "+(c.length||c.byteLength)+"-byte binary on '"+b+"' to '"+a.fa+"', host kicking: ",d),L(a,"network error")):(a.kd++,
10<=a.kd&&("string"===typeof c?(console.error("Too many errors ("+a.kd+") sending data on '"+b+"' to '"+a.fa+"', kicking; last error was for sending "+c.length+"-char string: ",d),console.log("String that failed to send from previous error was: "+c)):console.error("Too many errors ("+a.kd+") sending data on '"+b+"' to '"+a.fa+"', kicking; last error was for sending "+(c.length||c.byteLength)+"-byte binary: ",d),L(a,"network error"))):console.error("Error sending data on '"+b+"': ",d))}}
function uc(a,b){if(a.ue){var c=b.indexOf(":");if(-1<c){if(parseFloat(b.substr(c+1))===a.Qe){c=performance.now();a.ue=!1;var d=(c-a.Yf)/2;a.rd.push(d);10<a.rd.length&&a.rd.shift();K.push(...a.rd);K.sort((h,k)=>h-k);a.hg=K[K.length-1]-K[0];var e=0,f=K.length;4<=K.length&&6>=K.length?(++e,--f):6<K.length&&(e+=2,f-=2);var g=0;for(let h=e;h<f;++h)g+=K[h];a.sd=g/(f-e);K.length=0;a.g.s()||(e=b.indexOf("/"),-1<e?(b=parseFloat(b.substr(e+1)),isFinite(b)?vc(a.g,b,c,d,a.sd):console.warn("Invalid host time from pong response")):
console.warn("Cannot parse off host time from pong response"))}}else console.warn("Cannot parse off ping ID from pong")}}async function Zb(a,b,c){a.g.ta.hf++;var d=a.g;d.ta.Md+=tc(c);d=a.g.af;const e=a.g.$e;a=a.g.bf;if(0<d&&"u"===b&&Math.random()<d)return null;if(0!==e||0!==a){let f=1;"u"!==b&&Math.random()<d&&(f=3);await Ub(e*f+Math.random()*a*f)}return c instanceof ArrayBuffer?await wc(c):c}
function $b(a,b,c){if(!a.ac)if(a.Pe=performance.now(),"string"===typeof c){var d=a.g;d.ta.cc+=tc(c);if(!(""===c.trim()||4>c.length))if(d=c.substr(0,4),"ping"===d)d="pong:"+c.substr(5),a.g.s()&&(d=d+"/"+Math.round(performance.now()).toString()),M(a,"u",d);else if("pong"===d)uc(a,c);else{try{var e=JSON.parse(c)}catch(m){N(a,m);a.g.s()?(console.error("Error parsing message as JSON for peer '"+a.H+"', host kicking: ",m),L(a,"data error")):console.error("Error parsing message as JSON for peer '"+a.H+"': ",
m);console.log("String that failed to parse from previous error: "+c);return}if(e)try{if(e.c&&"m"!==e.c){d=e;let m,G;switch(d.c){case "disconnect":d.k&&l(a.g,"peer-kicked");G=!a.g.s()&&!a.s();L(a,d.r);G&&xc(a.g);break;case "hi":if(!a.g.s()){a.g.S.tb(d.hn);a.g.N.tb(d.n);a.g.Fa=d.d;a.g.Mc=d.u;var f=a.g,g=d.objs;f.Xb.clear();for(const x of f.Ea)if(g.hasOwnProperty(x.Rc.toString())){const R=g[x.Rc.toString()];x.tb(R.nid);f.Xb.set(R.nid,x);var h=R.nvs;x.za.length=0;x.Ta=0;for(const E of h)Lb(x,E.interp,
E.precision,E.tag,E.userdata,E.clientvaluetag)}else console.warn("Could not map object SID '"+x.Rc+"' - host did not send NID for it"),x.tb(-1);var k=a.g,v=d.cvs;k.ed.clear();k.Oa.length=0;for(let x=0,R=v.length;x<R;++x){const E=v[x],X=new yc(x,E.interp,E.precision,E.tag,null);k.ed.set(X.cb,X);k.Oa.push(X)}k.Ze=!0;d.hasOwnProperty("comp")&&rc(a,d.comp)}break;case "comp":rc(a,d.comp);break;case "j":a.g.s()||(m=new Q(a.g,d.i,d.a),m.tb(d.n),jc(a.g,m));break;case "l":!a.g.s()&&(m=a.g.Aa.get(d.i)||null)&&
(m===m.g.N||qc(a.g,m,d.r),L(m,d.r));break;default:console.error("Unknown control message from peer '"+a.H+"': "+d.c),N(a,"unknown control message '"+d.c+"'")}}else{var p=a.g;d=e;const m=d.f||a.H;l(p,"peer-message",{tag:d.t,fromId:m,fromAlias:zc(p,m),transmissionMode:b,content:d.m,contentMode:d.cm||"e"})}}catch(m){N(a,m),a.g.s()?(console.error("Error handling message for peer '"+a.H+"', host kicking: ",m),L(a,"data error")):console.error("Error handling message for peer '"+a.H+"': ",m)}}}else{f=a.g;
f.ta.cc+=tc(c.data);!a.Ee&&a.g.s()&&"u"===b&&(a.Ee=!0,f=a.g,f.xa&&f.s()&&P(f,{message:"confirm-peer",id:a.H}));try{var D=c.data,y=c.offset,r=c.flags;if(0===(r&Q.Wd))if(d=new DataView(D,y),a.g.s()){var t=0,F=d.getFloat64(t);t+=8;F+=a.sd;if(!(3E3<=Math.abs(F-performance.now()))){var I=d.getUint8(t);t+=1;var w=[],Y=a.g.Oa;for(var O=0;O<I;++O)if(O>=Y.length)w.push(0);else{var ha=Y[O],C=void 0;switch(ha.lb){case 0:C=d.getFloat64(t);t+=8;break;case 1:C=d.getFloat32(t);t+=4;break;case 2:C=Gb(ha,d.getInt16(t));
t+=2;break;case 3:C=Gb(ha,d.getUint8(t));t+=1;break;default:C=d.getFloat32(t),t+=4}w.push(C)}a:{d=F;for(let m=0,G=a.va.length;m<G;++m){var A=a.va[m];if(A.timestamp===d)break a;if(A.timestamp>d){a.va.splice(m,0,new Rb(d,w));break a}}a.va.push(new Rb(d,w))}}}else if(0===(r&Q.tf))for(A=0,w=d.getFloat64(A),A+=8,t=d.getUint16(A),A+=2,b=0;b<t;++b){O=d.getUint16(A);A+=2;const m=d.getUint8(A);A+=1;I=null;Y=0;const G=a.g.Xb.get(O)||null;G?(I=G.za,Y=I.length,1===m&&(G.Nb=!0)):console.warn("Don't know which object corresponds to NID "+
O);const x=d.getUint16(A);A+=2;const R=d.getUint16(A);A+=2;for(F=0;F<x;++F){const E=d.getUint16(A);A+=2;if(G){ha=[];C=A;for(var ta=0;ta<Y;++ta){const X=I[ta];let ia;switch(X.lb){case 0:ia=d.getFloat64(C);C+=8;break;case 1:ia=d.getFloat32(C);C+=4;break;case 2:ia=Gb(X,d.getInt16(C));C+=2;break;case 3:ia=Gb(X,d.getUint8(C));C+=1;break;default:ia=d.getFloat32(C),C+=4}ha.push(ia)}G.Rd(w,E,ha)}A+=R}}else{w=0;ta=d.getFloat64(w);w+=8;const m=d.getUint16(w);w+=2;for(t=0;t<m;++t){const G=d.getUint16(w);w+=
2;const x=a.g.Xb.get(G)||null;x||console.warn("Don't know which object corresponds to NID "+G);const R=d.getUint16(w);w+=2;for(O=0;O<R;++O){const E=d.getUint16(w);w+=2;x&&!x.Nb&&(l(a.g,"instance-destroyed",{roId:x.Qc,nid:E,timestamp:ta}),Nb(x,E))}}}else{var ac=a.g,gd=0===y?D:D.slice(y);const m=a.H;l(ac,"peer-message",{fromId:m,fromAlias:zc(ac,m),transmissionMode:b,content:gd,contentMode:"s"})}}catch(m){N(a,m),a.g.s()?(console.error("Error handling binary update for peer '"+a.H+"', host kicking: ",
m),L(a,"data error")):console.error("Error handling binary update for peer '"+a.H+"': ",m)}}}
async function wc(a){if(8>a.byteLength)return console.warn(`Rejected binary message as too small (only ${a.byteLength} bytes)`),null;var b=new DataView(a),c=b.getUint32(0);b=b.getUint32(4);if(c!==Q.xf)return console.warn(`Rejected binary message with invalid magic number (0x${c.toString(16)})`),null;c=(b&Q.Xg)>>4;if(0===c)return{data:a,offset:8,flags:b};if(c>=Q.Sd.length)throw Error("invalid compression type");c=Q.Sd[c];a=new Blob([new Uint8Array(a,8)]);c=new DecompressionStream(c);a=a.stream().pipeThrough(c);
a=await (new Response(a)).arrayBuffer();return 0===(b&Q.uf)?{data:a,offset:0,flags:b}:(new TextDecoder).decode(a)}
function Ac(a,b){b=b.vc;if(!a.O&&!a.C)return 0;if(a.O&&!a.C)return a=a.O.data,0>b||b>=a.length?0:a[b];var c=Qb(a.g);let d,e,f;if(!a.O&&a.C){if(a.Ia){var g=a.Ia.timestamp;d=a.Ia.data[b];e=a.C.timestamp;f=a.C.data[b];c>a.C.timestamp+250&&(c=a.C.timestamp+250);g=g===e?0:(c-g)/(e-g);return Hb(a.g.Oa[b].gb(),d,f,g,!0)}a=a.C.data;return 0>b||b>=a.length?0:a[b]}g=a.C.timestamp;d=a.C.data[b];e=a.O.timestamp;f=a.O.data[b];return Hb(a.g.Oa[b].gb(),d,f,g===e?0:(c-g)/(e-g),!1)}
class Q{constructor(a,b,c){this.g=a;this.H=b;this.X=0;this.fa=c;this.wb=this.L=null;this.xc=!1;this.xb=null;this.zc=!1;this.yb=null;this.Ac=!1;this.Lh=new Xb;this.Kh=new Xb;this.Ee=this.ac=this.Ab=this.ib=!1;this.kd=this.Nf=this.Pe=0;this.te=[];this.eg=[];this.ag=this.$f=0;this.va=[];this.O=this.C=this.Ia=null;this.Yf=0;this.ue=!1;this.Qe=1;this.rd=[];this.hg=this.sd=0;a=this.g;a.Pa.push(this);a.Aa.set(this.H,this);l(a,"add-peer",{id:this.H,alias:this.fa})}tb(a){this.X=a}s(){return this===this.g.S}na(a){if(0!==
this.va.length){for(;2<this.va.length&&this.va[0]!==this.Ia&&this.va[0]!==this.C&&this.va[0]!==this.O;)this.va.shift();if(!(this.O&&this.O.timestamp>a&&this.C&&this.C.timestamp<a)){this.O=null;for(let b=0,c=this.va.length;b<c;++b){const d=this.va[b];if(d.timestamp<=a){if(!this.C||d.timestamp>this.C.timestamp)this.Ia=this.C,this.C=d}else{this.O=d;break}}}}}}Q.xf=1664314736;Q.tf=1;Q.uf=2;Q.Wd=4;Q.Xg=240;Q.Sd=["none","deflate","gzip"];self.Sg=Q;"use strict";
const yc=self.Rg,Bc=self.Sg,Cc=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection||window.msRTCPeerConnection,Dc=window.RTCSessionDescription||window.webkitRTCSessionDescription||window.mozRTCSessionDescription||window.msRTCSessionDescription,Ec=window.RTCIceCandidate||window.webkitRTCIceCandidate||window.mozRTCIceCandidate||window.msRTCIceCandidate,Fc=window.RTCDataChannel||window.webkitRTCDataChannel||window.mozRTCDataChannel||window.msRTCDataChannel,Gc=[{urls:"stun:stun.l.google.com:19302"}];
function Hc(a){if("undefined"===typeof CompressionStream||"function"!==typeof Blob.prototype.stream)return!1;try{return new CompressionStream(a),!0}catch(b){return!1}}function tc(a){if("number"===typeof a.byteLength)return a.byteLength;if("number"===typeof a.length)return a.length;console.warn("[Construct] Multiplayer: don't know how to measure size of data: ",a);return 0}const hc=[];Hc("deflate")&&hc.push("deflate");Hc("gzip")&&hc.push("gzip");let Ic=!1;const S=[];
function Qb(a){return a.s()?performance.now()-a.Fa:performance.now()+a.ca-a.pa}function N(a,b){console.error(`[Multiplayer] Peer '${a.fa}' (${a.H}) error: `,b)}function P(a,b){a.Y&&a.Za&&a.Y.send(JSON.stringify(b))}function lc(a){if(a.s()){do a.Rb++,65535<a.Rb&&(a.Rb=0);while(a.Id.has(a.Rb));var b=a.Rb;a.Id.add(b);return b}}function gc(a,b,c,d=0,e=null){if(a.s()){var f=a.Pa.slice(0);for(const g of f)g&&g!==a.N&&g!==e&&M(g,b,c,d)}}function jc(a,b){l(a,"peer-open",{id:b.H,alias:b.fa})}
function qc(a,b,c){l(a,"peer-close",{id:b.H,alias:b.fa,reason:c||"unknown"})}function nc(a,b){a.ta.Od+=tc(b)}function vc(a,b,c,d,e){if(!a.s()){a.eb=e+a.Fa;b=b+d-c;0===a.Cb.length&&(a.ca=b,a.pa=a.eb);a.Cb.push(b);30<a.Cb.length&&a.Cb.shift();S.push(...a.Cb);S.sort((f,g)=>f-g);b=0;c=S.length;4<=S.length&&6>=S.length?(++b,--c):6<S.length&&19>=S.length?(b+=2,c-=2):19<S.length&&(b+=5,c-=5);d=0;for(e=b;e<c;++e)d+=S[e];a.Ka=d/(c-b);S.length=0}}
function xc(a){if(a.xa){var b=T(a.oa.ug);P(a,{message:"leave"});return b}}function cc(a,b){l(a,"remove-peer",{id:b.H});a.s()&&a.s()&&a.Id.delete(b.X);const c=a.Pa.indexOf(b);-1<c&&a.Pa.splice(c,1);a.Aa.delete(b.H);a.S===b&&(a.S=null,Jc(a,"host quit"));a.N===b&&(a.N=null,a.T="",Jc(a,"disconnect"))}function Kc(a,b){if(b)for(let c of b){"string"===typeof c&&(c={urls:c});a:{for(const d of a.Ie)if(d.urls===c.urls){b=!0;break a}b=!1}b||(c.hasOwnProperty("url")||(c.url=c.urls),a.Ie.push(c))}}
function Jc(a,b){if(!Ic){for(Ic=!0;a.Pa.length;)L(a.Pa[0],b);Ic=!1}}
function Lc(a,b){if(a.Y||a.Za)return Promise.resolve();const c=T(a.oa.connect);try{a.Y=new WebSocket(b,"c2multiplayer")}catch(d){return a.Y=null,Mc(a,d),c}a.Y.onopen=()=>{-1===a.Y.protocol.indexOf("c2multiplayer")?(Mc(a,"server does not support 'c2multiplayer' protocol"),a.Y.close(1002,"'c2multiplayer' protocol required"),a.Y=null,a.Za=!1):a.Za=!0};a.Y.onclose=()=>{l(a,"signalling-close");a.Za=!1;a.xa=!1;a.Y=null};a.Y.onerror=d=>{console.error("Signalling server error: ",d);Mc(a,d)};a.Y.onmessage=
d=>{a:{try{var e=JSON.parse(d.data)}catch(f){Mc(a,f);break a}switch(e.message){case "welcome":d=e;1>d.protocolrev||1<d.protocolrev?(Mc(a,"signalling server protocol revision not supported"),Nc(a)):(a.We=d.clientid,a.T="",e=a.Mh,e.Bg=d.protocolrev,e.version=d.version,e.name=d.name,e.operator=d.operator,e.xg=d.motd,Kc(a,d.ice_servers),l(a,"signalling-welcome",{myid:a.We,sigservinfo:{protocolrev:e.Bg,version:e.version,name:e.name,operator:e.operator,motd:e.xg}}),Oc(a.oa.connect));break;case "login-ok":a.Ve=
e.alias;a.xa=!0;l(a,"signalling-login-ok",{myalias:a.Ve});Oc(a.oa.login);break;case "join-ok":d=e;Jc(a,"disconnect");a.Ae=d.game;a.Be=d.instance;a.T=d.room;a.N=new Bc(a,a.We,a.Ve);d.host?(a.S=a.N,a.Rb=0,a.Id.clear(),a.S.tb(lc(a))):(a.Cb.length=0,a.Ka=0,a.ca=0,a.Fa=80,a.He=30,a.Mc=30,a.eb=a.Fa,a.pa=a.Fa,a.S=new Bc(a,d.hostid,d.hostalias),kc(a.S));l(a,"signalling-join-ok",{isHost:!!d.host,hostId:a.S.H,hostAlias:a.S.fa,game:a.Ae,gameInstance:a.Be,room:a.T});Oc(a.oa.jf);break;case "leave-ok":a.T="";l(a,
"signalling-leave-ok");Oc(a.oa.ug);break;case "kicked":"host-left"===e.reason?Nc(a):(Pc(a),a.T="",l(a,"signalling-kicked"));break;case "peer-joined":d=e;a.xa&&a.T&&a.s()&&((e=a.Aa.get(d.peerid))&&L(e,"rejoin"),kc(new Bc(a,d.peerid,d.peeralias)));break;case "peer-quit":d=e;a.xa&&a.T&&a.s()&&(e=a.Aa.get(d.id))&&L(e,d.reason);break;case "icecandidate":d=e;a.xa&&a.T&&(e=a.Aa.get(d.from))&&mc(e,new Ec(d.icecandidate));break;case "offer":Qc(a,e);break;case "answer":Rc(a,e);break;case "instance-list":l(a,
"signalling-instance-list",{list:e.list});Oc(a.oa.vg);break;case "room-list":l(a,"signalling-room-list",{list:e.list});Oc(a.oa.wg);break;case "error":Mc(a,e.details);break;default:Mc(a,"received unknown signalling message")}}};return c}function Nc(a){a.Y&&a.Za&&(a.Y.close(),a.Y=null,a.Za=!1)}function Pc(a,b){a.Cb.length=0;a.Ka=0;a.ca=0;Jc(a,"disconnect");for(const c of a.Ea)c.gd.length=0,c.Bb.clear(),c.Jc.clear(),c.$b.clear(),c.Ha.length=0;b&&xc(a)}
function Sc(a,b,c){if(!a.s()&&a.N&&a.Ze&&(b=a.ed.get(b))){b=b.vc;var d=a.N.eg;d.length<b+1&&(d.length=b+1);d[b]!==c&&(d[b]=c,a.N.$f=performance.now())}}function T(a){a.reject&&a.reject("overlapping signalling operation");return new Promise((b,c)=>{a.resolve=b;a.reject=c})}function Oc(a){a.resolve&&a.resolve(void 0);a.resolve=null;a.reject=null}
function Mc(a,b){l(a,"signalling-error",{message:b?"string"===typeof b?b:"string"===typeof b.message?b.message:"string"===typeof b.details?b.details:"string"===typeof b.data?b.data:"string"===typeof b.type?b.type:"unknown error":"unknown error"});for(const c of Object.values(a.oa))c.reject&&c.reject(b),c.resolve=null,c.reject=null}
function Qc(a,b){if(a.xa&&a.T&&!a.s()&&a.N&&a.S&&a.S.L&&b.from===a.S.H){var c=a.S.L;c.setRemoteDescription(new Dc(b.offer)).then(()=>{c.createAnswer().then(d=>{c.setLocalDescription(d);P(a,{message:"answer",toclientid:a.S.H,answer:d})}).catch(d=>{console.error("Peer error creating answer: ",d);N(a.N,"could not create answer to host offer")})}).catch(d=>{console.error("Peer error setting remote description: ",d);N(a.N,"could not set remote description")})}}
function Rc(a,b){a.xa&&a.T&&a.s()&&(a=a.Aa.get(b.from))&&a.L.setRemoteDescription(new Dc(b.answer)).catch(c=>{console.error("Host error setting remote description: ",c)})}function zc(a,b){return(a=a.Aa.get(b))?a.fa:""}
async function Tc(a,b){if(a.s()){await Uc(a,b);const c=a.we;let d=0,e=0;for(const f of a.Ea)f.gd.length&&e++;if(0!==e){c.setFloat64(d,b);d+=8;c.setUint16(d,e);d+=2;for(const f of a.Ea)if(b=f.gd,b.length){c.setUint16(d,f.X);d+=2;c.setUint16(d,b.length);d+=2;for(const g of b)c.setUint16(d,g),d+=2;b.length=0}gc(a,"r",a.fd.slice(0,d),Bc.tf)}}else await Vc(a,b)}
async function Uc(a,b){const c=a.we;let d=0,e=0;const f=await aa(a,"get-object-info",{ros:a.Ea.map(g=>Ob(g))});for(const g of a.Ea){const h=g.Qc;f.hasOwnProperty(h)&&(g.fe(f[h],b),0<g.Kc&&e++)}if(0!==e){c.setFloat64(d,b);d+=8;c.setUint16(d,e);d+=2;for(const g of a.Ea)0<g.Kc&&(d=g.ge(c,d,b));gc(a,"u",a.fd.slice(0,d),0)}}
async function Vc(a,b){a.T&&(a.s()||0!==a.Ka)&&await Wc(a);if(a.N&&a.Ze){var c=a.we,d=0,e=a.Oa,f=a.N.eg,g=b-a.N.$f,h=b-a.N.ag;if(100>g||(1E3>g?95<=h:495<=h)){c.setFloat64(d,b+a.ca);d+=8;c.setUint8(d,e.length);d+=1;for(let k=0,v=e.length;k<v;++k)g=e[k],h=0,k<f.length&&(h=Eb(g,f[k])),d=Fb(g,c,d,h);a.N.ag=b;M(a.S,"u",a.fd.slice(0,d))}}}async function Wc(a){const b=await aa(a,"before-client-update");for(const c of b.clientStateUpdates)Sc(a,c.tag,c.value)}
self.hb.ob(class extends self.ec{constructor(a){super(a,"multiplayer");this.Ie=[];this.Y=null;this.xa=this.Za=!1;this.Mh={Bg:0,version:0,name:"",operator:"",xg:""};this.T=this.Be=this.Ae=this.Ve=this.We="";this.Pa=[];this.Aa=new Map;this.Rb=0;this.Id=new Set;this.S=this.N=null;this.Fa=80;this.Mc=this.He=30;this.cg=0;this.ta={Uc:0,Ag:0,lf:0,yg:0,zg:0,Nd:0,Od:0,tg:0,hf:0,rg:0,sg:0,Md:0,cc:0};this.fd=new ArrayBuffer(262144);this.we=new DataView(this.fd);this.Ea=[];this.Hh=1;this.Xb=new Map;this.Oc=new Map;
this.af=this.bf=this.$e=0;this.Cb=[];this.ca=this.Ka=0;this.pa=this.eb=this.Fa;this.Oa=[];this.ed=new Map;this.Ze=!1;this.oa={connect:{resolve:null,reject:null},login:{resolve:null,reject:null},jf:{resolve:null,reject:null},ug:{resolve:null,reject:null},vg:{resolve:null,reject:null},wg:{resolve:null,reject:null}};Kc(this,Gc);setInterval(()=>{const b=performance.now();if(this.s()){S.push(...this.Pa);for(const c of S)c&&c!==this.N&&ic(c,b,!1);S.length=0}else this.S&&ic(this.S,b,!1)},2E3);window.addEventListener("unload",
()=>Jc(this,"quit"));n(this,"get-supported",()=>({isSupported:!(!Cc||!Fc)}));n(this,"add-ice-servers",b=>Kc(this,b.list));n(this,"simulate-latency",b=>{var c=b.pdv,d=b.loss;this.$e=Math.max(b.latency,0);this.bf=Math.max(c,0);this.af=Math.max(d,0)});n(this,"set-bandwidth-profile",b=>{var c=b.updateRate;b=b.delay;this.T||(this.Mc=this.He=c,this.Fa=b)});n(this,"tick",b=>this.na(b));n(this,"alert",b=>{alert(b.message)});n(this,"signalling-connect",b=>Lc(this,b.url));n(this,"signalling-disconnect",()=>
Nc(this));n(this,"signalling-login",b=>{b=b.alias;if(this.xa)b=void 0;else{var c=T(this.oa.login);P(this,{message:"login",protocolrev:1,datachannelrev:2,compressionformats:hc,alias:b});b=c}return b});n(this,"signalling-join-room",b=>{var c=b.game;var d=b.instance,e=b.room;b=b.maxClients;if(this.xa&&!this.T){var f=T(this.oa.jf);P(this,{message:"join",game:c,instance:d,room:e,max_clients:b});c=f}else c=void 0;return c});n(this,"signalling-auto-join-room",b=>{var c=b.game;var d=b.instance,e=b.room,f=
b.maxClients;b=b.lock;if(this.xa&&!this.T){var g=T(this.oa.jf);P(this,{message:"auto-join",game:c,instance:d,room:e,max_clients:f,lock_when_full:b});c=g}else c=void 0;return c});n(this,"signalling-leave-room",()=>xc(this));n(this,"signalling-list-game-instances",b=>{b=b.game;if(this.Y&&this.Za){var c=T(this.oa.vg);P(this,{message:"list-instances",game:b});b=c}else b=void 0;return b});n(this,"signalling-list-rooms",b=>{var c=b.game;var d=b.instance;b=b.which;if(this.Y&&this.Za){var e=T(this.oa.wg);
P(this,{message:"list-rooms",game:c,instance:d,which:b});c=e}else c=void 0;return c});n(this,"disconnect-room",()=>Pc(this,!0));n(this,"peer-send-message",b=>{const c=b.tag;var d=b.message;const e=b.transmissionMode,f=b.contentMode;if(b=this.Aa.get(b.id)||null)"s"===f&&d instanceof ArrayBuffer?M(b,e,d,Bc.Wd):(d={c:"m",cm:f,m:d},"e"===f&&(d.t=c),M(b,e,JSON.stringify(d)))});n(this,"host-broadcast",b=>{var c=b.fromId;const d=b.tag,e=b.message,f=b.transmissionMode;b=b.contentMode;const g=this.Aa.get(c)||
null;"s"===b&&e instanceof ArrayBuffer?gc(this,f,e,Bc.Wd,g):(c={c:"m",cm:b,f:c,m:e},"e"===b&&(c.t=d),gc(this,f,JSON.stringify(c),0,g))});n(this,"kick-peer",b=>{if(this.s()){var c=b.reason;(b=this.Aa.get(b.id)||null)&&L(b,c,!0)}});n(this,"sync-object",b=>{const c=b.x,d=b.y,e=b.angle,f=b.precision,g=b.bandwidth;for(const h of b.objectClasses)b=new self.Tg(this,h.roId,h.sid,g),c&&Lb(b,1,f,"x"),d&&Lb(b,1,f,"y"),e&&Lb(b,2,f,"a")});n(this,"sync-inst-var",b=>{const c=b.precision,d=b.interp,e=b.cvt;for(const f of b.syncData)Lb(this.Oc.get(f.roId),
d,c,"iv",f.varIndex,e)});n(this,"associate-object",b=>{var c=b.peerId;const d=b.instUid;b=this.Oc.get(b.roId);c=this.Aa.get(c);if(b&&c&&this.s())if(c=c.X,b.Bb.has(d))console.warn("OverrideNid passed id "+d+" which is already in use and cannot be overridden");else if(b.$b.has(c))console.warn("OverrideNid passed nid "+c+" which is already in use and cannot be overridden");else{var e=new Kb(b,d,c);b.Bb.set(d,e);b.$b.add(c);b.Ha.push(e);b.Nb=!0}});n(this,"remove-object-id",b=>this.be(b.uid));n(this,"remove-net-insts",
b=>{for(const [c,d]of Object.entries(b))if(b=this.Oc.get(parseInt(c,10)))for(const e of d)Nb(b,e)});n(this,"remove-object-nid",b=>{const c=b.nid;(b=this.Oc.get(b.roId))&&Nb(b,c)});n(this,"set-client-state",b=>Sc(this,b.tag,b.value));n(this,"add-client-input-value",b=>{var c=b.tag;b=new yc(this.Oa.length,b.interp,b.precision,c,null);this.ed.set(c,b);this.Oa.push(b)})}s(){return!!this.T&&this.N&&this.S===this.N}na(a){if(!this.T)return null;a=a.dt;var b=performance.now();b-this.cg>=1E3/(this.s()?this.He:
this.Mc)-5&&(Tc(this,b),this.cg=b);var c=this.ta;1E3<=b-c.Uc&&(c.Ag=c.lf,c.yg=c.Nd,c.zg=c.Od,c.tg=c.hf,c.rg=c.Md,c.sg=c.cc,c.lf=0,c.Nd=0,c.Od=0,c.hf=0,c.Md=0,c.cc=0,c.Uc+=1E3,500<b-c.Uc&&(c.Uc=b),l(this,"stats",{stats:{outboundPerSec:c.Ag,outboundBandwidthPerSec:c.yg,outboundDecompressedBandwidthPerSec:c.zg,inboundPerSec:c.tg,inboundBandwidthPerSec:c.rg,inboundDecompressedBandwidthPerSec:c.sg}}));this.s()||(this.ca<this.Ka?(this.ca+=10*a,this.ca>this.Ka&&(this.ca=this.Ka)):this.ca>this.Ka&&(this.ca-=
10*a,this.ca<this.Ka&&(this.ca=this.Ka)),this.pa<this.eb?(this.pa+=30*a,this.pa>this.eb&&(this.pa=this.eb)):this.pa>this.eb&&(this.pa-=30*a,this.pa<this.eb&&(this.pa=this.eb)));a=Qb(this);for(var d of this.Pa)d.na(a);for(var e of this.Ea)e.na();d=Qb(this);e=this.s()?performance.now():performance.now()+this.ca+this.pa;a=this.Fa;b={};for(var f of this.Pa){c={};for(const g of this.Oa)c[g.cb]=Ac(f,g);b[f.H]={nid:f.X,latency:f.sd,pdv:f.hg,clientState:c}}f={};for(const g of this.Ea)f[g.Qc]=g.Hb();return{simulationTime:d,
hostInputArrivalTime:e,clientDelay:a,peerData:b,roData:f,isReadyForInput:this.T?this.s()?!0:0!==this.Ka:!1}}be(a){for(const b of this.Ea)b.be(a)}});"use strict";const Xc=180/Math.PI;
async function Yc(a,b){if(b.isiOSCordova||b.isSafari)a.Ad=!0;a.ef=b.timeScaleMode;a.gg=["equalpower","HRTF","soundfield"][b.panningModel];a.Of=["linear","inverse","exponential"][b.distanceModel];a.ig=b.refDistance;a.fg=b.maxDistance;a.kg=b.rolloffFactor;if(a.G.Le)a.Ad=!0,a.h=new OfflineAudioContext({numberOfChannels:2,sampleRate:48E3,length:Math.ceil(48E3*a.G.Rf)});else{var c={latencyHint:b.latencyHint};a.ng||(c.sampleRate=48E3);if("undefined"!==typeof AudioContext)a.h=new AudioContext(c);else if("undefined"!==
typeof webkitAudioContext)a.h=new webkitAudioContext(c);else throw Error("Web Audio API not supported");Zc(a);a.h.onstatechange=()=>{"running"!==a.h.state&&Zc(a);l(a,"audiocontext-state",{audioContextState:a.h.state})}}a.Lb=a.h.createGain();a.Lb.connect(a.h.destination);c=b.listenerPos;a.ya[0]=c[0];a.ya[1]=c[1];a.ya[2]=c[2];a.h.listener.setPosition(c[0],c[1],c[2]);a.h.listener.setOrientation(...a.Ga);self.C3_GetAudioContextCurrentTime=()=>a.h.currentTime;try{await Promise.all(b.preloadList.map(d=>
$c(a,d.originalUrl,d.url,d.type,!1)))}catch(d){console.error("[Construct] Preloading sounds failed: ",d)}return{sampleRate:a.h.sampleRate,audioContextState:a.h.state,outputLatency:a.h.outputLatency||0}}
async function ad(a,b){var c=b.originalUrl,d=b.url;const e=b.type,f=b.isMusic,g=b.tags,h=b.isLooping,k=b.vol,v=b.pos,p=b.panning,D=b.stereoPan;let y=b.off;0<y&&!b.trueClock&&(a.h.getOutputTimestamp?(b=a.h.getOutputTimestamp(),y=y-b.performanceTime/1E3+b.contextTime):y=y-performance.now()/1E3+a.h.currentTime);a.Zf=g.slice(0);bd(a,g);try{a.ha=await cd(a,c,d,e,g,f);if(p){dd(a.ha,!0);var r=a.ha,t=p.innerAngle,F=p.outerAngle,I=p.outerGain;if(r.yc){ed(r,p.x,p.y,p.z,p.angle);var w=self.dc.fh;r.ab[0]!==w(t)&&
(r.ab[0]=w(t),r.P.coneInnerAngle=w(t));r.ab[1]!==w(F)&&(r.ab[1]=w(F),r.P.coneOuterAngle=w(F));r.ab[2]!==I&&(r.ab[2]=I,r.P.coneOuterGain=I)}p.hasOwnProperty("uid")&&(a.ha.Ya=p.uid)}else"number"===typeof D&&0!==D?(fd(a.ha,!0),hd(a.ha,D)):(dd(a.ha,!1),fd(a.ha,!1));a.ha.Play(h,k,v,y)}catch(Y){console.error("[Construct] Audio: error starting playback: ",Y);return}finally{c=g.join(" ");d=a.Nc.get(c);if(!d)throw Error("expected pending tag");d.mf--;0===d.mf&&(d.resolve(),a.Nc.delete(c))}da(a)}
async function id(a,b){var c=b.tags;const d=b.vol,e=b.duration;b=b.stopOnEnd;await jd(a,c);for(const h of U(a,c))if(!h.Ob){c=h.R.gain;c.cancelScheduledValues(0);var f=h.D.h.currentTime,g=f+e;c.setValueAtTime(c.value,f);c.linearRampToValueAtTime(d,g);h.Fb=d;h.Mb=g;h.mg=b}kd(a)}async function ld(a,b){const c=b.tags;b=b.rate;await jd(a,c);for(const d of U(a,c))d.Ua!==b&&(d.Ua=b,d.ub())}async function md(a,b){const c=b.tags;b=b.pos;await jd(a,c);for(const d of U(a,c))d.ce(b)}
async function nd(a,b){const c=b.originalUrl,d=b.url,e=b.type;b=b.isMusic;try{await cd(a,c,d,e,"",b)}catch(f){console.error("[Construct] Audio: error preloading: ",f)}}async function od(a,b){if(b=await $c(a,"",b.url,b.type,b.isMusic,!0))b.o(),b=a.Ra.indexOf(b),-1!==b&&a.Ra.splice(b,1)}
async function pd(a,b){const c=b.type;var d=b.tags;const e=b.params;let f;if("convolution"===c)try{f=await $c(a,b.bufferOriginalUrl,b.bufferUrl,b.bufferType,!1)}catch(k){console.log("[Construct] Audio: error loading convolution: ",k);return}for(const k of d){if("filter"===c)d=new self.Hg(a,...e);else if("delay"===c)d=new self.Fg(a,...e);else if("convolution"===c){var g=d=new self.Eg(a,f.Qa,...e),h=b.bufferType;g.Kf=b.bufferOriginalUrl;g.Lf=h}else if("flanger"===c)d=new self.Ig(a,...e);else if("phaser"===
c)d=new self.Kg(a,...e);else if("gain"===c)d=new self.Jg(a,...e);else if("stereopan"===c)d=new self.Mg(a,...e);else if("tremolo"===c)d=new self.Ng(a,...e);else if("ringmod"===c)d=new self.Lg(a,...e);else if("distortion"===c)d=new self.Gg(a,...e);else if("compressor"===c)d=new self.Dg(a,...e);else if("analyser"===c)d=new self.Cg(a,...e);else throw Error("invalid effect type");g=a;h=k;h=h.toLowerCase();let v=g.Sa.get(h);v||(v=[],g.Sa.set(h,v));d.vc=v.length;d.cb=h;v.push(d);qd(g,h)}rd(a)}
async function sd(a,b){try{const c=a.h.suspend(b.time);a.Vf?a.h.resume():(a.h.startRendering().then(d=>{const e=[];for(let f=0,g=d.numberOfChannels;f<g;++f){const h=d.getChannelData(f);e.push(h.buffer)}a.G.lc("runtime","offline-audio-render-completed",{duration:d.duration,length:d.length,numberOfChannels:d.numberOfChannels,sampleRate:d.sampleRate,channelData:e},null,e)}).catch(d=>td(d)),a.Vf=!0);await c}catch(c){td(c)}}
function Zc(a){a.md||(a.Ge=!1,window.addEventListener("pointerup",a.nb,!0),window.addEventListener("touchend",a.nb,!0),window.addEventListener("click",a.nb,!0),window.addEventListener("keydown",a.nb,!0),a.md=!0)}
async function $c(a,b,c,d,e,f){for(var g of a.Ra)if(g.hc()===c)return await ud(g),g;if(f)return null;if(e&&(a.Ad||a.Uf)){f=0;for(let h=0,k=a.Ra.length;h<k;++h)g=a.Ra[h],a.Ra[f]=g,g.pb()?g.o():++f;a.Ra.length=f}f="audio/webm; codecs=opus"===d&&!a.ng;e&&f&&(a.Uf=!0);c=!e||a.Ad||f?new self.Ug(a,b,c,d,e,f):new self.Og(a,b,c,d,e);a.Ra.push(c);await ud(c);a.dg.has(b)||(l(a,"buffer-metadata",{originalUrl:b,duration:c.Ma()}),a.dg.add(b));return c}
function vd(a,b){return a===b||a.normalize().toLowerCase()===b.normalize().toLowerCase()}function wd(a,b){return(b=a.Sa.get(b.toLowerCase()))?b[0].da():a.La()}function qd(a,b){b=b.toLowerCase();let c=a.La();var d=a.Sa.get(b);if(d&&d.length){c=d[0].da();for(let f=0,g=d.length;f<g;++f){var e=d[f];f+1===g?e.ka(a.La()):e.ka(d[f+1].da())}}for(const f of xd(a,b))d=c,e=f.Ja||f.P||f.R,e.disconnect(),e.connect(d);a.Db&&a.Te===b&&(a.Db.disconnect(),a.Db.connect(c))}
function*xd(a,b){if(b)for(const c of a.U)vd(0<c.Wa.length?c.Wa[0]:"",b)&&(yield c);else a.ha&&!a.ha.ea()&&(yield a.ha)}function yd(a,b,c){return c?a.G.Bh(b).then(d=>{const e=a.h.createBuffer(1,d.length,48E3);e.getChannelData(0).set(d);return e}):new Promise((d,e)=>{a.h.decodeAudioData(b,d,e)})}function zd(a,b){let c=0;for(let d=0,e=a.U.length;d<e;++d){const f=a.U[d];a.U[c]=f;f.ga===b?f.o():++c}a.U.length=c}
function*U(a,b){if(0<b.length)for(const d of a.U){a:{a=d.Wa;var c=b;for(const e of c){c=!1;for(const f of a)if(vd(f,e)){c=!0;break}if(!c){a=!1;break a}}a=!0}a&&(yield d)}else a.ha&&!a.ha.ea()&&(yield a.ha)}async function cd(a,b,c,d,e,f){for(const g of a.U)if(g.hc()===c&&(g.Td()||f))return g.Wa=e,g;b=await $c(a,b,c,d,f);e="html5"===b.se?new self.Pg(b.D,b,e):new self.Vg(b.D,b,e);a.U.push(e);return e}
function bd(a,b){b=b.join(" ");let c=a.Nc.get(b);if(!c){let d=null;c={mf:0,promise:new Promise(e=>d=e),resolve:d};a.Nc.set(b,c)}c.mf++}function jd(a,b){return(a=a.Nc.get((0===b.length?a.Zf:b).join(" ")))?a.promise:Promise.resolve()}function kd(a){if(0<a.Kb.size)da(a);else for(const b of a.U)if(!b.W&&!b.ea()){da(a);break}}function Ad(a,b,c,d){l(a,"trigger",{type:b,tags:c,aiid:d})}function rd(a){a.Me||(a.Me=!0,Promise.resolve().then(()=>Bd(a)))}
function Bd(a){const b={};for(const [c,d]of a.Sa)b[c]=d.map(e=>e.fc());l(a,"fxstate",{fxstate:b});a.Me=!1}
async function Cd(a,b,c){if(3!==c){var d=b.bufferOriginalUrl,e=b.bufferUrl,f=b.bufferType,g=b.isMusic,h=b.tags,k=b.isLooping,v=b.volume,p=b.playbackTime;if(!g||1!==c)if(g||2!==c){c=null;try{c=await cd(a,d,e,f,h,g)}catch(D){console.error("[Construct] Audio: error loading audio state: ",D);return}a=c;(d=b.pan)?(dd(a,!0),e=a.P,f=d.pos,a.Tb[0]=f[0],a.Tb[1]=f[1],a.Tb[2]=f[2],f=d.orient,a.Sb[0]=f[0],a.Sb[1]=f[1],a.Sb[2]=f[2],e.setPosition(...a.Tb),e.setOrientation(...a.Sb),a.ab[0]=d.cia,a.ab[1]=d.coa,a.ab[2]=
d.cog,e.coneInnerAngle=d.cia,e.coneOuterAngle=d.coa,e.coneOuterGain=d.cog,a.Ya=d.uid):dd(a,!1);a=c;d=b.stereoPan;"number"!==typeof d?fd(a,!1):(fd(a,!0),hd(a,d));c.Play(k,v,p,0);b.isPlaying||c.kc();c.me(b)}}}function td(a){console.error("[Audio] Offline rendering error: ",a)}
self.dc=class extends self.ec{constructor(a){super(a,"audio");this.Lb=this.h=null;this.md=this.Ge=!1;this.nb=()=>{if(!this.Ge){var b=this.h;"suspended"===b.state&&b.resume&&b.resume();var c=b.createBuffer(1,220,22050),d=b.createBufferSource();d.buffer=c;d.connect(b.destination);d.start(0);"running"===b.state&&this.md&&(this.Ge=!0,window.removeEventListener("pointerup",this.nb,!0),window.removeEventListener("touchend",this.nb,!0),window.removeEventListener("click",this.nb,!0),window.removeEventListener("keydown",
this.nb,!0),this.md=!1)}};this.Ra=[];this.U=[];this.ha=null;this.Zf=[];this.dg=new Set;this.bg=-1;this.Nc=new Map;this.vd=1;this.jb=!1;this.ef=0;this.Gd=1;this.Ce=0;this.gg="HRTF";this.Of="inverse";this.ig=600;this.fg=1E4;this.kg=1;this.ya=[0,0,0];this.Ga=[0,0,-1,0,1,0];this.Uf=this.Ad=!1;this.ng=this.G.$g();this.Sa=new Map;this.Kb=new Set;this.Vf=this.Me=!1;this.Te="";this.Db=null;self.C3Audio_OnMicrophoneStream=(b,c)=>{this.Db&&this.Db.disconnect();this.Te=c.toLowerCase();this.Db=this.h.createMediaStreamSource(b);
this.Db.connect(wd(this,this.Te))};this.hd=null;self.C3Audio_GetOutputStream=()=>{this.hd||(this.hd=this.h.createMediaStreamDestination(),this.Lb.connect(this.hd));return this.hd.stream};self.C3Audio_DOMInterface=this;ca(this,[["create-audio-context",b=>Yc(this,b)],["play",b=>ad(this,b)],["stop",b=>{b=b.tags;for(const c of U(this,b))c.qb()}],["stop-all",()=>{for(const b of this.U)b.qb()}],["set-paused",b=>{const c=b.tags;b=b.paused;for(const d of U(this,c))b?d.kc():d.Yc();kd(this)}],["set-volume",
b=>{const c=b.tags;b=b.vol;for(const d of U(this,c))Dd(d,b)}],["fade-volume",b=>id(this,b)],["set-master-volume",b=>{this.vd=b.vol;this.Lb.gain.value=this.vd}],["set-muted",b=>{const c=b.tags;b=b.isMuted;for(const d of U(this,c))Ed(d,b)}],["set-silent",b=>{this.jb=b.isSilent;this.G.Zc(this.jb);for(const c of this.U)c.bd()}],["set-looping",b=>{const c=b.tags;b=b.isLooping;for(const d of U(this,c))d.de(b)}],["set-playback-rate",b=>ld(this,b)],["set-stereo-pan",b=>{const c=b.tags;b=b.p;for(const d of U(this,
c))fd(d,!0),hd(d,b)}],["seek",b=>md(this,b)],["preload",b=>nd(this,b)],["unload",b=>od(this,b)],["unload-all",()=>{for(const b of this.Ra)b.o();this.Ra.length=0}],["set-suspended",b=>{b=b.isSuspended;!b&&this.h.resume&&this.h.resume();for(const c of this.U)c.ee(b);b&&this.h.suspend&&this.h.suspend()}],["add-effect",b=>pd(this,b)],["set-effect-param",b=>{var c=b.tags;const d=b.index,e=b.param,f=b.value,g=b.ramp;b=b.time;for(const h of c)c=this.Sa.get(h.toLowerCase()),!c||0>d||d>=c.length||c[d].ua(e,
f,g,b);rd(this)}],["remove-effects",b=>{b=b.tags;for(const c of b){b=c.toLowerCase();const d=this.Sa.get(b);if(!d||!d.length)break;for(const e of d)e.o();this.Sa.delete(b);qd(this,b)}}],["tick",b=>{this.Gd=b.timeScale;this.Ce=b.gameTime;this.bg=b.tickCount;if(0!==this.ef)for(var c of this.U)c.ub();!(c=b.listenerPos)||this.ya[0]===c[0]&&this.ya[1]===c[1]&&this.ya[2]===c[2]||(this.ya[0]=c[0],this.ya[1]=c[1],this.ya[2]=c[2],this.h.listener.setPosition(c[0],c[1],c[2]));if((c=b.listenerOrientation)&&(this.Ga[0]!==
c[0]||this.Ga[1]!==c[1]||this.Ga[2]!==c[2]||this.Ga[3]!==c[3]||this.Ga[4]!==c[4]||this.Ga[5]!==c[5])){for(let d=0;6>d;++d)this.Ga[d]=c[d];this.h.listener.setOrientation(...this.Ga)}for(const d of b.instPans){b=d.uid;for(const e of this.U)e.Ya===b&&ed(e,d.x,d.y,d.z,d.angle)}}],["load-state",b=>this.oe(b)],["offline-render-audio",b=>sd(this,b)],["offline-render-finish",()=>{this.h.resume()}]])}la(){return this.h}La(){return this.Lb}GetAudioContextExtern(){return this.la()}GetDestinationNodeExtern(){return this.La()}Xc(){return this.jb}rb(a){this.G.rb(a)}Ib(a){this.G.Ib(a)}na(){for(var a of this.Kb)a.na();
a=this.h.currentTime;for(var b of this.U)b.na(a);b=this.U.filter(c=>!c.W&&!c.ea()).map(c=>c.fc());l(this,"state",{tickCount:this.bg,outputLatency:this.h.outputLatency||0,audioInstances:b,analysers:[...this.Kb].map(c=>({tag:c.cb,index:c.vc,peak:c.Ub,rms:c.jg,binCount:c.v.frequencyBinCount,freqBins:c.Tf}))});0===b.length&&0===this.Kb.size&&this.nd&&(this.G.zh(this.og),this.nd=!1)}async oe(a){const b=a.saveLoadMode;if(3!==b){var c=[];for(var d of this.U)d.pb()&&1===b||!d.pb()&&2===b?c.push(d):d.o();
this.U=c}for(const e of this.Sa.values())for(const f of e)f.o();this.Sa.clear();this.Gd=a.timeScale;this.Ce=a.gameTime;c=a.listenerPos;this.ya[0]=c[0];this.ya[1]=c[1];this.ya[2]=c[2];this.h.listener.setPosition(c[0],c[1],c[2]);c=a.listenerOrientation;if(Array.isArray(c)){for(d=0;6>d;++d)this.Ga[d]=c[d];this.h.listener.setOrientation(...this.Ga)}this.jb=a.isSilent;this.G.Zc(this.jb);this.vd=a.masterVolume;this.Lb.gain.value=this.vd;c=[];for(const e of Object.values(a.effects))c.push(Promise.all(e.map(f=>
pd(this,f))));await Promise.all(c);await Promise.all(a.playing.map(e=>Cd(this,e,b)));kd(this)}static fh(a){return a*Xc}static sf(a){return Math.max(Math.min(Math.pow(10,a/20),1),0)}static dh(a){return Math.log(Math.max(Math.min(a,1),0))/Math.log(10)*20}};self.hb.ob(self.dc);"use strict";function ud(a){a.td||(a.td=a.le());return a.td}self.pf=class{constructor(a,b,c,d,e){this.D=a;this.Ih=b;this.Eb=c;this.ja=d;this.Dh=e;this.se="";this.td=null}o(){this.td=this.D=null}le(){}la(){return this.D.la()}Yd(){return this.Ih}hc(){return this.Eb}Xd(){return this.ja}pb(){return this.Dh}Ma(){}};
"use strict";
self.Og=class extends self.pf{constructor(a,b,c,d,e){super(a,b,c,d,e);this.se="html5";this.ba=new Audio;this.ba.crossOrigin="anonymous";this.ba.autoplay=!1;this.ba.preload="auto";this.Dc=this.Ec=null;this.ba.addEventListener("canplaythrough",()=>!0);this.Lc=this.la().createGain();this.Gc=null;this.ba.addEventListener("canplay",()=>{this.Ec&&(this.Ec(),this.Dc=this.Ec=null);!this.Gc&&this.ba&&(this.Gc=this.la().createMediaElementSource(this.ba),this.Gc.connect(this.Lc))});this.onended=null;this.ba.addEventListener("ended",
()=>{if(this.onended)this.onended()});this.ba.addEventListener("error",f=>{console.error(`[Construct] Audio '${this.Eb}' error: `,f);this.Dc&&(this.Dc(f),this.Dc=this.Ec=null)})}o(){zd(this.D,this);this.Lc.disconnect();this.Lc=null;this.Gc.disconnect();this.Gc=null;this.ba&&!this.ba.paused&&this.ba.pause();this.ba=this.onended=null;super.o()}le(){return new Promise((a,b)=>{this.Ec=a;this.Dc=b;this.ba.src=this.Eb})}ma(){return this.ba}Ma(){return this.ba.duration}};"use strict";
async function Fd(a){if(a.vb)return a.vb;var b=a.D.G;if("cordova"===b.I&&b.wf(a.Eb)&&b.od)a.vb=await b.Vc(a.Eb);else{b=await fetch(a.Eb);if(!b.ok)throw Error(`error fetching audio data: ${b.status} ${b.statusText}`);a.vb=await b.arrayBuffer()}}async function Gd(a){if(a.Qa)return a.Qa;a.Qa=await yd(a.D,a.vb,a.Gh);a.vb=null}
self.Ug=class extends self.pf{constructor(a,b,c,d,e,f){super(a,b,c,d,e);this.se="webaudio";this.Qa=this.vb=null;this.Gh=!!f}o(){zd(this.D,this);this.Qa=this.vb=null;super.o()}async le(){try{await Fd(this),await Gd(this)}catch(a){console.error(`[Construct] Failed to load audio '${this.Eb}': `,a)}}Ma(){return this.Qa?this.Qa.duration:0}};"use strict";let Hd=0;
function dd(a,b){b=!!b;a.yc!==b&&(a.yc=b,a.yc?(fd(a,!1),a.P||(a.P=a.la().createPanner(),a.P.panningModel=a.D.gg,a.P.distanceModel=a.D.Of,a.P.refDistance=a.D.ig,a.P.maxDistance=a.D.fg,a.P.rolloffFactor=a.D.kg),a.R.disconnect(),a.R.connect(a.P),a.P.connect(a.La())):(a.P.disconnect(),a.R.disconnect(),a.R.connect(a.La())))}
function fd(a,b){b=!!b;a.pd!==b&&(a.pd=b,a.pd?(dd(a,!1),a.Ja=a.la().createStereoPanner(),a.R.disconnect(),a.R.connect(a.Ja),a.Ja.connect(a.La())):(a.Ja.disconnect(),a.Ja=null,a.R.disconnect(),a.R.connect(a.La())))}function hd(a,b){a.pd&&a.cf!==b&&(a.Ja.pan.value=b,a.cf=b)}function Dd(a,b){a.Fb=b;a.R.gain.cancelScheduledValues(0);a.Mb=-1;a.R.gain.value=a.Zd()}function Ed(a,b){b=!!b;a.Ob!==b&&(a.Ob=b,a.bd())}
function ed(a,b,c,d,e){if(a.yc){var f=a.Tb,g=a.Sb,h=Math.cos(e);e=Math.sin(e);if(f[0]!==b||f[1]!==c||f[2]!==d)f[0]=b,f[1]=c,f[2]=d,a.P.setPosition(...f);if(g[0]!==h||g[1]!==e||0!==g[2])g[0]=h,g[1]=e,g[2]=0,a.P.setOrientation(...g)}}function Id(a){return a.Ne?a.D.Ce:performance.now()/1E3}
self.qf=class{constructor(a,b,c){this.D=a;this.ga=b;this.Wa=c;this.cd=Hd++;this.R=this.la().createGain();this.R.connect(this.La());this.P=null;this.yc=!1;this.Tb=[0,0,0];this.Sb=[0,0,0];this.ab=[0,0,0];this.Ja=null;this.pd=!1;this.cf=0;this.W=!0;this.ra=this.bb=this.Z=!1;this.Fb=1;this.Ob=!1;this.Ua=1;a=this.D.ef;this.Ne=1===a&&!this.pb()||2===a;this.Mb=this.Ya=-1;this.mg=!1}o(){this.ga=this.D=null;this.P&&(this.P.disconnect(),this.P=null);this.Ja&&(this.Ja.disconnect(),this.Ja=null);this.R.disconnect();
this.R=null}la(){return this.D.la()}La(){return wd(this.D,0<this.Wa.length?this.Wa[0]:"")}Yd(){return this.ga.Yd()}hc(){return this.ga.hc()}Xd(){return this.ga.Xd()}pb(){return this.ga.pb()}ea(){}Td(){}IsPlaying(){return!this.W&&!this.Z&&!this.ea()}Gb(){}Ma(){return this.ga.Ma()}Play(){}qb(){}kc(){}Yc(){}na(a){-1!==this.Mb&&a>=this.Mb&&(this.Mb=-1,this.mg&&this.qb(),Ad(this.D,"fade-ended",this.Wa,this.cd))}Zd(){const a=this.Fb;return isFinite(a)?a:0}Xc(){return this.D.Xc()}bd(){}de(){}ub(){}ce(){}ee(){}$d(){}fc(){var a=
this.cd,b=this.Wa,c=this.Ma(),d=-1===this.Mb?this.Fb:this.R.gain.value,e=this.IsPlaying();if(this.P){var f=this.P;f={pos:this.Tb,orient:this.Sb,cia:f.coneInnerAngle,coa:f.coneOuterAngle,cog:f.coneOuterGain,uid:this.Ya}}else f=null;return{aiid:a,tags:b,duration:c,volume:d,isPlaying:e,playbackTime:this.Gb(),playbackRate:this.Ua,uid:this.Ya,bufferOriginalUrl:this.Yd(),bufferUrl:"",bufferType:this.Xd(),isMusic:this.pb(),isLooping:this.ra,isMuted:this.Ob,resumePosition:this.$d(),pan:f,stereoPan:this.Ja?
this.cf:null}}me(a){var b=a.playbackRate;this.Ua!==b&&(this.Ua=b,this.ub());Ed(this,a.isMuted)}};"use strict";
self.Pg=class extends self.qf{constructor(a,b,c){super(a,b,c);this.ga.Lc.connect(this.R);this.ga.onended=()=>this.ne()}o(){this.qb();this.ga.Lc.disconnect();super.o()}ma(){return this.ga.ma()}ne(){this.W=!0;this.Ya=-1;Ad(this.D,"ended",this.Wa,this.cd)}ea(){return this.ma().ended}Td(){return this.W?!0:this.ea()}Gb(){let a=this.ma().currentTime;this.ra||(a=Math.min(a,this.Ma()));return a}Play(a,b,c){const d=this.ma();1!==d.playbackRate&&(d.playbackRate=1);d.loop!==a&&(d.loop=a);Dd(this,b);d.muted&&
(d.muted=!1);if(d.currentTime!==c)try{d.currentTime=c}catch(e){console.warn(`[Construct] Exception seeking audio '${this.ga.hc()}' to position '${c}': `,e)}this.D.rb(d);this.Z=this.W=!1;this.ra=a;this.Ua=1}qb(){const a=this.ma();a.paused||a.pause();this.D.Ib(a);this.W=!0;this.Z=!1;this.Ya=-1}kc(){if(!(this.Z||this.W||this.ea())){var a=this.ma();a.paused||a.pause();this.D.Ib(a);this.Z=!0}}Yc(){!this.Z||this.W||this.ea()||(this.D.rb(this.ma()),this.Z=!1)}bd(){this.ma().muted=this.Ob||this.Xc()}de(a){a=
!!a;this.ra!==a&&(this.ra=a,this.ma().loop=a)}ub(){let a=this.Ua;this.Ne&&(a*=this.D.Gd);try{this.ma().playbackRate=a}catch(b){console.warn(`[Construct] Unable to set playback rate '${a}':`,b)}}ce(a){if(!this.W&&!this.ea())try{this.ma().currentTime=a}catch(b){console.warn(`[Construct] Error seeking audio to '${a}': `,b)}}$d(){return this.Gb()}ee(a){a?this.IsPlaying()?(this.ma().pause(),this.bb=!0):this.bb=!1:this.bb&&(this.D.rb(this.ma()),this.bb=!1)}};"use strict";
function Jd(a){a.B&&(a.B.onended=null,a.B.disconnect(),a.B.buffer=null);a.B=null;a.nc=null}
self.Vg=class extends self.qf{constructor(a,b,c){super(a,b,c);this.B=null;this.xd=d=>this.ne(d);this.Fe=!0;this.nc=null;this.ia=this.zd=this.Bd=0;this.Ue=1}o(){this.qb();Jd(this);this.xd=null;super.o()}ne(a){this.Z||this.bb||a.target!==this.nc||(this.W=this.Fe=!0,this.Ya=-1,Jd(this),Ad(this.D,"ended",this.Wa,this.cd))}ea(){return!this.W&&this.B&&this.B.loop||this.Z?!1:this.Fe}Td(){return!this.B||this.W?!0:this.ea()}Gb(){let a;a=this.Z?this.ia:this.zd+(Id(this)-this.Bd)*this.Ua;this.ra||(a=Math.min(a,
this.Ma()));return a}Play(a,b,c,d){this.Ue=1;Dd(this,b);Jd(this);this.B=this.la().createBufferSource();this.B.buffer=this.ga.Qa;this.B.connect(this.R);this.nc=this.B;this.B.onended=this.xd;this.B.loop=a;this.B.start(d,c);this.Z=this.W=this.Fe=!1;this.ra=a;this.Ua=1;this.Bd=Id(this);this.zd=c}qb(){if(this.B)try{this.B.stop(0)}catch(a){}this.W=!0;this.Z=!1;this.Ya=-1}kc(){this.Z||this.W||this.ea()||(this.ia=this.Gb(),this.ra&&(this.ia%=this.Ma()),this.Z=!0,this.B.stop(0))}Yc(){!this.Z||this.W||this.ea()||
(Jd(this),this.B=this.la().createBufferSource(),this.B.buffer=this.ga.Qa,this.B.connect(this.R),this.nc=this.B,this.B.onended=this.xd,this.B.loop=this.ra,Dd(this,this.Fb),this.ub(),this.B.start(0,this.ia),this.Bd=Id(this),this.zd=this.ia,this.Z=!1)}Zd(){return super.Zd()*this.Ue}bd(){this.Ue=this.Ob||this.Xc()?0:1;Dd(this,this.Fb)}de(a){a=!!a;this.ra!==a&&(this.ra=a,this.B&&(this.B.loop=a))}ub(){let a=this.Ua;this.Ne&&(a*=this.D.Gd);this.B&&(this.B.playbackRate.value=a)}ce(a){this.W||this.ea()||(this.Z?
this.ia=a:(this.kc(),this.ia=a,this.Yc()))}$d(){return this.ia}ee(a){a?this.IsPlaying()?(this.bb=!0,this.ia=this.Gb(),this.ra&&(this.ia%=this.Ma()),this.B.stop(0)):this.bb=!1:this.bb&&(Jd(this),this.B=this.la().createBufferSource(),this.B.buffer=this.ga.Qa,this.B.connect(this.R),this.nc=this.B,this.B.onended=this.xd,this.B.loop=this.ra,Dd(this,this.Fb),this.ub(),this.B.start(0,this.ia),this.Bd=Id(this),this.zd=this.ia,this.bb=!1)}me(a){super.me(a);this.ia=a.resumePosition}};"use strict";
function V(a){return a.h.createGain()}function W(a,b,c,d,e){b.cancelScheduledValues(0);if(0===e)b.value=c;else switch(a=a.h.currentTime,e+=a,d){case 0:b.setValueAtTime(c,e);break;case 1:b.setValueAtTime(b.value,a);b.linearRampToValueAtTime(c,e);break;case 2:b.setValueAtTime(b.value,a),b.exponentialRampToValueAtTime(c,e)}}class Z{constructor(a){this.D=a;this.h=a.la();this.vc=-1;this.ja=this.cb="";this.A=null}o(){this.h=null}da(){}ka(){}fc(){return{type:this.ja,tag:this.cb,params:this.A}}}
self.Hg=class extends Z{constructor(a,b,c,d,e,f,g){super(a);this.ja="filter";this.A=[b,c,d,e,f,g];this.F=V(this);this.l=V(this);this.l.gain.value=g;this.j=V(this);this.j.gain.value=1-g;this.M=this.h.createBiquadFilter();this.M.type=b;this.M.frequency.value=c;this.M.detune.value=d;this.M.Q.value=e;this.M.gain.vlaue=f;this.F.connect(this.M);this.F.connect(this.j);this.M.connect(this.l)}o(){this.F.disconnect();this.M.disconnect();this.l.disconnect();this.j.disconnect();super.o()}ka(a){this.l.disconnect();
this.l.connect(a);this.j.disconnect();this.j.connect(a)}da(){return this.F}ua(a,b,c,d){switch(a){case 0:b=Math.max(Math.min(b/100,1),0);this.A[5]=b;W(this,this.l.gain,b,c,d);W(this,this.j.gain,1-b,c,d);break;case 1:this.A[1]=b;W(this,this.M.frequency,b,c,d);break;case 2:this.A[2]=b;W(this,this.M.detune,b,c,d);break;case 3:this.A[3]=b;W(this,this.M.Q,b,c,d);break;case 4:this.A[4]=b,W(this,this.M.gain,b,c,d)}}};
self.Fg=class extends Z{constructor(a,b,c,d){super(a);this.ja="delay";this.A=[b,c,d];this.F=V(this);this.l=V(this);this.l.gain.value=d;this.j=V(this);this.j.gain.value=1-d;this.Fc=V(this);this.qa=this.h.createDelay(b);this.qa.delayTime.value=b;this.sc=V(this);this.sc.gain.value=c;this.F.connect(this.Fc);this.F.connect(this.j);this.Fc.connect(this.l);this.Fc.connect(this.qa);this.qa.connect(this.sc);this.sc.connect(this.Fc)}o(){this.F.disconnect();this.l.disconnect();this.j.disconnect();this.Fc.disconnect();
this.qa.disconnect();this.sc.disconnect();super.o()}ka(a){this.l.disconnect();this.l.connect(a);this.j.disconnect();this.j.connect(a)}da(){return this.F}ua(a,b,c,d){const e=self.dc.sf;switch(a){case 0:b=Math.max(Math.min(b/100,1),0);this.A[2]=b;W(this,this.l.gain,b,c,d);W(this,this.j.gain,1-b,c,d);break;case 4:this.A[1]=e(b);W(this,this.sc.gain,e(b),c,d);break;case 5:this.A[0]=b,W(this,this.qa.delayTime,b,c,d)}}};
self.Eg=class extends Z{constructor(a,b,c,d){super(a);this.ja="convolution";this.A=[c,d];this.Lf=this.Kf="";this.F=V(this);this.l=V(this);this.l.gain.value=d;this.j=V(this);this.j.gain.value=1-d;this.qc=this.h.createConvolver();this.qc.normalize=c;this.qc.buffer=b;this.F.connect(this.qc);this.F.connect(this.j);this.qc.connect(this.l)}o(){this.F.disconnect();this.qc.disconnect();this.l.disconnect();this.j.disconnect();super.o()}ka(a){this.l.disconnect();this.l.connect(a);this.j.disconnect();this.j.connect(a)}da(){return this.F}ua(a,
b,c,d){switch(a){case 0:b=Math.max(Math.min(b/100,1),0),this.A[1]=b,W(this,this.l.gain,b,c,d),W(this,this.j.gain,1-b,c,d)}}fc(){const a=super.fc();a.bufferOriginalUrl=this.Kf;a.bufferUrl="";a.bufferType=this.Lf;return a}};
self.Ig=class extends Z{constructor(a,b,c,d,e,f){super(a);this.ja="flanger";this.A=[b,c,d,e,f];this.F=V(this);this.j=V(this);this.j.gain.value=1-f/2;this.l=V(this);this.l.gain.value=f/2;this.uc=V(this);this.uc.gain.value=e;this.qa=this.h.createDelay(b+c);this.qa.delayTime.value=b;this.J=this.h.createOscillator();this.J.frequency.value=d;this.$=V(this);this.$.gain.value=c;this.F.connect(this.qa);this.F.connect(this.j);this.qa.connect(this.l);this.qa.connect(this.uc);this.uc.connect(this.qa);this.J.connect(this.$);
this.$.connect(this.qa.delayTime);this.J.start(0)}o(){this.J.stop(0);this.F.disconnect();this.qa.disconnect();this.J.disconnect();this.$.disconnect();this.j.disconnect();this.l.disconnect();this.uc.disconnect();super.o()}ka(a){this.l.disconnect();this.l.connect(a);this.j.disconnect();this.j.connect(a)}da(){return this.F}ua(a,b,c,d){switch(a){case 0:b=Math.max(Math.min(b/100,1),0);this.A[4]=b;W(this,this.l.gain,b/2,c,d);W(this,this.j.gain,1-b/2,c,d);break;case 6:this.A[1]=b/1E3;W(this,this.$.gain,
b/1E3,c,d);break;case 7:this.A[2]=b;W(this,this.J.frequency,b,c,d);break;case 8:this.A[3]=b/100,W(this,this.uc.gain,b/100,c,d)}}};
self.Kg=class extends Z{constructor(a,b,c,d,e,f,g){super(a);this.ja="phaser";this.A=[b,c,d,e,f,g];this.F=V(this);this.j=V(this);this.j.gain.value=1-g/2;this.l=V(this);this.l.gain.value=g/2;this.M=this.h.createBiquadFilter();this.M.type="allpass";this.M.frequency.value=b;this.M.detune.value=c;this.M.Q.value=d;this.J=this.h.createOscillator();this.J.frequency.value=f;this.$=V(this);this.$.gain.value=e;this.F.connect(this.M);this.F.connect(this.j);this.M.connect(this.l);this.J.connect(this.$);this.$.connect(this.M.frequency);
this.J.start(0)}o(){this.J.stop(0);this.F.disconnect();this.M.disconnect();this.J.disconnect();this.$.disconnect();this.j.disconnect();this.l.disconnect();super.o()}ka(a){this.l.disconnect();this.l.connect(a);this.j.disconnect();this.j.connect(a)}da(){return this.F}ua(a,b,c,d){switch(a){case 0:b=Math.max(Math.min(b/100,1),0);this.A[5]=b;W(this,this.l.gain,b/2,c,d);W(this,this.j.gain,1-b/2,c,d);break;case 1:this.A[0]=b;W(this,this.M.frequency,b,c,d);break;case 2:this.A[1]=b;W(this,this.M.detune,b,
c,d);break;case 3:this.A[2]=b;W(this,this.M.Q,b,c,d);break;case 6:this.A[3]=b;W(this,this.$.gain,b,c,d);break;case 7:this.A[4]=b,W(this,this.J.frequency,b,c,d)}}};self.Jg=class extends Z{constructor(a,b){super(a);this.ja="gain";this.A=[b];this.v=V(this);this.v.gain.value=b}o(){this.v.disconnect();super.o()}ka(a){this.v.disconnect();this.v.connect(a)}da(){return this.v}ua(a,b,c,d){const e=self.dc.sf;switch(a){case 4:this.A[0]=e(b),W(this,this.v.gain,e(b),c,d)}}};
self.Mg=class extends Z{constructor(a,b){super(a);this.ja="stereopan";this.A=[b];this.v=this.h.createStereoPanner();this.v.pan.value=b}o(){this.v.disconnect();super.o()}ka(a){this.v.disconnect();this.v.connect(a)}da(){return this.v}ua(a,b,c,d){b=Math.min(Math.max(b/100,-1),1);switch(a){case 9:this.A[0]=b,W(this,this.v.pan,b,c,d)}}};
self.Ng=class extends Z{constructor(a,b,c){super(a);this.ja="tremolo";this.A=[b,c];this.v=V(this);this.v.gain.value=1-c/2;this.J=this.h.createOscillator();this.J.frequency.value=b;this.$=V(this);this.$.gain.value=c/2;this.J.connect(this.$);this.$.connect(this.v.gain);this.J.start(0)}o(){this.J.stop(0);this.J.disconnect();this.$.disconnect();this.v.disconnect();super.o()}ka(a){this.v.disconnect();this.v.connect(a)}da(){return this.v}ua(a,b,c,d){switch(a){case 0:b=Math.max(Math.min(b/100,1),0);this.A[1]=
b;W(this,this.v.gain,1-b/2,c,d);W(this,this.$.gain,b/2,c,d);break;case 7:this.A[0]=b,W(this,this.J.frequency,b,c,d)}}};
self.Lg=class extends Z{constructor(a,b,c){super(a);this.ja="ringmod";this.A=[b,c];this.F=V(this);this.l=V(this);this.l.gain.value=c;this.j=V(this);this.j.gain.value=1-c;this.Pc=V(this);this.Pc.gain.value=0;this.J=this.h.createOscillator();this.J.frequency.value=b;this.J.connect(this.Pc.gain);this.J.start(0);this.F.connect(this.Pc);this.F.connect(this.j);this.Pc.connect(this.l)}o(){this.J.stop(0);this.J.disconnect();this.Pc.disconnect();this.F.disconnect();this.l.disconnect();this.j.disconnect();
super.o()}ka(a){this.l.disconnect();this.l.connect(a);this.j.disconnect();this.j.connect(a)}da(){return this.F}ua(a,b,c,d){switch(a){case 0:b=Math.max(Math.min(b/100,1),0);this.A[1]=b;W(this,this.l.gain,b,c,d);W(this,this.j.gain,1-b,c,d);break;case 7:this.A[0]=b,W(this,this.J.frequency,b,c,d)}}};
self.Gg=class extends Z{constructor(a,b,c,d,e,f){super(a);this.ja="distortion";this.A=[b,c,d,e,f];this.F=V(this);this.Dd=V(this);this.Cd=V(this);a=d;.01>a&&(a=.01);this.Dd.gain.value=a;this.Cd.gain.value=Math.pow(1/a,.6)*e;this.l=V(this);this.l.gain.value=f;this.j=V(this);this.j.gain.value=1-f;this.Kd=this.h.createWaveShaper();this.ve=new Float32Array(65536);for(e=0;32768>e;++e)f=e/32768,a=1.05*c*b-b,d=0>f?-f:f,d<b?a=d:(d=1-Math.exp(-(1/a)*(d-b)),a=b+a*d),f=a*(0>f?-1:1),this.ve[32768+e]=f,this.ve[32768-
e-1]=-f;this.Kd.curve=this.ve;this.F.connect(this.Dd);this.F.connect(this.j);this.Dd.connect(this.Kd);this.Kd.connect(this.Cd);this.Cd.connect(this.l)}o(){this.F.disconnect();this.Dd.disconnect();this.Kd.disconnect();this.Cd.disconnect();this.l.disconnect();this.j.disconnect();super.o()}ka(a){this.l.disconnect();this.l.connect(a);this.j.disconnect();this.j.connect(a)}da(){return this.F}ua(a,b,c,d){switch(a){case 0:b=Math.max(Math.min(b/100,1),0),this.A[4]=b,W(this,this.l.gain,b,c,d),W(this,this.j.gain,
1-b,c,d)}}};self.Dg=class extends Z{constructor(a,b,c,d,e,f){super(a);this.ja="compressor";this.A=[b,c,d,e,f];this.v=this.h.createDynamicsCompressor();this.v.threshold.value=b;this.v.knee.value=c;this.v.ratio.value=d;this.v.attack.value=e;this.v.release.value=f}o(){this.v.disconnect();super.o()}ka(a){this.v.disconnect();this.v.connect(a)}da(){return this.v}ua(){}};
self.Cg=class extends Z{constructor(a,b,c){super(a);this.ja="analyser";this.A=[b,c];this.v=this.h.createAnalyser();this.v.fftSize=b;this.v.smoothingTimeConstant=c;this.Tf=new Float32Array(this.v.frequencyBinCount);this.lg=new Uint8Array(b);this.jg=this.Ub=0;a=this.D;a.Kb.add(this);kd(a)}o(){this.D.Kb.delete(this);this.v.disconnect();super.o()}na(){this.v.getFloatFrequencyData(this.Tf);this.v.getByteTimeDomainData(this.lg);const a=this.v.fftSize;let b=this.Ub=0;for(var c=0;c<a;++c){let d=(this.lg[c]-
128)/128;0>d&&(d=-d);this.Ub<d&&(this.Ub=d);b+=d*d}c=self.dc.dh;this.Ub=c(this.Ub);this.jg=c(Math.sqrt(b/a))}ka(a){this.v.disconnect();this.v.connect(a)}da(){return this.v}ua(){}};"use strict";
self.hb.ob(class extends self.ec{constructor(a){super(a,"mouse");ca(this,[["cursor",b=>{document.documentElement.style.cursor=b}],["request-pointer-lock",()=>{this.G.V.requestPointerLock()}],["release-pointer-lock",()=>{document.exitPointerLock()}]]);document.addEventListener("pointerlockchange",()=>{l(this,"pointer-lock-change",{"has-pointer-lock":!!document.pointerLockElement})});document.addEventListener("pointerlockerror",()=>{l(this,"pointer-lock-error",{"has-pointer-lock":!!document.pointerLockElement})})}});

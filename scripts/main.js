function l(a,b,c,d){a.B.lc(a.oc,b,c,d)}function aa(a,b,c){return a.B.uf(a.oc,b,c)}function da(a,b,c,d){a.B.Ca?l(a,b,c,d):a.B.jh()._OnMessageFromDOM({type:"event",component:a.oc,handler:b,dispatchOpts:d||null,data:c,responseId:null})}function n(a,b,c){a.B.K(a.oc,b,c)}function ea(a,b){for(const [c,d]of b)n(a,c,d)}function fa(a){a.ld||(a.B.vf(a.lg),a.ld=!0)}window.Gb=class{constructor(a,b){this.B=a;this.oc=b;this.ld=!1;this.lg=()=>this.na()}jf(){}na(){}};
window.$h=class{constructor(){this.bf=-1}o(){-1!==this.bf&&(self.clearTimeout(this.bf),this.bf=-1)}};"use strict";function ha(a,b){n(a,"get-element",c=>{const d=q(a,c.elementId);return b(d,c)})}function q(a,b){a=a.gd.get(b);if(!a)throw Error(`no element with id ${b}`);return a.Kf}
window.Zh=class extends self.Gb{constructor(a,b){super(a,b);this.gd=new Map;this.re=!0;ea(this,[["create",()=>{throw Error("required override");}],["destroy",c=>{c=c.elementId;const d=q(this,c);this.re&&d.parentElement.removeChild(d);this.gd.delete(c)}],["set-visible",c=>{if(this.re){var d=this.gd.get(c.elementId),e=d.Kf;d.Qf?e.style.display=c.isVisible?"":"none":d.Bh=!!c.isVisible}}],["update-position",c=>{if(this.re){var d=this.gd.get(c.elementId),e=d.Kf;e.style.left=c.left+"px";e.style.top=c.top+
"px";e.style.width=c.width+"px";e.style.height=c.height+"px";c=c.fontSize;null!==c&&(e.style.fontSize=c+"em");d.Qf||(d.Qf=!0,d.Bh&&(e.style.display=""))}}],["update-state",c=>{q(this,c.elementId);throw Error("required override");}],["focus",c=>this.me(c)],["set-css-style",c=>{const d=q(this,c.elementId),e=c.prop;c=c.val;e.startsWith("--")?d.style.setProperty(e,c):d.style[e]=c}],["set-attribute",c=>{q(this,c.elementId).setAttribute(c.name,c.val)}],["remove-attribute",c=>{q(this,c.elementId).removeAttribute(c.name)}]]);
ha(this,c=>c)}me(a){var b=q(this,a.elementId);a.focus?b.focus():b.blur()}};"use strict";const ia=/(iphone|ipod|ipad|macos|macintosh|mac os x)/i.test(navigator.userAgent),ja=/android/i.test(navigator.userAgent),ka=/safari/i.test(navigator.userAgent)&&!/(chrome|chromium|edg\/|OPR\/|nwjs)/i.test(navigator.userAgent);let la=0;
function ma(a){const b=document.createElement("script");b.async=!1;b.type="module";return a.Ph?new Promise(c=>{const d="c3_resolve_"+la;++la;self[d]=c;b.textContent=a.Th+`\n\nself["${d}"]();`;document.head.appendChild(b)}):new Promise((c,d)=>{b.onload=c;b.onerror=d;b.src=a;document.head.appendChild(b)})}let na=!1,pa=!1;function qa(){if(!na){try{new Worker("blob://",{get type(){pa=!0}})}catch(a){}na=!0}return pa}let u=new Audio;
const ra={"audio/webm; codecs=opus":!!u.canPlayType("audio/webm; codecs=opus"),"audio/ogg; codecs=opus":!!u.canPlayType("audio/ogg; codecs=opus"),"audio/webm; codecs=vorbis":!!u.canPlayType("audio/webm; codecs=vorbis"),"audio/ogg; codecs=vorbis":!!u.canPlayType("audio/ogg; codecs=vorbis"),"audio/mp4":!!u.canPlayType("audio/mp4"),"audio/mpeg":!!u.canPlayType("audio/mpeg")};u=null;async function sa(a){a=await ta(a);return(new TextDecoder("utf-8")).decode(a)}
function ta(a){return new Promise((b,c)=>{const d=new FileReader;d.onload=e=>b(e.target.result);d.onerror=e=>c(e);d.readAsArrayBuffer(a)})}const ua=[];let va=0;window.RealFile=window.File;const wa=[],xa=new Map,ya=new Map;let za=0;const Aa=[];self.runOnStartup=function(a){if("function"!==typeof a)throw Error("runOnStartup called without a function");Aa.push(a)};const Ba=new Set(["cordova","playable-ad","instant-games"]);let Ca=!1;
window.ib=class a{constructor(b){this.Ca=b.Vh;this.lb=null;this.Ba="";this.Zb=b.Sh;this.Rc={};this.Qb=this.fb=null;this.fd=[];this.V=this.Va=null;this.Ie=!1;this.Nf=0;this.zc=null;this.Xb=-1;this.Hh=()=>this.rh();this.Wb=[];this.cf=null;this.mg=[];this.G=b.ng;this.md="file"===location.protocol.substr(0,4);!this.Ca||"undefined"!==typeof OffscreenCanvas&&navigator.userActivation&&qa()||(this.Ca=!1);this.Ca&&ka&&(this.Ca=!1);if("playable-ad"===this.G||"instant-games"===this.G)this.Ca=!1;if("cordova"===
this.G&&this.Ca)if(ja){const c=/Chrome\/(\d+)/i.exec(navigator.userAgent);c&&90<=parseInt(c[1],10)||(this.Ca=!1)}else this.Ca=!1;this.hb()?self.chrome.webview.addEventListener("message",c=>this.Af(c.data)):"macos-wkwebview"===this.G&&(self.C3WrapperOnMessage=c=>this.Af(c));this.sd=this.$a=null;"html5"!==this.G||window.isSecureContext||console.warn("[Construct] Warning: the browser indicates this is not a secure context. Some features may be unavailable. Use secure (HTTPS) hosting to ensure all features are available.");
this.K("runtime","cordova-fetch-local-file",c=>this.nh(c));this.K("runtime","create-job-worker",()=>this.oh());this.K("runtime","send-wrapper-extension-message",c=>this.uh(c));"cordova"===this.G?document.addEventListener("deviceready",()=>this.yf(b)):this.yf(b)}o(){this.ee();this.lb&&(this.lb=this.lb.onmessage=null);this.fb&&(this.fb.terminate(),this.fb=null);this.Qb&&(this.Qb.o(),this.Qb=null);this.V&&(this.V.parentElement.removeChild(this.V),this.V=null)}Yg(){return ia&&"cordova"===this.G}Yd(){const b=
navigator.userAgent;return ia&&Ba.has(this.G)||navigator.standalone||/crios\/|fxios\/|edgios\//i.test(b)}Wg(){return ja}rf(){return ja&&Ba.has(this.G)}hb(){return"windows-webview2"===this.G||!!("preview"===this.G&&window.chrome&&window.chrome.webview&&window.chrome.webview.postMessage)}async yf(b){"macos-wkwebview"===this.G?this.sb({type:"ready"}):this.hb()&&(this.xh(),this.mg=(await this.mh()).registeredComponentIds);if("playable-ad"===this.G){this.$a=self.c3_base64files;this.sd={};await this.fh();
for(let d=0,e=b.cc.length;d<e;++d){var c=b.cc[d];this.sd.hasOwnProperty(c)?b.cc[d]={Ph:!0,Th:this.sd[c]}:this.$a.hasOwnProperty(c)&&(b.cc[d]=URL.createObjectURL(this.$a[c]))}b.Od=[]}if("nwjs"===this.G&&self.nw&&self.nw.App.manifest["c3-steam-mode"]){let d=0;this.vf(()=>{d++;document.body.style.opacity=0===d%2?"1":"0.999"})}b.Rh?this.Ba=b.Rh:(c=location.origin,this.Ba=("null"===c?"file:///":c)+location.pathname,c=this.Ba.lastIndexOf("/"),-1!==c&&(this.Ba=this.Ba.substr(0,c+1)));b.Xh&&(this.Rc=b.Xh);
c=new MessageChannel;this.lb=c.port1;this.lb.onmessage=d=>this._OnMessageFromRuntime(d.data);window.c3_addPortMessageHandler&&window.c3_addPortMessageHandler(d=>this.qh(d));this.zc=new self.Zg(this);await Da(this.zc);"object"===typeof window.StatusBar&&window.StatusBar.hide();if("object"===typeof window.AndroidFullScreen)try{await new Promise((d,e)=>{window.AndroidFullScreen.immersiveMode(d,e)})}catch(d){console.error("Failed to enter Android immersive mode: ",d)}this.Ca?await this.lh(b,c.port2):
await this.kh(b,c.port2)}ge(b){b=this.Rc.hasOwnProperty(b)?this.Rc[b]:b.endsWith("/workermain.js")&&this.Rc.hasOwnProperty("workermain.js")?this.Rc["workermain.js"]:"playable-ad"===this.G&&this.$a.hasOwnProperty(b)?this.$a[b]:b;b instanceof Blob&&(b=URL.createObjectURL(b));return b}async Sd(b,c,d){if(b.startsWith("blob:"))return new Worker(b,d);if("cordova"===this.G&&this.md)return b=await this.Tc(d.Oh?b:this.Zb+b),new Worker(URL.createObjectURL(new Blob([b],{type:"application/javascript"})),d);b=
new URL(b,c);if(location.origin!==b.origin){b=await fetch(b);if(!b.ok)throw Error("failed to fetch worker script");b=await b.blob();return new Worker(URL.createObjectURL(b),d)}return new Worker(b,d)}Xa(){return Math.max(window.innerWidth,1)}Na(){return Math.max(window.innerHeight,1)}xf(b){var c=this.Ba,d=location.href,e=this.Xa(),f=this.Na(),g=window.devicePixelRatio,h=a.jc(),k=b.di,v=window.cr_previewImageBlobs||this.$a,p=window.cr_previewProjectFileBlobs,D=window.cr_previewProjectFiles,y=window.cr_swClientId||
"";b=b.ng;var r=(new URLSearchParams(self.location.search)).has("debug"),t=this.zc;return{runtimeBaseUrl:c,previewUrl:d,windowInnerWidth:e,windowInnerHeight:f,devicePixelRatio:g,isFullscreen:h,projectData:k,previewImageBlobs:v,previewProjectFileBlobs:p,previewProjectFileSWUrls:D,swClientId:y,exportType:b,isDebug:r,ife:!!self.ci,jobScheduler:{inputPort:t.Ge,outputPort:t.Te,maxNumWorkers:t.Ch},supportedAudioFormats:ra,opusWasmScriptUrl:window.cr_opusWasmScriptUrl||this.Zb+"opus.wasm.js",opusWasmBinaryUrl:window.cr_opusWasmBinaryUrl||
this.Zb+"opus.wasm.wasm",isFileProtocol:this.md,isiOSCordova:this.Yg(),isiOSWebView:this.Yd(),isWebView2Wrapper:this.hb(),wrapperComponentIds:this.mg,isFBInstantAvailable:"undefined"!==typeof self.FBInstant}}async lh(b,c){const d=this.ge(b.Wh);"preview"===this.G?(this.fb=new Worker("previewworker.js",{type:"module",name:"Runtime"}),await new Promise((h,k)=>{const v=p=>{this.fb.removeEventListener("message",v);p.data&&"ok"===p.data.type?h():k()};this.fb.addEventListener("message",v);this.fb.postMessage({type:"construct-worker-init",
"import":(new URL(d,this.Ba)).toString()})})):this.fb=await this.Sd(d,this.Ba,{type:"module",name:"Runtime",Oh:!0});this.V=document.createElement("canvas");this.V.style.display="none";const e=this.V.transferControlToOffscreen();document.body.appendChild(this.V);window.c3canvas=this.V;self.C3_InsertHTMLPlaceholders&&self.C3_InsertHTMLPlaceholders();let f=b.Od||[],g=b.cc;f=await Promise.all(f.map(h=>this.Kb(h)));g=await Promise.all(g.map(h=>this.Kb(h)));if("cordova"===this.G)for(let h=0,k=b.Nd.length;h<
k;++h){const v=b.Nd[h],p=v[0];if(p===b.ff||"scriptsInEvents.js"===p||p.endsWith("/scriptsInEvents.js"))v[1]=await this.Kb(p)}this.fb.postMessage(Object.assign(this.xf(b),{type:"init-runtime",isInWorker:!0,messagePort:c,canvas:e,workerDependencyScripts:f,engineScripts:g,projectScripts:b.Nd,mainProjectScript:b.ff,projectScriptsStatus:self.C3_ProjectScriptsStatus}),[c,e,...Ea(this.zc)]);this.fd=wa.map(h=>new h(this));this.wf();Fa(this.Va);self.c3_callFunction=(h,k)=>aa(this.Va,"js-invoke-function",{name:h,
params:k});"preview"===this.G&&(self.goToLastErrorScript=()=>this.lc("runtime","go-to-last-error-script"))}async kh(b,c){this.V=document.createElement("canvas");this.V.style.display="none";document.body.appendChild(this.V);window.c3canvas=this.V;self.C3_InsertHTMLPlaceholders&&self.C3_InsertHTMLPlaceholders();this.fd=wa.map(g=>new g(this));this.wf();var d=b.cc.map(g=>"string"===typeof g?(new URL(g,this.Ba)).toString():g);if(Array.isArray(b.Od)){var e=[...b.Od].map(g=>g instanceof Blob?URL.createObjectURL(g):
g);d.unshift(...e)}d=await Promise.all(d.map(g=>this.Kb(g)));await Promise.all(d.map(g=>ma(g)));d=self.C3_ProjectScriptsStatus;e=b.ff;const f=b.Nd;for(let [g,h]of f)if(h||(h=g),g===e)try{h=await this.Kb(h),await ma(h),"preview"!==this.G||d[g]||this.Bf(g,"main script did not run to completion")}catch(k){this.Bf(g,k)}else if("scriptsInEvents.js"===g||g.endsWith("/scriptsInEvents.js"))h=await this.Kb(h),await ma(h);"preview"===this.G&&"object"!==typeof self.Yh.ai?(this.Yc(),console.error("[C3 runtime] Failed to load JavaScript code used in events. Check all your JavaScript code has valid syntax."),
alert("Failed to load JavaScript code used in events. Check all your JavaScript code has valid syntax.")):(b=Object.assign(this.xf(b),{isInWorker:!1,messagePort:c,canvas:this.V,runOnStartupFunctions:Aa}),Fa(this.Va),this.zf(),this.Qb=self.C3_CreateRuntime(b),await self.C3_InitRuntime(this.Qb,b))}Bf(b,c){this.Yc();console.error(`[Preview] Failed to load project main script (${b}): `,c);alert(`Failed to load project main script (${b}). Check all your JavaScript code has valid syntax. Press F12 and check the console for error details.`)}zf(){this.Yc()}Yc(){const b=
window.cr_previewLoadingElem;b&&(b.parentElement.removeChild(b),window.cr_previewLoadingElem=null)}async oh(){const b=await Ga(this.zc);return{outputPort:b,transferables:[b]}}jh(){if(this.Ca)throw Error("not available in worker mode");return this.Qb}lc(b,c,d,e,f){this.lb.postMessage({type:"event",component:b,handler:c,dispatchOpts:e||null,data:d,responseId:null},f)}uf(b,c,d,e,f){const g=za++,h=new Promise((k,v)=>{ya.set(g,{resolve:k,reject:v})});this.lb.postMessage({type:"event",component:b,handler:c,
dispatchOpts:e||null,data:d,responseId:g},f);return h}_OnMessageFromRuntime(b){const c=b.type;if("event"===c)return this.ph(b);if("result"===c)this.sh(b);else if("runtime-ready"===c)this.th();else if("alert-error"===c)this.Yc(),alert(b.message);else if("creating-runtime"===c)this.zf();else throw Error(`unknown message '${c}'`);}ph(b){const c=b.component,d=b.handler,e=b.data,f=b.responseId;if(b=xa.get(c))if(b=b.get(d)){var g=null;try{g=b(e)}catch(h){console.error(`Exception in '${c}' handler '${d}':`,
h);null!==f&&this.Xc(f,!1,""+h);return}if(null===f)return g;g&&g.then?g.then(h=>this.Xc(f,!0,h)).catch(h=>{console.error(`Rejection from '${c}' handler '${d}':`,h);this.Xc(f,!1,""+h)}):this.Xc(f,!0,g)}else console.warn(`[DOM] No handler '${d}' for component '${c}'`);else console.warn(`[DOM] No event handlers for component '${c}'`)}Xc(b,c,d){let e;d&&d.transferables&&(e=d.transferables);this.lb.postMessage({type:"result",responseId:b,isOk:c,result:d},e)}sh(b){const c=b.responseId,d=b.isOk;b=b.result;
const e=ya.get(c);d?e.resolve(b):e.reject(b);ya.delete(c)}K(b,c,d){let e=xa.get(b);e||(e=new Map,xa.set(b,e));if(e.has(c))throw Error(`[DOM] Component '${b}' already has handler '${c}'`);e.set(c,d)}static ec(b){if(wa.includes(b))throw Error("DOM handler already added");wa.push(b)}wf(){for(const b of this.fd)if("runtime"===b.oc){this.Va=b;return}throw Error("cannot find runtime DOM handler");}qh(b){this.lc("debugger","message",b)}th(){for(const b of this.fd)b.jf()}static jc(){return!!(document.fullscreenElement||
document.webkitFullscreenElement||document.mozFullScreenElement||Ca)}static Zc(b){Ca=!!b}vf(b){this.Wb.push(b);this.oe()}wh(b){b=this.Wb.indexOf(b);if(-1===b)throw Error("invalid callback");this.Wb.splice(b,1);this.Wb.length||this.ee()}oe(){-1===this.Xb&&this.Wb.length&&(this.Xb=requestAnimationFrame(this.Hh))}ee(){-1!==this.Xb&&(cancelAnimationFrame(this.Xb),this.Xb=-1)}rh(){this.Xb=-1;for(const b of this.Wb)b();this.oe()}rb(b){this.Va.rb(b)}Jb(b){this.Va.Jb(b)}ne(){this.Va.ne()}Wc(b){this.Va.Wc(b)}Xg(){return!!ra["audio/webm; codecs=opus"]}async yh(b){b=
await this.uf("runtime","opus-decode",{arrayBuffer:b},null,[b]);return new Float32Array(b)}ah(b){this.Ie=!0;this.Nf=b}Vg(b){return/^(?:[a-z\-]+:)?\/\//.test(b)||"data:"===b.substr(0,5)||"blob:"===b.substr(0,5)}sf(b){return!this.Vg(b)}async Kb(b){return"cordova"===this.G&&(b.startsWith("file:")||this.md&&this.sf(b))?(b.startsWith(this.Ba)&&(b=b.substr(this.Ba.length)),b=await this.Tc(b),URL.createObjectURL(new Blob([b],{type:"application/javascript"}))):b}async nh(b){const c=b.filename;switch(b.as){case "text":return await this.Tg(c);
case "buffer":return await this.Tc(c);default:throw Error("unsupported type");}}mf(b){const c=window.cordova.file.applicationDirectory+"www/"+b;return new Promise((d,e)=>{window.resolveLocalFileSystemURL(c,f=>{f.file(d,e)},e)})}async Tg(b){b=await this.mf(b);return await sa(b)}fe(){if(ua.length&&!(8<=va)){va++;var b=ua.shift();this.gh(b.filename,b.Uh,b.Mh)}}Tc(b){return new Promise((c,d)=>{ua.push({filename:b,Uh:e=>{va--;this.fe();c(e)},Mh:e=>{va--;this.fe();d(e)}});this.fe()})}async gh(b,c,d){try{const e=
await this.mf(b),f=await ta(e);c(f)}catch(e){d(e)}}Af(b){if("entered-fullscreen"===b)a.Zc(!0),Ha(this.Va);else if("exited-fullscreen"===b)a.Zc(!1),Ha(this.Va);else if("object"===typeof b){const c=b.type;"wrapper-init-response"===c?(this.cf(b),this.cf=null):"extension-message"===c?this.lc("runtime","wrapper-extension-message",b):console.warn("Unknown wrapper message: ",b)}else console.warn("Unknown wrapper message: ",b)}uh(b){this.sb({type:"extension-message",componentId:b.componentId,messageId:b.messageId,
params:b.params||[],asyncId:b.asyncId})}sb(b){this.hb()?window.chrome.webview.postMessage(JSON.stringify(b)):"macos-wkwebview"===this.G&&window.webkit.messageHandlers.C3Wrapper.postMessage(JSON.stringify(b))}xh(){window.moveTo=(b,c)=>{this.sb({type:"set-window-position",windowX:Math.ceil(b),windowY:Math.ceil(c)})};window.resizeTo=(b,c)=>{this.sb({type:"set-window-size",windowWidth:Math.ceil(b),windowHeight:Math.ceil(c)})}}mh(){return this.hb()?new Promise(b=>{this.cf=b;this.sb({type:"wrapper-init"})}):
Promise.resolve()}async fh(){const b=[];for(const [c,d]of Object.entries(this.$a))b.push(this.eh(c,d));await Promise.all(b)}async eh(b,c){if("object"===typeof c)this.$a[b]=new Blob([c.str],{type:c.type}),this.sd[b]=c.str;else{let d=await this.ih(c);d||(d=this.hh(c));this.$a[b]=d}}async ih(b){try{return await (await fetch(b)).blob()}catch(c){return console.warn("Failed to fetch a data: URI. Falling back to a slower workaround. This is probably because the Content Security Policy unnecessarily blocked it. Allow data: URIs in your CSP to avoid this.",
c),null}}hh(b){b=this.vh(b);return this.dh(b.data,b.Qh)}vh(b){var c=b.indexOf(",");if(0>c)throw new URIError("expected comma in data: uri");var d=b.substring(c+1);c=b.substring(5,c).split(";");b=c[0]||"";const e=c[2];d="base64"===c[1]||"base64"===e?atob(d):decodeURIComponent(d);return{Qh:b,data:d}}dh(b,c){var d=b.length;let e=d>>2,f=new Uint8Array(d),g=new Uint32Array(f.buffer,0,e),h,k;for(k=h=0;h<e;++h)g[h]=b.charCodeAt(k++)|b.charCodeAt(k++)<<8|b.charCodeAt(k++)<<16|b.charCodeAt(k++)<<24;for(d&=
3;d--;)f[k]=b.charCodeAt(k),++k;return new Blob([f],{type:c})}};"use strict";const Ia=self.ib;function Ja(a){return a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||a.originalEvent&&a.originalEvent.sourceCapabilities&&a.originalEvent.sourceCapabilities.firesTouchEvents}const Ka=new Map([["OSLeft","MetaLeft"],["OSRight","MetaRight"]]),z={dispatchRuntimeEvent:!0,dispatchUserScriptEvent:!0},La={dispatchUserScriptEvent:!0},Ma={dispatchRuntimeEvent:!0};
function Na(a){return new Promise((b,c)=>{const d=document.createElement("link");d.onload=()=>b(d);d.onerror=e=>c(e);d.rel="stylesheet";d.href=a;document.head.appendChild(d)})}function Oa(a){return new Promise((b,c)=>{const d=new Image;d.onload=()=>b(d);d.onerror=e=>c(e);d.src=a})}async function Pa(a){a=URL.createObjectURL(a);try{return await Oa(a)}finally{URL.revokeObjectURL(a)}}
function Qa(a){return new Promise((b,c)=>{let d=new FileReader;d.onload=e=>b(e.target.result);d.onerror=e=>c(e);d.readAsText(a)})}
async function Ra(a,b,c){if(!/firefox/i.test(navigator.userAgent))return await Pa(a);var d=await Qa(a);d=(new DOMParser).parseFromString(d,"image/svg+xml");const e=d.documentElement;if(e.hasAttribute("width")&&e.hasAttribute("height")){const f=e.getAttribute("width"),g=e.getAttribute("height");if(!f.includes("%")&&!g.includes("%"))return await Pa(a)}e.setAttribute("width",b+"px");e.setAttribute("height",c+"px");d=(new XMLSerializer).serializeToString(d);a=new Blob([d],{type:"image/svg+xml"});return await Pa(a)}
function Sa(a){do{if(a.parentNode&&a.hasAttribute("contenteditable"))return!0;a=a.parentNode}while(a);return!1}const Ta=new Set(["input","textarea","datalist","select"]),Ua=new Set(["canvas","body","html"]);function B(a){a.target.tagName&&Ua.has(a.target.tagName.toLowerCase())&&a.preventDefault()}function Va(a){(a.metaKey||a.ctrlKey)&&a.preventDefault()}
self.C3_GetSvgImageSize=async function(a){a=await Pa(a);if(0<a.width&&0<a.height)return[a.width,a.height];a.style.position="absolute";a.style.left="0px";a.style.top="0px";a.style.visibility="hidden";document.body.appendChild(a);const b=a.getBoundingClientRect();document.body.removeChild(a);return[b.width,b.height]};self.C3_RasterSvgImageBlob=async function(a,b,c,d,e){a=await Ra(a,b,c);const f=document.createElement("canvas");f.width=d;f.height=e;f.getContext("2d").drawImage(a,0,0,b,c);return f};
let Wa=!1;document.addEventListener("pause",()=>Wa=!0);document.addEventListener("resume",()=>Wa=!1);function Fa(a){a.Mf=!0;a.Oe=a.B.Xa();a.Ac=a.B.Na()}function Ha(a){if(!a.wa){var b=Ia.jc();b&&"any"!==a.$e&&Xa(a);l(a,"fullscreenchange",{isFullscreen:b,innerWidth:a.Xa(),innerHeight:a.Na()})}}async function Ya(a){await Promise.all(a.webfonts.map(async b=>{b=new FontFace(b.name,`url('${b.url}')`);document.fonts.add(b);await b.load()}))}
async function Za(a){var b=a.imageBitmapOpts;a=await self.C3_RasterSvgImageBlob(a.blob,a.imageWidth,a.imageHeight,a.surfaceWidth,a.surfaceHeight);b=b?await createImageBitmap(a,b):await createImageBitmap(a);return{imageBitmap:b,transferables:[b]}}async function $a(a){return await self.C3_GetSvgImageSize(a.blob)}function ab(a){window.c3_postToMessagePort&&(a.from="runtime",window.c3_postToMessagePort(a))}
function bb(a){self.setTimeout(()=>{a.Lf=!0},1E3);"cordova"===a.B.G?(document.addEventListener("pause",()=>cb(a,!0)),document.addEventListener("resume",()=>cb(a,!1))):document.addEventListener("visibilitychange",()=>cb(a,"hidden"===document.visibilityState));a.wd=!("hidden"!==document.visibilityState&&!Wa);return{isSuspended:a.wd}}
function db(a){a.Df||(a.Df=!0,window.addEventListener("deviceorientation",b=>{a.wa||l(a,"deviceorientation",{absolute:!!b.absolute,alpha:b.alpha||0,beta:b.beta||0,gamma:b.gamma||0,timeStamp:b.timeStamp,webkitCompassHeading:b.webkitCompassHeading,webkitCompassAccuracy:b.webkitCompassAccuracy},z)}),window.addEventListener("deviceorientationabsolute",b=>{a.wa||l(a,"deviceorientationabsolute",{absolute:!!b.absolute,alpha:b.alpha||0,beta:b.beta||0,gamma:b.gamma||0,timeStamp:b.timeStamp},z)}))}
function eb(a){a.Cf||(a.Cf=!0,window.addEventListener("devicemotion",b=>{if(!a.wa){var c=null,d=b.acceleration;d&&(c={x:d.x||0,y:d.y||0,z:d.z||0});d=null;var e=b.accelerationIncludingGravity;e&&(d={x:e.x||0,y:e.y||0,z:e.z||0});e=null;var f=b.rotationRate;f&&(e={alpha:f.alpha||0,beta:f.beta||0,gamma:f.gamma||0});l(a,"devicemotion",{acceleration:c,accelerationIncludingGravity:d,rotationRate:e,interval:b.interval,timeStamp:b.timeStamp},z)}}))}async function fb(a){await Na(a.url)}
function gb(a,b){a.Of=b.message;-1===a.xe&&(a.xe=setTimeout(()=>{a.xe=-1;const c=document.getElementById("exportToVideoMessage");c&&(c.textContent=a.Of)},250))}function hb(a,b){console.warn("[Construct] Fullscreen request failed: ",b);l(a,"fullscreenerror",{isFullscreen:Ia.jc(),innerWidth:a.Xa(),innerHeight:a.Na()})}function cb(a,b){a.wd!==b&&((a.wd=b)?a.B.ee():a.B.oe(),l(a,"visibilitychange",{hidden:b}))}
function jb(a,b,c){"Backspace"===c.key&&B(c);if(!a.wa){var d=Ka.get(c.code)||c.code;da(a,b,{code:d,key:c.key,which:c.which,repeat:c.repeat,altKey:c.altKey,ctrlKey:c.ctrlKey,metaKey:c.metaKey,shiftKey:c.shiftKey,timeStamp:c.timeStamp},z)}}function kb(a,b,c,d){a.wa||Ja(c)||da(a,b,{button:c.button,buttons:c.buttons,clientX:c.clientX,clientY:c.clientY+a.Da,pageX:c.pageX,pageY:c.pageY+a.Da,movementX:c.movementX||0,movementY:c.movementY||0,timeStamp:c.timeStamp},d)}
function lb(a){window!==window.top&&window.focus();mb(a.target)&&document.activeElement&&!mb(document.activeElement)&&document.activeElement.blur()}
function nb(a,b,c){if(!a.wa){var d=0;"mouse"===c.pointerType&&(d=a.Fc);da(a,b,{pointerId:c.pointerId,pointerType:c.pointerType,button:c.button,buttons:c.buttons,lastButtons:d,clientX:c.clientX,clientY:c.clientY+a.Da,pageX:c.pageX,pageY:c.pageY+a.Da,movementX:c.movementX||0,movementY:c.movementY||0,width:c.width||0,height:c.height||0,pressure:c.pressure||0,tangentialPressure:c.tangentialPressure||0,tiltX:c.tiltX||0,tiltY:c.tiltY||0,twist:c.twist||0,timeStamp:c.timeStamp},z);"mouse"===c.pointerType&&
(d="mousemove","pointerdown"===b?d="mousedown":"pointerup"===b&&(d="mouseup"),kb(a,d,c,La),a.Fc=c.buttons)}}
function ob(a,b,c){if(!a.wa&&!Ja(c)){var d=a.Fc;"pointerdown"===b&&0!==d?b="pointermove":"pointerup"===b&&0!==c.buttons&&(b="pointermove");da(a,b,{pointerId:1,pointerType:"mouse",button:c.button,buttons:c.buttons,lastButtons:d,clientX:c.clientX,clientY:c.clientY+a.Da,pageX:c.pageX,pageY:c.pageY+a.Da,movementX:c.movementX||0,movementY:c.movementY||0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,timeStamp:c.timeStamp},z);a.Fc=c.buttons;kb(a,c.type,c,La)}}
function pb(a,b,c){if(!a.wa)for(let d=0,e=c.changedTouches.length;d<e;++d){const f=c.changedTouches[d];da(a,b,{pointerId:f.identifier,pointerType:"touch",button:0,buttons:0,lastButtons:0,clientX:f.clientX,clientY:f.clientY+a.Da,pageX:f.pageX,pageY:f.pageY+a.Da,movementX:c.movementX||0,movementY:c.movementY||0,width:2*(f.radiusX||f.webkitRadiusX||0),height:2*(f.radiusY||f.webkitRadiusY||0),pressure:f.force||f.webkitForce||0,tangentialPressure:0,tiltX:0,tiltY:0,twist:f.rotationAngle||0,timeStamp:c.timeStamp},
z)}}function qb(a,b,c){document.body.style.transform="";a.Da=0;if(0<c){var d=document.activeElement;d&&(d=d.getBoundingClientRect(),b=(d.top+d.bottom)/2-(b-c)/2,b>c&&(b=c),0>b&&(b=0),0<b&&(document.body.style.transform=`translateY(${-b}px)`,a.Da=b))}}function rb(a,b,c,d){const e=a.Xa(),f=a.Na();a.$b=-1;e!=b||f!=c?l(a,"window-resize",{innerWidth:e,innerHeight:f,devicePixelRatio:window.devicePixelRatio,isFullscreen:Ia.jc()}):10>d&&sb(a,e,f,d+1)}
function sb(a,b,c,d){-1!==a.$b&&clearTimeout(a.$b);a.$b=setTimeout(()=>rb(a,b,c,d),48)}
function Xa(a){a=a.$e;if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(a).catch(b=>console.warn("[Construct] Failed to lock orientation: ",b));else try{let b=!1;screen.lockOrientation?b=screen.lockOrientation(a):screen.webkitLockOrientation?b=screen.webkitLockOrientation(a):screen.mozLockOrientation?b=screen.mozLockOrientation(a):screen.msLockOrientation&&(b=screen.msLockOrientation(a));b||console.warn("[Construct] Failed to lock orientation")}catch(b){console.warn("[Construct] Failed to lock orientation: ",
b)}}function mb(a){return!a||a===document||a===window||a===document.body||"canvas"===a.tagName.toLowerCase()}
Ia.ec(class extends self.Gb{constructor(a){super(a,"runtime");this.Tf=!0;this.Mf=!1;this.$b=-1;this.$e="any";this.wd=this.Cf=this.Df=!1;this.Cd=document.createElement("div");this.Cd.className="c3-screen-reader-text";this.Cd.setAttribute("aria-live","polite");document.body.appendChild(this.Cd);this.zb=null;this.wa=!1;this.Of="";this.xe=-1;this.Lf=!1;this.Oe=a.Xa();this.Ac=a.Na();this.Da=this.Qc=0;a.K("canvas","update-size",d=>{var e=this.B;e.Ie||(e=e.V,e.style.width=d.styleWidth+"px",e.style.height=
d.styleHeight+"px",e.style.marginLeft=d.marginLeft+"px",e.style.marginTop=d.marginTop+"px",document.documentElement.style.setProperty("--construct-scale",d.displayScale),this.Tf&&(e.style.display="",this.Tf=!1))});a.K("runtime","invoke-download",d=>{const e=d.url;d=d.filename;const f=document.createElement("a"),g=document.body;f.textContent=d;f.href=e;f.download=d;g.appendChild(f);f.click();g.removeChild(f)});a.K("runtime","load-webfonts",d=>Ya(d));a.K("runtime","raster-svg-image",d=>Za(d));a.K("runtime",
"get-svg-image-size",d=>$a(d));a.K("runtime","set-target-orientation",d=>{this.$e=d.targetOrientation});a.K("runtime","register-sw",()=>{window.C3_RegisterSW&&window.C3_RegisterSW()});a.K("runtime","post-to-debugger",d=>ab(d));a.K("runtime","go-to-script",d=>ab(d));a.K("runtime","before-start-ticking",()=>bb(this));a.K("runtime","debug-highlight",d=>{if(d.show){this.zb||(this.zb=document.createElement("div"),this.zb.id="inspectOutline",document.body.appendChild(this.zb));var e=this.zb;e.style.display=
"";e.style.left=d.left-1+"px";e.style.top=d.top-1+"px";e.style.width=d.width+2+"px";e.style.height=d.height+2+"px";e.textContent=d.name}else this.zb&&(this.zb.style.display="none")});a.K("runtime","enable-device-orientation",()=>db(this));a.K("runtime","enable-device-motion",()=>eb(this));a.K("runtime","add-stylesheet",d=>fb(d));a.K("runtime","script-create-worker",d=>{const e=d.port2;(new Worker(d.url,d.opts)).postMessage({type:"construct-worker-init",port2:e},[e])});a.K("runtime","alert",d=>this.je(d));
a.K("runtime","screen-reader-text",d=>{var e=d.type;"create"===e?(e=document.createElement("p"),e.id="c3-sr-"+d.id,e.textContent=d.text,this.Cd.appendChild(e)):"update"===e?(e=document.getElementById("c3-sr-"+d.id))?e.textContent=d.text:console.warn(`[Construct] Missing screen reader text with id ${d.id}`):"release"===e?(e=document.getElementById("c3-sr-"+d.id))?e.remove():console.warn(`[Construct] Missing screen reader text with id ${d.id}`):console.warn(`[Construct] Unknown screen reader text update '${e}'`)});
a.K("runtime","hide-cordova-splash",()=>{navigator.splashscreen&&navigator.splashscreen.hide&&navigator.splashscreen.hide()});a.K("runtime","set-exporting-to-video",d=>{this.wa=!0;const e=document.createElement("h1");e.id="exportToVideoMessage";e.textContent=d.message;document.body.prepend(e);document.body.classList.add("exportingToVideo");this.B.V.style.display="";this.B.ah(d.duration)});a.K("runtime","export-to-video-progress",d=>gb(this,d));a.K("runtime","exported-to-video",d=>{window.Lh({type:"exported-video",
arrayBuffer:d.arrayBuffer,contentType:d.contentType,time:d.time})});a.K("runtime","exported-to-image-sequence",d=>{window.Lh({type:"exported-image-sequence",blobArr:d.blobArr,time:d.time,gif:d.gif})});const b=new Set(["input","textarea","datalist"]);window.addEventListener("contextmenu",d=>{const e=d.target;b.has(e.tagName.toLowerCase())||Sa(e)||d.preventDefault()});const c=a.V;window.addEventListener("selectstart",B);window.addEventListener("gesturehold",B);c.addEventListener("selectstart",B);c.addEventListener("gesturehold",
B);window.addEventListener("touchstart",B,{passive:!1});"undefined"!==typeof PointerEvent?(window.addEventListener("pointerdown",B,{passive:!1}),c.addEventListener("pointerdown",B)):c.addEventListener("touchstart",B);this.Fc=0;window.addEventListener("mousedown",d=>{1===d.button&&d.preventDefault()});window.addEventListener("mousewheel",Va,{passive:!1});window.addEventListener("wheel",Va,{passive:!1});window.addEventListener("resize",()=>{a:{if(!this.wa&&this.Mf){var d=this.Xa();var e=this.Na();if(this.B.rf()){if(this.Lf){if(this.Oe===
d&&e<this.Ac){this.Qc=this.Ac-e;qb(this,this.Ac,this.Qc);d=void 0;break a}0<this.Qc&&(this.Qc=0,qb(this,e,this.Qc))}this.Oe=d;this.Ac=e}l(this,"window-resize",{innerWidth:d,innerHeight:e,devicePixelRatio:window.devicePixelRatio,isFullscreen:Ia.jc()});this.B.Yd()&&(-1!==this.$b&&clearTimeout(this.$b),rb(this,d,e,0))}d=void 0}return d});window.addEventListener("fullscreenchange",()=>Ha(this));window.addEventListener("webkitfullscreenchange",()=>Ha(this));window.addEventListener("mozfullscreenchange",
()=>Ha(this));window.addEventListener("fullscreenerror",d=>hb(this,d));window.addEventListener("webkitfullscreenerror",d=>hb(this,d));window.addEventListener("mozfullscreenerror",d=>hb(this,d));if(a.Yd())if(window.visualViewport){let d=Infinity;window.visualViewport.addEventListener("resize",()=>{const e=window.visualViewport.height;e>d&&(document.scrollingElement.scrollTop=0);d=e})}else window.addEventListener("focusout",()=>{{const f=document.activeElement;if(f){var d=f.tagName.toLowerCase();var e=
new Set("email number password search tel text url".split(" "));d="textarea"===d?!0:"input"===d?e.has(f.type.toLowerCase()||"text"):Sa(f)}else d=!1}d||(document.scrollingElement.scrollTop=0)});this.Rb=new Set;this.ud=new WeakSet;this.kb=!1}jf(){window.addEventListener("focus",()=>{l(this,"window-focus",null,Ma)});window.addEventListener("blur",()=>{try{var b=window.parent&&window.parent.document.hasFocus()}catch(c){b=!1}l(this,"window-blur",{parentHasFocus:b},Ma);this.Fc=0});window.addEventListener("focusin",
b=>{b=b.target;(Ta.has(b.tagName.toLowerCase())||Sa(b))&&l(this,"keyboard-blur",null,Ma)});window.addEventListener("keydown",b=>jb(this,"keydown",b));window.addEventListener("keyup",b=>jb(this,"keyup",b));window.addEventListener("dblclick",b=>kb(this,"dblclick",b,z));window.addEventListener("wheel",b=>{this.wa||l(this,"wheel",{clientX:b.clientX,clientY:b.clientY+this.Da,pageX:b.pageX,pageY:b.pageY+this.Da,deltaX:b.deltaX,deltaY:b.deltaY,deltaZ:b.deltaZ,deltaMode:b.deltaMode,timeStamp:b.timeStamp},
z)});"undefined"!==typeof PointerEvent?(window.addEventListener("pointerdown",b=>{lb(b);nb(this,"pointerdown",b)}),this.B.Ca&&"undefined"!==typeof window.onpointerrawupdate&&self===self.top?window.addEventListener("pointerrawupdate",b=>{nb(this,"pointermove",b)}):window.addEventListener("pointermove",b=>nb(this,"pointermove",b)),window.addEventListener("pointerup",b=>nb(this,"pointerup",b)),window.addEventListener("pointercancel",b=>nb(this,"pointercancel",b))):(window.addEventListener("mousedown",
b=>{lb(b);ob(this,"pointerdown",b)}),window.addEventListener("mousemove",b=>ob(this,"pointermove",b)),window.addEventListener("mouseup",b=>ob(this,"pointerup",b)),window.addEventListener("touchstart",b=>{lb(b);pb(this,"pointerdown",b)}),window.addEventListener("touchmove",b=>pb(this,"pointermove",b)),window.addEventListener("touchend",b=>pb(this,"pointerup",b)),window.addEventListener("touchcancel",b=>pb(this,"pointercancel",b)));const a=()=>this.ne();window.addEventListener("pointerup",a,!0);window.addEventListener("touchend",
a,!0);window.addEventListener("click",a,!0);window.addEventListener("keydown",a,!0);window.addEventListener("gamepadconnected",a,!0);this.B.Wg()&&!this.B.rf()&&navigator.virtualKeyboard&&(navigator.virtualKeyboard.overlaysContent=!0,navigator.virtualKeyboard.addEventListener("geometrychange",()=>{qb(this,this.Na(),navigator.virtualKeyboard.boundingRect.height)}))}Xa(){return this.B.Xa()}Na(){return this.B.Na()}ne(){var a=[...this.Rb];this.Rb.clear();if(!this.kb)for(const b of a)(a=b.play())&&a.catch(()=>
{this.ud.has(b)||this.Rb.add(b)})}rb(a){if("function"!==typeof a.play)throw Error("missing play function");this.ud.delete(a);let b;try{b=a.play()}catch(c){this.Rb.add(a);return}b&&b.catch(()=>{this.ud.has(a)||this.Rb.add(a)})}Jb(a){this.Rb.delete(a);this.ud.add(a)}Wc(a){this.kb=!!a}je(a){alert(a.message)}});"use strict";
async function Da(a){if(a.zh)throw Error("already initialised");a.zh=!0;var b=a.nb.ge(("playable-ad"===a.nb.G?a.nb.Zb:"")+"dispatchworker.js");a.we=await a.nb.Sd(b,a.nc,{name:"DispatchWorker"});b=new MessageChannel;a.Ge=b.port1;a.we.postMessage({type:"_init","in-port":b.port2},[b.port2]);a.Te=await Ga(a)}function Ea(a){return[a.Ge,a.Te]}
async function Ga(a){const b=a.Uf.length;var c=a.nb.ge(("playable-ad"===a.nb.G?a.nb.Zb:"")+"jobworker.js");c=await a.nb.Sd(c,a.nc,{name:"JobWorker"+b});const d=new MessageChannel,e=new MessageChannel;a.we.postMessage({type:"_addJobWorker",port:d.port1},[d.port1]);c.postMessage({type:"init",number:b,"dispatch-port":d.port2,"output-port":e.port2},[d.port2,e.port2]);a.Uf.push(c);return e.port1}
self.Zg=class{constructor(a){this.nb=a;this.nc=a.Ba;this.nc="preview"===a.G?this.nc+"workers/":this.nc+a.Zb;this.Ch=Math.min(navigator.hardwareConcurrency||2,16);this.we=null;this.Uf=[];this.Te=this.Ge=null}};"use strict";window.C3_IsSupported&&(window.c3_runtimeInterface=new self.ib({Vh:!0,Wh:"workermain.js",cc:["scripts/c3runtime.js"],Nd:[],ff:"",Sh:"scripts/",Od:[],ng:"html5"}));"use strict";const tb=[],ub=2*Math.PI;function vb(a){a%=ub;0>a&&(a+=ub);return a}
function wb(a,b){switch(a.mb){case 0:return b;case 1:return Math.fround(b);case 2:return 2===a.uc&&(b=vb(b),b/=Math.PI,b=32767*(b-1)),a=b|0,-32768>a?-32768:32767<a?32767:a;case 3:return 2===a.uc&&(b=vb(b),b/=ub,b*=255),a=b|0,0>a?0:255<a?255:a;default:return b}}function xb(a,b,c,d){switch(a.mb){case 0:b.setFloat64(c,d);c+=8;break;case 1:b.setFloat32(c,d);c+=4;break;case 2:b.setInt16(c,d);c+=2;break;case 3:b.setUint8(c,d);c+=1;break;default:b.setFloat32(c,d),c+=4}return c}
function yb(a,b){if(2!==a.uc)return b;2===a.mb?b=(b/32767+1)*Math.PI:3===a.mb&&(b=b/255*ub);return b}function zb(a,b,c,d,e){switch(a){case 0:return e?c:b;case 1:return b+d*(c-b);case 2:return b===c?a=0:(a=Math.sin(b)*Math.sin(c)+Math.cos(b)*Math.cos(c),a=1<=a?0:-1>=a?Math.PI:Math.acos(a)),0>=Math.cos(c)*Math.sin(b)-Math.sin(c)*Math.cos(b)?vb(b+a*d):vb(b-a*d);default:return e?c:b}}
class Ab{constructor(a,b,c,d,e,f){this.tc=a;this.uc=b;this.mb=c;this.cb=d;this.Hd=e;this.Hf=f}Ib(){return{tag:this.cb,interp:this.uc,userData:this.Hd,cvt:this.Hf}}gb(){return this.uc}}class Bb{constructor(a,b){this.timestamp=a;this.data=b}}
class Cb{constructor(a,b,c){this.sa=a;this.g=a.g;this.I=b;this.X=c;this.qc=[];this.qc.length=this.sa.za.length;this.Ne=this.od=0;this.He=this.Fd=!1;this.aa=[];this.O=this.D=this.Ia=null}Ib(){var a=[];for(let c=0,d=this.sa.za.length;c<d;++c)a.push(this.gb(this.sa.Dd,c));a={id:this.I,nid:this.X,isTimedOut:0===this.aa.length?!1:this.aa[this.aa.length-1].timestamp<this.sa.Dd-3E3,interpValues:a,latestUpdate:null};const b=0===this.aa.length?null:this.aa[this.aa.length-1];b&&(a.latestUpdate={timestamp:b.timestamp,
data:b.data});return a}ce(a,b){a=a.netValues;var c=this.sa.za;const d=c.length;this.Fd=!1;for(let e=0;e<d;++e){const f=wb(c[e],a[e]);this.qc[e]!==f&&(this.qc[e]=f,this.od=b,this.sa.od=b)}a=b-this.od;b-=this.Ne;c=this.sa.Ef;(this.Fd=100>a&&0===c?!0:1E3>a&&1>=c?95<=b:495<=b)&&this.sa.Ic++}de(a,b,c){const d=this.sa.za;this.Ne=c;a.setUint16(b,this.X);b+=2;for(let e=0,f=this.qc.length;e<f;++e)b=xb(d[e],a,b,this.qc[e]);return b}Pd(a,b){for(let c=0,d=this.aa.length;c<d;++c){const e=this.aa[c];if(e.timestamp===
a)return;if(e.timestamp>a){this.aa.splice(c,0,new Bb(a,b));return}}this.aa.push(new Bb(a,b))}na(){for(;2<this.aa.length&&this.aa[0]!==this.Ia&&this.aa[0]!==this.D&&this.aa[0]!==this.O;)this.aa.shift();const a=this.sa.Dd;if(!(this.O&&this.O.timestamp>a&&this.D&&this.D.timestamp<a)){this.O=null;for(let b=0,c=this.aa.length;b<c;++b){const d=this.aa[b];if(d.timestamp<=a){if(!this.D||d.timestamp>this.D.timestamp)this.Ia=this.D,this.D=d}else{this.O=d;break}}}}gb(a,b){if(!this.O&&!this.D)return 0;if(this.O&&
!this.D)return this.O.data[b];const c=this.sa.za;let d,e,f;if(!this.O&&this.D){if(this.Ia){var g=this.Ia.timestamp;d=this.Ia.data[b];e=this.D.timestamp;f=this.D.data[b];a>this.D.timestamp+this.sa.jd&&(a=this.D.timestamp+this.sa.jd);g=g===e?0:(a-g)/(e-g);return zb(c[b].gb(),d,f,g,!0)}return this.D.data[b]}g=this.D.timestamp;d=this.D.data[b];e=this.O.timestamp;f=this.O.data[b];return zb(c[b].gb(),d,f,g===e?0:(a-g)/(e-g),!1)}}
function Db(a,b,c,d,e,f){b=new Ab(a.za.length,b,c,d,e,f);switch(c){case 0:a.Ta+=8;break;case 1:a.Ta+=4;break;case 2:a.Ta+=2;break;case 3:a.Ta+=1}a.za.push(b)}function Eb(a,b){const c=b.I,d=b.X;a.g.s()&&!a.Ob&&a.dd.push(d);a.Bb.delete(c);a.Hc.delete(d);a.ac.delete(d);b=a.Ha.indexOf(b);-1<b&&a.Ha.splice(b,1)}function Fb(a,b){(b=a.Hc.get(b))&&Eb(a,b)}function Hb(a){return{roId:a.Oc,sid:a.Pc,netValues:a.za.map(b=>b.Ib())}}
class Ib{constructor(a,b,c,d){this.g=a;this.Oc=b;this.Pc=c;this.X=this.g.Fh++;this.Ef=d;this.Hd={};this.Ta=0;this.jd=250;switch(this.Ef){case 1:this.jd=500;break;case 2:this.jd=2500}this.za=[];this.Ha=[];this.Bb=new Map;this.ac=new Set;this.Ic=this.Ne=this.od=this.Gc=0;this.Ob=!1;this.dd=[];this.Hc=new Map;this.Dd=0;a=this.g;a.Ea.push(this);a.Mc.set(this.Oc,this);a.Yb.set(this.X,this)}tb(a){this.X=a}Pd(a,b,c){{let d=this.Hc.get(b);d||(d=new Cb(this,-1,b),this.Hc.set(b,d),this.Ha.push(d));b=d}b.Pd(a,
c)}na(){this.Dd=Jb(this.g);for(const a of this.Ha)a.na()}ce(a,b){this.Ic=0;for(var c of this.Ha)c.He=!1;for(let f=0,g=a.length;f<g;++f){c=a[f];var d=c.uid;var e=this.Bb.get(d);if(!e){e=d;do this.Gc++,65535<this.Gc&&(this.Gc=0);while(this.ac.has(this.Gc));const h=this.Gc;this.ac.add(h);e=new Cb(this,e,h);this.Bb.set(d,e);this.Ha.push(e)}d=e;d.He=!0;d.ce(c,b)}for(const f of this.Ha)f.He||tb.push(f);for(const f of tb)Eb(this,f);tb.length=0}de(a,b,c){a.setUint16(b,this.X);b+=2;let d=0;this.Ob&&(d=1);
a.setUint8(b,d);b+=1;a.setUint16(b,this.Ic);b+=2;a.setUint16(b,this.Ta);b+=2;for(const e of this.Ha)e.Fd&&(b=e.de(a,b,c));return b}Zd(a){(a=this.Bb.get(a))&&Eb(this,a)}Ib(){return{hasOverriddenNids:this.Ob,netValues:this.za.map(a=>a.Ib()),netInstances:this.Ha.map(a=>a.Ib())}}}self.Og=Ab;self.Ng=Bb;self.Qg=Ib;"use strict";const Kb=self.Ng,Lb=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection||window.msRTCPeerConnection;
function Mb(a){if(a)try{a.close()}catch(b){}}const H=[];function Nb(a){return new Promise(b=>setTimeout(b,a))}async function Ob(a){if(a.Ue.length&&!(a.pe>=a.Dh)){a.pe++;var b=a.Ue.shift();try{const c=await b.Nh();b.resolve(c)}catch(c){b.reject(c)}a.pe--;Ob(a)}}function Pb(a,b){return new Promise((c,d)=>{a.Ue.push({Nh:b,resolve:c,reject:d});Ob(a)})}class Qb{constructor(){this.Dh=1;this.Ue=[];this.pe=0}}
async function Rb(a,b,c){const d=Sb(a,b,c.data);c=d;"o"===b&&(c=Pb(a.Ih,()=>d));(c=await c)&&Ub(a,b,c)}function J(a,b,c){if(!a.bc){a.bc=!0;Vb(a,b);K(a,"o",JSON.stringify({c:"disconnect",r:b,k:!!c}));var d=a.wb,e=a.xb,f=a.yb,g=a.L;setTimeout(()=>{Mb(d);Mb(e);Mb(f);Mb(g)},0);a.wb=null;a.xb=null;a.yb=null;a.L=null;a.vc=!1;a.xc=!1;a.yc=!1;Wb(a.g,a)}}
function Xb(a,b,c){b.binaryType="arraybuffer";b.onopen=()=>{"o"===c?a.vc=!0:"r"===c?a.xc=!0:"u"===c&&(a.yc=!0);if(!a.jb&&a.xc&&a.yc&&a.vc){a.Le=performance.now();if(a.g.s()){L(a.g,"o",JSON.stringify({c:"j",i:a.I,n:a.X,a:a.fa}),0,a);var d=K,e=JSON,f=e.stringify,g=a.g.S.X,h=a.X,k=a.g.Fa,v=a.g.Kc,p=a.g;var D={};for(const [r,t]of p.Yb.entries()){p=t.Pc;const F=[];for(var y of t.za){const I={tag:y.cb,precision:y.mb,interp:y.gb(),clientvaluetag:y.Hf};"undefined"!==typeof y.Hd&&(I.userdata=y.Hd);F.push(I)}D[p]=
{nid:r,nvs:F}}y=a.g;p=[];for(const r of y.Oa)p.push({tag:r.cb,precision:r.mb,interp:r.gb()});d(a,"o",f.call(e,{c:"hi",hn:g,n:h,d:k,u:v,objs:D,cvs:p,comp:Yb}));for(const r of a.g.Pa)!r.s()&&r!==a&&r.jb&&!r.Ab&&K(a,"o",JSON.stringify({c:"j",i:r.I,n:r.X,a:r.fa}))}else a.Be=!0,a.s()&&Zb(a,performance.now(),!0),K(a,"o",JSON.stringify({c:"comp",comp:Yb}));$b(a.g,a);a.jb=!0;a.Ab=!1}};b.onmessage=d=>{Rb(a,c,d)};b.onerror=d=>{console.error("Peer '"+a.I+"' datachannel '"+c+"' error: ",d);M(a,d);a.g.s()&&!a.s()&&
J(a,"network error")};b.onclose=()=>{J(a,"disconnect")}}
function ac(a){if(a!==a.g.N){var b=a.g.s();a.vc=!1;a.xc=!1;a.yc=!1;a.jb=!1;a.Ab=!1;a.If=performance.now();a.L=new Lb({iceServers:a.g.Fe});a.L.onicecandidate=d=>{d.candidate&&N(a.g,{message:"icecandidate",toclientid:a.I,icecandidate:d.candidate})};a.L.onsignalingstatechange=()=>{a.L&&"closed"===a.L.signalingState&&J(a,"disconnect")};a.L.oniceconnectionstatechange=()=>{a.L&&("failed"!==a.L.iceConnectionState&&"closed"!==a.L.iceConnectionState||J(a,"disconnect"))};a.L.onconnectionstatechange=()=>{if(a.L){var d=
a.L.connectionState;"failed"!==d&&"closed"!==d||J(a,"disconnect")}};var c=`c3mp_${a.g.ye}_${a.g.ze}_${a.g.T}`;b?(a.X=bc(a.g),a.wb=a.L.createDataChannel("o",{ordered:!0,protocol:c}),Xb(a,a.wb,"o"),a.xb=a.L.createDataChannel("r",{ordered:!1,protocol:c}),Xb(a,a.xb,"r"),a.yb=a.L.createDataChannel("u",{ordered:!1,maxRetransmits:0,protocol:c}),Xb(a,a.yb,"u"),a.L.createOffer().then(d=>{a.L.setLocalDescription(d);N(a.g,{message:"offer",toclientid:a.I,offer:d})}).catch(d=>{console.error("Host error creating offer for peer '"+
a.I+"': ",d);M(a,"could not create offer for peer")})):a.L.ondatachannel=d=>{if(d.channel.protocol!==c)console.error("Unexpected datachannel protocol '"+d.channel.protocol+"', should be '"+c+"'"),M(a,"unexpected datachannel protocol '"+d.channel.protocol+"', should be '"+c+"'"),a.bc||(J(a,"datachannel protocol error"),l(a.g,"peer-kicked"));else{var e=d.channel.label;"o"===e?a.wb=d.channel:"r"===e?a.xb=d.channel:"u"===e?a.yb=d.channel:(console.error("Unknown datachannel label: "+d.channel.label),M(a,
"unknown datachannel label '"+d.channel.label+"'"));Xb(a,d.channel,e)}}}}async function cc(a,b){if(a.L)try{await a.L.addIceCandidate(b)}catch(c){console.warn("[Multiplayer] Error adding ICE candidate: ",c)}}async function K(a,b,c,d=0){dc(a.g,c);const e=ec(a,b,c,d);c=e;"o"===b&&(c=Pb(a.Jh,()=>e));(c=await c)&&gc(a,b,c)}
function Zb(a,b,c){a.bc||(!c&&(!a.jb||a.Ab)&&a.L&&25E3<b-a.If?(console.warn("Timed out '"+a.fa+"', could not establish connection after 25sec"),J(a,"timeout")):!c&&a.jb&&!a.Ab&&2E4<b-a.Le?(console.warn("Timed out '"+a.fa+"', not heard from for 20sec"),J(a,"timeout")):(a.Vf=b,a.te=!0,a.Me++,K(a,"u","ping:"+a.Me)))}function Vb(a,b){!a.Ab&&a.jb&&(a.ke(b),a.Ab=!0,a.jb=!1)}function hc(a,b){const c=Yb;for(const d of b)c.includes(d)&&a.se.push(d)}
async function ic(a,b){if(0===a.se.length)return{Jd:0,data:b};const c=new Blob([b]);if(64>c.size)return{Jd:0,data:b};a=a.se[0];var d=new CompressionStream(a);d=c.stream().pipeThrough(d);d=await (new Response(d)).arrayBuffer();if(d.byteLength>=c.size)return{Jd:0,data:b};b=P.Qd.indexOf(a);if(0>b)throw Error("invalid compression type");return{Jd:b,data:d}}
async function ec(a,b,c,d=0){var e="string"===typeof c;const {Jd:f,data:g}=await ic(a,c);c=g;g instanceof ArrayBuffer&&(0!==f&&(d|=f<<4,e&&(d|=P.qf)),c=new ArrayBuffer(g.byteLength+8),e=new DataView(c),e.setUint32(0,P.tf),e.setUint32(4,d),(new Uint8Array(c,8)).set(new Uint8Array(g)));a.g.ta.gf++;d=a.g;d.ta.Ld+=jc(c);d=a.g.Xe;e=a.g.We;a=a.g.Ye;if(0<d&&"u"===b&&Math.random()<d)return null;if(0!==e||0!==a){let h=1;"u"!==b&&Math.random()<d&&(h=3);await Nb((e+Math.random()*a)*h)}return c}
function gc(a,b,c){try{"o"===b?a.vc&&a.wb&&a.wb.send(c):"r"===b?a.xc&&a.xb&&a.xb.send(c):"u"===b&&a.yc&&a.yb&&a.yb.send(c)}catch(d){a.bc||(a.g.s()?"o"===b||"r"===b?("string"===typeof c?(console.error("Error sending "+c.length+"-char string on '"+b+"' to '"+a.fa+"', host kicking: ",d),console.log("String that failed to send from previous error was: "+c)):console.error("Error sending "+(c.length||c.byteLength)+"-byte binary on '"+b+"' to '"+a.fa+"', host kicking: ",d),J(a,"network error")):(a.hd++,
10<=a.hd&&("string"===typeof c?(console.error("Too many errors ("+a.hd+") sending data on '"+b+"' to '"+a.fa+"', kicking; last error was for sending "+c.length+"-char string: ",d),console.log("String that failed to send from previous error was: "+c)):console.error("Too many errors ("+a.hd+") sending data on '"+b+"' to '"+a.fa+"', kicking; last error was for sending "+(c.length||c.byteLength)+"-byte binary: ",d),J(a,"network error"))):console.error("Error sending data on '"+b+"': ",d))}}
function kc(a,b){if(a.te){var c=b.indexOf(":");if(-1<c){if(parseFloat(b.substr(c+1))===a.Me){c=performance.now();a.te=!1;var d=(c-a.Vf)/2;a.pd.push(d);10<a.pd.length&&a.pd.shift();H.push(...a.pd);H.sort((h,k)=>h-k);a.eg=H[H.length-1]-H[0];var e=0,f=H.length;4<=H.length&&6>=H.length?(++e,--f):6<H.length&&(e+=2,f-=2);var g=0;for(let h=e;h<f;++h)g+=H[h];a.qd=g/(f-e);H.length=0;a.g.s()||(e=b.indexOf("/"),-1<e?(b=parseFloat(b.substr(e+1)),isFinite(b)?lc(a.g,b,c,d,a.qd):console.warn("Invalid host time from pong response")):
console.warn("Cannot parse off host time from pong response"))}}else console.warn("Cannot parse off ping ID from pong")}}async function Sb(a,b,c){a.g.ta.df++;var d=a.g;d.ta.Kd+=jc(c);d=a.g.Xe;const e=a.g.We;a=a.g.Ye;if(0<d&&"u"===b&&Math.random()<d)return null;if(0!==e||0!==a){let f=1;"u"!==b&&Math.random()<d&&(f=3);await Nb(e*f+Math.random()*a*f)}return c instanceof ArrayBuffer?await mc(c):c}
function Ub(a,b,c){if(!a.bc)if(a.Le=performance.now(),"string"===typeof c){var d=a.g;d.ta.dc+=jc(c);if(!(""===c.trim()||4>c.length))if(d=c.substr(0,4),"ping"===d)d="pong:"+c.substr(5),a.g.s()&&(d=d+"/"+Math.round(performance.now()).toString()),K(a,"u",d);else if("pong"===d)kc(a,c);else{try{var e=JSON.parse(c)}catch(m){M(a,m);a.g.s()?(console.error("Error parsing message as JSON for peer '"+a.I+"', host kicking: ",m),J(a,"data error")):console.error("Error parsing message as JSON for peer '"+a.I+"': ",
m);console.log("String that failed to parse from previous error: "+c);return}if(e)try{if(e.c&&"m"!==e.c){d=e;let m,G;switch(d.c){case "disconnect":d.k&&l(a.g,"peer-kicked");G=!a.g.s()&&!a.s();J(a,d.r);G&&nc(a.g);break;case "hi":if(!a.g.s()){a.g.S.tb(d.hn);a.g.N.tb(d.n);a.g.Fa=d.d;a.g.Kc=d.u;var f=a.g,g=d.objs;f.Yb.clear();for(const x of f.Ea)if(g.hasOwnProperty(x.Pc.toString())){const R=g[x.Pc.toString()];x.tb(R.nid);f.Yb.set(R.nid,x);var h=R.nvs;x.za.length=0;x.Ta=0;for(const E of h)Db(x,E.interp,
E.precision,E.tag,E.userdata,E.clientvaluetag)}else console.warn("Could not map object SID '"+x.Pc+"' - host did not send NID for it"),x.tb(-1);var k=a.g,v=d.cvs;k.bd.clear();k.Oa.length=0;for(let x=0,R=v.length;x<R;++x){const E=v[x],V=new oc(x,E.interp,E.precision,E.tag,null);k.bd.set(V.cb,V);k.Oa.push(V)}k.Ve=!0;d.hasOwnProperty("comp")&&hc(a,d.comp)}break;case "comp":hc(a,d.comp);break;case "j":a.g.s()||(m=new P(a.g,d.i,d.a),m.tb(d.n),$b(a.g,m));break;case "l":!a.g.s()&&(m=a.g.Aa.get(d.i)||null)&&
(m===m.g.N||pc(a.g,m,d.r),J(m,d.r));break;default:console.error("Unknown control message from peer '"+a.I+"': "+d.c),M(a,"unknown control message '"+d.c+"'")}}else{var p=a.g;d=e;const m=d.f||a.I;l(p,"peer-message",{tag:d.t,fromId:m,fromAlias:qc(p,m),transmissionMode:b,content:d.m,contentMode:d.cm||"e"})}}catch(m){M(a,m),a.g.s()?(console.error("Error handling message for peer '"+a.I+"', host kicking: ",m),J(a,"data error")):console.error("Error handling message for peer '"+a.I+"': ",m)}}}else{f=a.g;
f.ta.dc+=jc(c.data);!a.Be&&a.g.s()&&"u"===b&&(a.Be=!0,f=a.g,f.xa&&f.s()&&N(f,{message:"confirm-peer",id:a.I}));try{var D=c.data,y=c.offset,r=c.flags;if(0===(r&P.Td))if(d=new DataView(D,y),a.g.s()){var t=0,F=d.getFloat64(t);t+=8;F+=a.qd;if(!(3E3<=Math.abs(F-performance.now()))){var I=d.getUint8(t);t+=1;var w=[],W=a.g.Oa;for(var O=0;O<I;++O)if(O>=W.length)w.push(0);else{var ba=W[O],C=void 0;switch(ba.mb){case 0:C=d.getFloat64(t);t+=8;break;case 1:C=d.getFloat32(t);t+=4;break;case 2:C=yb(ba,d.getInt16(t));
t+=2;break;case 3:C=yb(ba,d.getUint8(t));t+=1;break;default:C=d.getFloat32(t),t+=4}w.push(C)}a:{d=F;for(let m=0,G=a.va.length;m<G;++m){var A=a.va[m];if(A.timestamp===d)break a;if(A.timestamp>d){a.va.splice(m,0,new Kb(d,w));break a}}a.va.push(new Kb(d,w))}}}else if(0===(r&P.pf))for(A=0,w=d.getFloat64(A),A+=8,t=d.getUint16(A),A+=2,b=0;b<t;++b){O=d.getUint16(A);A+=2;const m=d.getUint8(A);A+=1;I=null;W=0;const G=a.g.Yb.get(O)||null;G?(I=G.za,W=I.length,1===m&&(G.Ob=!0)):console.warn("Don't know which object corresponds to NID "+
O);const x=d.getUint16(A);A+=2;const R=d.getUint16(A);A+=2;for(F=0;F<x;++F){const E=d.getUint16(A);A+=2;if(G){ba=[];C=A;for(var oa=0;oa<W;++oa){const V=I[oa];let ca;switch(V.mb){case 0:ca=d.getFloat64(C);C+=8;break;case 1:ca=d.getFloat32(C);C+=4;break;case 2:ca=yb(V,d.getInt16(C));C+=2;break;case 3:ca=yb(V,d.getUint8(C));C+=1;break;default:ca=d.getFloat32(C),C+=4}ba.push(ca)}G.Pd(w,E,ba)}A+=R}}else{w=0;oa=d.getFloat64(w);w+=8;const m=d.getUint16(w);w+=2;for(t=0;t<m;++t){const G=d.getUint16(w);w+=
2;const x=a.g.Yb.get(G)||null;x||console.warn("Don't know which object corresponds to NID "+G);const R=d.getUint16(w);w+=2;for(O=0;O<R;++O){const E=d.getUint16(w);w+=2;x&&!x.Ob&&(l(a.g,"instance-destroyed",{roId:x.Oc,nid:E,timestamp:oa}),Fb(x,E))}}}else{var Tb=a.g,Yc=0===y?D:D.slice(y);const m=a.I;l(Tb,"peer-message",{fromId:m,fromAlias:qc(Tb,m),transmissionMode:b,content:Yc,contentMode:"s"})}}catch(m){M(a,m),a.g.s()?(console.error("Error handling binary update for peer '"+a.I+"', host kicking: ",
m),J(a,"data error")):console.error("Error handling binary update for peer '"+a.I+"': ",m)}}}
async function mc(a){if(8>a.byteLength)return console.warn(`Rejected binary message as too small (only ${a.byteLength} bytes)`),null;var b=new DataView(a),c=b.getUint32(0);b=b.getUint32(4);if(c!==P.tf)return console.warn(`Rejected binary message with invalid magic number (0x${c.toString(16)})`),null;c=(b&P.Ug)>>4;if(0===c)return{data:a,offset:8,flags:b};if(c>=P.Qd.length)throw Error("invalid compression type");c=P.Qd[c];a=new Blob([new Uint8Array(a,8)]);c=new DecompressionStream(c);a=a.stream().pipeThrough(c);
a=await (new Response(a)).arrayBuffer();return 0===(b&P.qf)?{data:a,offset:0,flags:b}:(new TextDecoder).decode(a)}
function rc(a,b){b=b.tc;if(!a.O&&!a.D)return 0;if(a.O&&!a.D)return a=a.O.data,0>b||b>=a.length?0:a[b];var c=Jb(a.g);let d,e,f;if(!a.O&&a.D){if(a.Ia){var g=a.Ia.timestamp;d=a.Ia.data[b];e=a.D.timestamp;f=a.D.data[b];c>a.D.timestamp+250&&(c=a.D.timestamp+250);g=g===e?0:(c-g)/(e-g);return zb(a.g.Oa[b].gb(),d,f,g,!0)}a=a.D.data;return 0>b||b>=a.length?0:a[b]}g=a.D.timestamp;d=a.D.data[b];e=a.O.timestamp;f=a.O.data[b];return zb(a.g.Oa[b].gb(),d,f,g===e?0:(c-g)/(e-g),!1)}
class P{constructor(a,b,c){this.g=a;this.I=b;this.X=0;this.fa=c;this.wb=this.L=null;this.vc=!1;this.xb=null;this.xc=!1;this.yb=null;this.yc=!1;this.Jh=new Qb;this.Ih=new Qb;this.Be=this.bc=this.Ab=this.jb=!1;this.hd=this.If=this.Le=0;this.se=[];this.bg=[];this.Yf=this.Xf=0;this.va=[];this.O=this.D=this.Ia=null;this.Vf=0;this.te=!1;this.Me=1;this.pd=[];this.eg=this.qd=0;a=this.g;a.Pa.push(this);a.Aa.set(this.I,this);l(a,"add-peer",{id:this.I,alias:this.fa})}tb(a){this.X=a}s(){return this===this.g.S}ke(a){this.g.s()&&
this!==this.g.N&&L(this.g,"o",JSON.stringify({c:"l",i:this.I,a:this.fa,r:a}),0,this);this===this.g.N||pc(this.g,this,a)}na(a){if(0!==this.va.length){for(;2<this.va.length&&this.va[0]!==this.Ia&&this.va[0]!==this.D&&this.va[0]!==this.O;)this.va.shift();if(!(this.O&&this.O.timestamp>a&&this.D&&this.D.timestamp<a)){this.O=null;for(let b=0,c=this.va.length;b<c;++b){const d=this.va[b];if(d.timestamp<=a){if(!this.D||d.timestamp>this.D.timestamp)this.Ia=this.D,this.D=d}else{this.O=d;break}}}}}}P.tf=1664314736;
P.pf=1;P.qf=2;P.Td=4;P.Ug=240;P.Qd=["none","deflate","gzip"];self.Pg=P;"use strict";
const oc=self.Og,sc=self.Pg,tc=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection||window.msRTCPeerConnection,uc=window.RTCSessionDescription||window.webkitRTCSessionDescription||window.mozRTCSessionDescription||window.msRTCSessionDescription,vc=window.RTCIceCandidate||window.webkitRTCIceCandidate||window.mozRTCIceCandidate||window.msRTCIceCandidate,wc=window.RTCDataChannel||window.webkitRTCDataChannel||window.mozRTCDataChannel||window.msRTCDataChannel,xc=[{urls:"stun:stun.l.google.com:19302"}];
function yc(a){if("undefined"===typeof CompressionStream||"function"!==typeof Blob.prototype.stream)return!1;try{return new CompressionStream(a),!0}catch(b){return!1}}function jc(a){if("number"===typeof a.byteLength)return a.byteLength;if("number"===typeof a.length)return a.length;console.warn("[Construct] Multiplayer: don't know how to measure size of data: ",a);return 0}const Yb=[];yc("deflate")&&Yb.push("deflate");yc("gzip")&&Yb.push("gzip");let zc=!1;const Q=[];
function Jb(a){return a.s()?performance.now()-a.Fa:performance.now()+a.ca-a.pa}function M(a,b){console.error(`[Multiplayer] Peer '${a.fa}' (${a.I}) error: `,b)}function N(a,b){a.Y&&a.Za&&a.Y.send(JSON.stringify(b))}function bc(a){if(a.s()){do a.Sb++,65535<a.Sb&&(a.Sb=0);while(a.Gd.has(a.Sb));var b=a.Sb;a.Gd.add(b);return b}}function L(a,b,c,d=0,e=null){if(a.s()){var f=a.Pa.slice(0);for(const g of f)g&&g!==a.N&&g!==e&&K(g,b,c,d)}}function $b(a,b){l(a,"peer-open",{id:b.I,alias:b.fa})}
function pc(a,b,c){l(a,"peer-close",{id:b.I,alias:b.fa,reason:c||"unknown"})}function dc(a,b){a.ta.Md+=jc(b)}function lc(a,b,c,d,e){if(!a.s()){a.eb=e+a.Fa;b=b+d-c;0===a.Cb.length&&(a.ca=b,a.pa=a.eb);a.Cb.push(b);30<a.Cb.length&&a.Cb.shift();Q.push(...a.Cb);Q.sort((f,g)=>f-g);b=0;c=Q.length;4<=Q.length&&6>=Q.length?(++b,--c):6<Q.length&&19>=Q.length?(b+=2,c-=2):19<Q.length&&(b+=5,c-=5);d=0;for(e=b;e<c;++e)d+=Q[e];a.Ka=d/(c-b);Q.length=0}}
function nc(a){if(a.xa){var b=S(a.oa.rg);N(a,{message:"leave"});return b}}function Wb(a,b){l(a,"remove-peer",{id:b.I});a.s()&&a.s()&&a.Gd.delete(b.X);const c=a.Pa.indexOf(b);-1<c&&a.Pa.splice(c,1);a.Aa.delete(b.I);a.S===b&&(a.S=null,Ac(a,"host quit"));a.N===b&&(a.N=null,a.T="",Ac(a,"disconnect"))}function Bc(a,b){if(b)for(let c of b){"string"===typeof c&&(c={urls:c});a:{for(const d of a.Fe)if(d.urls===c.urls){b=!0;break a}b=!1}b||(c.hasOwnProperty("url")||(c.url=c.urls),a.Fe.push(c))}}
function Ac(a,b){if(!zc){for(zc=!0;a.Pa.length;)J(a.Pa[0],b);zc=!1}}
function Cc(a,b){if(a.Y||a.Za)return Promise.resolve();const c=S(a.oa.connect);try{a.Y=new WebSocket(b,"c2multiplayer")}catch(d){return a.Y=null,T(a,d),c}a.Y.onopen=()=>{-1===a.Y.protocol.indexOf("c2multiplayer")?(T(a,"server does not support 'c2multiplayer' protocol"),a.Y.close(1002,"'c2multiplayer' protocol required"),a.Y=null,a.Za=!1):a.Za=!0};a.Y.onclose=()=>{l(a,"signalling-close");a.Za=!1;a.xa=!1;a.Y=null};a.Y.onerror=d=>{console.error("Signalling server error: ",d);T(a,d)};a.Y.onmessage=d=>
{a:{try{var e=JSON.parse(d.data)}catch(f){T(a,f);break a}switch(e.message){case "welcome":d=e;1>d.protocolrev||1<d.protocolrev?(T(a,"signalling server protocol revision not supported"),Dc(a)):(a.Se=d.clientid,a.T="",e=a.Kh,e.yg=d.protocolrev,e.version=d.version,e.name=d.name,e.operator=d.operator,e.ug=d.motd,Bc(a,d.ice_servers),l(a,"signalling-welcome",{myid:a.Se,sigservinfo:{protocolrev:e.yg,version:e.version,name:e.name,operator:e.operator,motd:e.ug}}),Ec(a.oa.connect));break;case "login-ok":a.Re=
e.alias;a.xa=!0;l(a,"signalling-login-ok",{myalias:a.Re});Ec(a.oa.login);break;case "join-ok":d=e;Ac(a,"disconnect");a.ye=d.game;a.ze=d.instance;a.T=d.room;a.N=new sc(a,a.Se,a.Re);d.host?(a.S=a.N,a.Sb=0,a.Gd.clear(),a.S.tb(bc(a))):(a.Cb.length=0,a.Ka=0,a.ca=0,a.Fa=80,a.Ee=30,a.Kc=30,a.eb=a.Fa,a.pa=a.Fa,a.S=new sc(a,d.hostid,d.hostalias),ac(a.S));l(a,"signalling-join-ok",{isHost:!!d.host,hostId:a.S.I,hostAlias:a.S.fa,game:a.ye,gameInstance:a.ze,room:a.T});Ec(a.oa.ef);break;case "leave-ok":a.T="";l(a,
"signalling-leave-ok");Ec(a.oa.rg);break;case "kicked":"host-left"===e.reason?Dc(a):(Fc(a),a.T="",l(a,"signalling-kicked"));break;case "peer-joined":d=e;a.xa&&a.T&&a.s()&&((e=a.Aa.get(d.peerid))&&J(e,"rejoin"),ac(new sc(a,d.peerid,d.peeralias)));break;case "peer-quit":d=e;a.xa&&a.T&&a.s()&&(e=a.Aa.get(d.id))&&J(e,d.reason);break;case "icecandidate":d=e;a.xa&&a.T&&(e=a.Aa.get(d.from))&&cc(e,new vc(d.icecandidate));break;case "offer":Gc(a,e);break;case "answer":Hc(a,e);break;case "instance-list":l(a,
"signalling-instance-list",{list:e.list});Ec(a.oa.sg);break;case "room-list":l(a,"signalling-room-list",{list:e.list});Ec(a.oa.tg);break;case "error":T(a,e.details);break;default:T(a,"received unknown signalling message")}}};return c}function Dc(a){a.Y&&a.Za&&(a.Y.close(),a.Y=null,a.Za=!1)}function Fc(a,b){a.Cb.length=0;a.Ka=0;a.ca=0;Ac(a,"disconnect");for(const c of a.Ea)c.dd.length=0,c.Bb.clear(),c.Hc.clear(),c.ac.clear(),c.Ha.length=0;b&&nc(a)}
function Ic(a,b,c){if(!a.s()&&a.N&&a.Ve&&(b=a.bd.get(b))){b=b.tc;var d=a.N.bg;d.length<b+1&&(d.length=b+1);d[b]!==c&&(d[b]=c,a.N.Xf=performance.now())}}function S(a){a.reject&&a.reject("overlapping signalling operation");return new Promise((b,c)=>{a.resolve=b;a.reject=c})}function Ec(a){a.resolve&&a.resolve(void 0);a.resolve=null;a.reject=null}
function T(a,b){l(a,"signalling-error",{message:b?"string"===typeof b?b:"string"===typeof b.message?b.message:"string"===typeof b.details?b.details:"string"===typeof b.data?b.data:"string"===typeof b.type?b.type:"unknown error":"unknown error"});for(const c of Object.values(a.oa))c.reject&&c.reject(b),c.resolve=null,c.reject=null}
function Gc(a,b){if(a.xa&&a.T&&!a.s()&&a.N&&a.S&&a.S.L&&b.from===a.S.I){var c=a.S.L;c.setRemoteDescription(new uc(b.offer)).then(()=>{c.createAnswer().then(d=>{c.setLocalDescription(d);N(a,{message:"answer",toclientid:a.S.I,answer:d})}).catch(d=>{console.error("Peer error creating answer: ",d);M(a.N,"could not create answer to host offer")})}).catch(d=>{console.error("Peer error setting remote description: ",d);M(a.N,"could not set remote description")})}}
function Hc(a,b){a.xa&&a.T&&a.s()&&(a=a.Aa.get(b.from))&&a.L.setRemoteDescription(new uc(b.answer)).catch(c=>{console.error("Host error setting remote description: ",c)})}function qc(a,b){return(a=a.Aa.get(b))?a.fa:""}
async function Jc(a,b){if(a.s()){await Kc(a,b);const c=a.ve;let d=0,e=0;for(const f of a.Ea)f.dd.length&&e++;if(0!==e){c.setFloat64(d,b);d+=8;c.setUint16(d,e);d+=2;for(const f of a.Ea)if(b=f.dd,b.length){c.setUint16(d,f.X);d+=2;c.setUint16(d,b.length);d+=2;for(const g of b)c.setUint16(d,g),d+=2;b.length=0}L(a,"r",a.cd.slice(0,d),sc.pf)}}else await Lc(a,b)}
async function Kc(a,b){const c=a.ve;let d=0,e=0;const f=await aa(a,"get-object-info",{ros:a.Ea.map(g=>Hb(g))});for(const g of a.Ea){const h=g.Oc;f.hasOwnProperty(h)&&(g.ce(f[h],b),0<g.Ic&&e++)}if(0!==e){c.setFloat64(d,b);d+=8;c.setUint16(d,e);d+=2;for(const g of a.Ea)0<g.Ic&&(d=g.de(c,d,b));L(a,"u",a.cd.slice(0,d),0)}}
async function Lc(a,b){a.T&&(a.s()||0!==a.Ka)&&await Mc(a);if(a.N&&a.Ve){var c=a.ve,d=0,e=a.Oa,f=a.N.bg,g=b-a.N.Xf,h=b-a.N.Yf;if(100>g||(1E3>g?95<=h:495<=h)){c.setFloat64(d,b+a.ca);d+=8;c.setUint8(d,e.length);d+=1;for(let k=0,v=e.length;k<v;++k)g=e[k],h=0,k<f.length&&(h=wb(g,f[k])),d=xb(g,c,d,h);a.N.Yf=b;K(a.S,"u",a.cd.slice(0,d))}}}async function Mc(a){const b=await aa(a,"before-client-update");for(const c of b.clientStateUpdates)Ic(a,c.tag,c.value)}
self.ib.ec(class extends self.Gb{constructor(a){super(a,"multiplayer");this.Fe=[];this.Y=null;this.xa=this.Za=!1;this.Kh={yg:0,version:0,name:"",operator:"",ug:""};this.T=this.ze=this.ye=this.Re=this.Se="";this.Pa=[];this.Aa=new Map;this.Sb=0;this.Gd=new Set;this.S=this.N=null;this.Fa=80;this.Kc=this.Ee=30;this.$f=0;this.ta={Sc:0,xg:0,gf:0,vg:0,wg:0,Ld:0,Md:0,qg:0,df:0,og:0,pg:0,Kd:0,dc:0};this.cd=new ArrayBuffer(262144);this.ve=new DataView(this.cd);this.Ea=[];this.Fh=1;this.Yb=new Map;this.Mc=new Map;
this.Xe=this.Ye=this.We=0;this.Cb=[];this.ca=this.Ka=0;this.pa=this.eb=this.Fa;this.Oa=[];this.bd=new Map;this.Ve=!1;this.oa={connect:{resolve:null,reject:null},login:{resolve:null,reject:null},ef:{resolve:null,reject:null},rg:{resolve:null,reject:null},sg:{resolve:null,reject:null},tg:{resolve:null,reject:null}};Bc(this,xc);setInterval(()=>{const b=performance.now();if(this.s()){Q.push(...this.Pa);for(const c of Q)c&&c!==this.N&&Zb(c,b,!1);Q.length=0}else this.S&&Zb(this.S,b,!1)},2E3);window.addEventListener("unload",
()=>Ac(this,"quit"));n(this,"get-supported",()=>({isSupported:!(!tc||!wc)}));n(this,"add-ice-servers",b=>Bc(this,b.list));n(this,"simulate-latency",b=>{var c=b.pdv,d=b.loss;this.We=Math.max(b.latency,0);this.Ye=Math.max(c,0);this.Xe=Math.max(d,0)});n(this,"set-bandwidth-profile",b=>{var c=b.updateRate;b=b.delay;this.T||(this.Kc=this.Ee=c,this.Fa=b)});n(this,"tick",b=>this.na(b));n(this,"alert",b=>{alert(b.message)});n(this,"signalling-connect",b=>Cc(this,b.url));n(this,"signalling-disconnect",()=>
Dc(this));n(this,"signalling-login",b=>{b=b.alias;if(this.xa)b=void 0;else{var c=S(this.oa.login);N(this,{message:"login",protocolrev:1,datachannelrev:2,compressionformats:Yb,alias:b});b=c}return b});n(this,"signalling-join-room",b=>{var c=b.game;var d=b.instance,e=b.room;b=b.maxClients;if(this.xa&&!this.T){var f=S(this.oa.ef);N(this,{message:"join",game:c,instance:d,room:e,max_clients:b});c=f}else c=void 0;return c});n(this,"signalling-auto-join-room",b=>{var c=b.game;var d=b.instance,e=b.room,f=
b.maxClients;b=b.lock;if(this.xa&&!this.T){var g=S(this.oa.ef);N(this,{message:"auto-join",game:c,instance:d,room:e,max_clients:f,lock_when_full:b});c=g}else c=void 0;return c});n(this,"signalling-leave-room",()=>nc(this));n(this,"signalling-list-game-instances",b=>{b=b.game;if(this.Y&&this.Za){var c=S(this.oa.sg);N(this,{message:"list-instances",game:b});b=c}else b=void 0;return b});n(this,"signalling-list-rooms",b=>{var c=b.game;var d=b.instance;b=b.which;if(this.Y&&this.Za){var e=S(this.oa.tg);
N(this,{message:"list-rooms",game:c,instance:d,which:b});c=e}else c=void 0;return c});n(this,"disconnect-room",()=>Fc(this,!0));n(this,"peer-send-message",b=>{const c=b.tag;var d=b.message;const e=b.transmissionMode,f=b.contentMode;if(b=this.Aa.get(b.id)||null)"s"===f&&d instanceof ArrayBuffer?K(b,e,d,sc.Td):(d={c:"m",cm:f,m:d},"e"===f&&(d.t=c),K(b,e,JSON.stringify(d)))});n(this,"host-broadcast",b=>{var c=b.fromId;const d=b.tag,e=b.message,f=b.transmissionMode;b=b.contentMode;const g=this.Aa.get(c)||
null;"s"===b&&e instanceof ArrayBuffer?L(this,f,e,sc.Td,g):(c={c:"m",cm:b,f:c,m:e},"e"===b&&(c.t=d),L(this,f,JSON.stringify(c),0,g))});n(this,"kick-peer",b=>{if(this.s()){var c=b.reason;(b=this.Aa.get(b.id)||null)&&J(b,c,!0)}});n(this,"sync-object",b=>{const c=b.x,d=b.y,e=b.angle,f=b.precision,g=b.bandwidth;for(const h of b.objectClasses)b=new self.Qg(this,h.roId,h.sid,g),c&&Db(b,1,f,"x"),d&&Db(b,1,f,"y"),e&&Db(b,2,f,"a")});n(this,"sync-inst-var",b=>{const c=b.precision,d=b.interp,e=b.cvt;for(const f of b.syncData)Db(this.Mc.get(f.roId),
d,c,"iv",f.varIndex,e)});n(this,"associate-object",b=>{var c=b.peerId;const d=b.instUid;b=this.Mc.get(b.roId);c=this.Aa.get(c);if(b&&c&&this.s())if(c=c.X,b.Bb.has(d))console.warn("OverrideNid passed id "+d+" which is already in use and cannot be overridden");else if(b.ac.has(c))console.warn("OverrideNid passed nid "+c+" which is already in use and cannot be overridden");else{var e=new Cb(b,d,c);b.Bb.set(d,e);b.ac.add(c);b.Ha.push(e);b.Ob=!0}});n(this,"remove-object-id",b=>this.Zd(b.uid));n(this,"remove-net-insts",
b=>{for(const [c,d]of Object.entries(b))if(b=this.Mc.get(parseInt(c,10)))for(const e of d)Fb(b,e)});n(this,"remove-object-nid",b=>{const c=b.nid;(b=this.Mc.get(b.roId))&&Fb(b,c)});n(this,"set-client-state",b=>Ic(this,b.tag,b.value));n(this,"add-client-input-value",b=>{var c=b.tag;b=new oc(this.Oa.length,b.interp,b.precision,c,null);this.bd.set(c,b);this.Oa.push(b)})}s(){return!!this.T&&this.N&&this.S===this.N}na(a){if(!this.T)return null;a=a.dt;var b=performance.now();b-this.$f>=1E3/(this.s()?this.Ee:
this.Kc)-5&&(Jc(this,b),this.$f=b);var c=this.ta;1E3<=b-c.Sc&&(c.xg=c.gf,c.vg=c.Ld,c.wg=c.Md,c.qg=c.df,c.og=c.Kd,c.pg=c.dc,c.gf=0,c.Ld=0,c.Md=0,c.df=0,c.Kd=0,c.dc=0,c.Sc+=1E3,500<b-c.Sc&&(c.Sc=b),l(this,"stats",{stats:{outboundPerSec:c.xg,outboundBandwidthPerSec:c.vg,outboundDecompressedBandwidthPerSec:c.wg,inboundPerSec:c.qg,inboundBandwidthPerSec:c.og,inboundDecompressedBandwidthPerSec:c.pg}}));this.s()||(this.ca<this.Ka?(this.ca+=10*a,this.ca>this.Ka&&(this.ca=this.Ka)):this.ca>this.Ka&&(this.ca-=
10*a,this.ca<this.Ka&&(this.ca=this.Ka)),this.pa<this.eb?(this.pa+=30*a,this.pa>this.eb&&(this.pa=this.eb)):this.pa>this.eb&&(this.pa-=30*a,this.pa<this.eb&&(this.pa=this.eb)));a=Jb(this);for(var d of this.Pa)d.na(a);for(var e of this.Ea)e.na();d=Jb(this);e=this.s()?performance.now():performance.now()+this.ca+this.pa;a=this.Fa;b={};for(var f of this.Pa){c={};for(const g of this.Oa)c[g.cb]=rc(f,g);b[f.I]={nid:f.X,latency:f.qd,pdv:f.eg,clientState:c}}f={};for(const g of this.Ea)f[g.Oc]=g.Ib();return{simulationTime:d,
hostInputArrivalTime:e,clientDelay:a,peerData:b,roData:f,isReadyForInput:this.T?this.s()?!0:0!==this.Ka:!1}}Zd(a){for(const b of this.Ea)b.Zd(a)}});"use strict";const Nc=180/Math.PI;
async function Oc(a,b){if(b.isiOSCordova||b.isSafari)a.yd=!0;a.af=b.timeScaleMode;a.dg=["equalpower","HRTF","soundfield"][b.panningModel];a.Jf=["linear","inverse","exponential"][b.distanceModel];a.fg=b.refDistance;a.cg=b.maxDistance;a.hg=b.rolloffFactor;if(a.B.Ie)a.yd=!0,a.h=new OfflineAudioContext({numberOfChannels:2,sampleRate:48E3,length:Math.ceil(48E3*a.B.Nf)});else{var c={latencyHint:b.latencyHint};a.kg||(c.sampleRate=48E3);if("undefined"!==typeof AudioContext)a.h=new AudioContext(c);else if("undefined"!==
typeof webkitAudioContext)a.h=new webkitAudioContext(c);else throw Error("Web Audio API not supported");Pc(a);a.h.onstatechange=()=>{"running"!==a.h.state&&Pc(a);l(a,"audiocontext-state",{audioContextState:a.h.state})}}a.Mb=a.h.createGain();a.Mb.connect(a.h.destination);c=b.listenerPos;a.ya[0]=c[0];a.ya[1]=c[1];a.ya[2]=c[2];a.h.listener.setPosition(c[0],c[1],c[2]);a.h.listener.setOrientation(...a.Ga);self.C3_GetAudioContextCurrentTime=()=>a.h.currentTime;try{await Promise.all(b.preloadList.map(d=>
Qc(a,d.originalUrl,d.url,d.type,!1)))}catch(d){console.error("[Construct] Preloading sounds failed: ",d)}return{sampleRate:a.h.sampleRate,audioContextState:a.h.state,outputLatency:a.h.outputLatency||0}}
async function Rc(a,b){var c=b.originalUrl,d=b.url;const e=b.type,f=b.isMusic,g=b.tags,h=b.isLooping,k=b.vol,v=b.pos,p=b.panning,D=b.stereoPan;let y=b.off;0<y&&!b.trueClock&&(a.h.getOutputTimestamp?(b=a.h.getOutputTimestamp(),y=y-b.performanceTime/1E3+b.contextTime):y=y-performance.now()/1E3+a.h.currentTime);a.Wf=g.slice(0);Sc(a,g);try{a.ha=await Tc(a,c,d,e,g,f);if(p){Uc(a.ha,!0);var r=a.ha,t=p.innerAngle,F=p.outerAngle,I=p.outerGain;if(r.wc){Vc(r,p.x,p.y,p.z,p.angle);var w=self.fc.bh;r.ab[0]!==w(t)&&
(r.ab[0]=w(t),r.P.coneInnerAngle=w(t));r.ab[1]!==w(F)&&(r.ab[1]=w(F),r.P.coneOuterAngle=w(F));r.ab[2]!==I&&(r.ab[2]=I,r.P.coneOuterGain=I)}p.hasOwnProperty("uid")&&(a.ha.Ya=p.uid)}else"number"===typeof D&&0!==D?(Wc(a.ha,!0),Xc(a.ha,D)):(Uc(a.ha,!1),Wc(a.ha,!1));a.ha.Play(h,k,v,y)}catch(W){console.error("[Construct] Audio: error starting playback: ",W);return}finally{c=g.join(" ");d=a.Lc.get(c);if(!d)throw Error("expected pending tag");d.hf--;0===d.hf&&(d.resolve(),a.Lc.delete(c))}fa(a)}
async function Zc(a,b){var c=b.tags;const d=b.vol,e=b.duration;b=b.stopOnEnd;await $c(a,c);for(const h of U(a,c))if(!h.Pb){c=h.R.gain;c.cancelScheduledValues(0);var f=h.F.h.currentTime,g=f+e;c.setValueAtTime(c.value,f);c.linearRampToValueAtTime(d,g);h.Fb=d;h.Nb=g;h.jg=b}ad(a)}async function bd(a,b){const c=b.tags;b=b.rate;await $c(a,c);for(const d of U(a,c))d.Ua!==b&&(d.Ua=b,d.ub())}async function cd(a,b){const c=b.tags;b=b.pos;await $c(a,c);for(const d of U(a,c))d.$d(b)}
async function dd(a,b){const c=b.originalUrl,d=b.url,e=b.type;b=b.isMusic;try{await Tc(a,c,d,e,"",b)}catch(f){console.error("[Construct] Audio: error preloading: ",f)}}async function ed(a,b){if(b=await Qc(a,"",b.url,b.type,b.isMusic,!0))b.o(),b=a.Ra.indexOf(b),-1!==b&&a.Ra.splice(b,1)}
async function fd(a,b){const c=b.type;var d=b.tags;const e=b.params;let f;if("convolution"===c)try{f=await Qc(a,b.bufferOriginalUrl,b.bufferUrl,b.bufferType,!1)}catch(k){console.log("[Construct] Audio: error loading convolution: ",k);return}for(const k of d){if("filter"===c)d=new self.Eg(a,...e);else if("delay"===c)d=new self.Cg(a,...e);else if("convolution"===c){var g=d=new self.Bg(a,f.Qa,...e),h=b.bufferType;g.Ff=b.bufferOriginalUrl;g.Gf=h}else if("flanger"===c)d=new self.Fg(a,...e);else if("phaser"===
c)d=new self.Hg(a,...e);else if("gain"===c)d=new self.Gg(a,...e);else if("stereopan"===c)d=new self.Jg(a,...e);else if("tremolo"===c)d=new self.Kg(a,...e);else if("ringmod"===c)d=new self.Ig(a,...e);else if("distortion"===c)d=new self.Dg(a,...e);else if("compressor"===c)d=new self.Ag(a,...e);else if("analyser"===c)d=new self.zg(a,...e);else throw Error("invalid effect type");g=a;h=k;h=h.toLowerCase();let v=g.Sa.get(h);v||(v=[],g.Sa.set(h,v));d.tc=v.length;d.cb=h;v.push(d);gd(g,h)}hd(a)}
async function id(a,b){const c=b.saveLoadMode;if(3!==c){var d=[];for(var e of a.U)e.pb()&&1===c||!e.pb()&&2===c?d.push(e):e.o();a.U=d}for(const f of a.Sa.values())for(const g of f)g.o();a.Sa.clear();a.Ed=b.timeScale;a.Ae=b.gameTime;d=b.listenerPos;a.ya[0]=d[0];a.ya[1]=d[1];a.ya[2]=d[2];a.h.listener.setPosition(d[0],d[1],d[2]);d=b.listenerOrientation;if(Array.isArray(d)){for(e=0;6>e;++e)a.Ga[e]=d[e];a.h.listener.setOrientation(...a.Ga)}a.kb=b.isSilent;a.B.Wc(a.kb);a.td=b.masterVolume;a.Mb.gain.value=
a.td;d=[];for(const f of Object.values(b.effects))d.push(Promise.all(f.map(g=>fd(a,g))));await Promise.all(d);await Promise.all(b.playing.map(f=>jd(a,f,c)));ad(a)}
async function kd(a,b){try{const c=a.h.suspend(b.time);a.Sf?a.h.resume():(a.h.startRendering().then(d=>{const e=[];for(let f=0,g=d.numberOfChannels;f<g;++f){const h=d.getChannelData(f);e.push(h.buffer)}a.B.lc("runtime","offline-audio-render-completed",{duration:d.duration,length:d.length,numberOfChannels:d.numberOfChannels,sampleRate:d.sampleRate,channelData:e},null,e)}).catch(d=>ld(d)),a.Sf=!0);await c}catch(c){ld(c)}}
function Pc(a){a.kd||(a.De=!1,window.addEventListener("pointerup",a.ob,!0),window.addEventListener("touchend",a.ob,!0),window.addEventListener("click",a.ob,!0),window.addEventListener("keydown",a.ob,!0),a.kd=!0)}
async function Qc(a,b,c,d,e,f){for(var g of a.Ra)if(g.ic()===c)return await md(g),g;if(f)return null;if(e&&(a.yd||a.Rf)){f=0;for(let h=0,k=a.Ra.length;h<k;++h)g=a.Ra[h],a.Ra[f]=g,g.pb()?g.o():++f;a.Ra.length=f}f="audio/webm; codecs=opus"===d&&!a.kg;e&&f&&(a.Rf=!0);c=!e||a.yd||f?new self.Rg(a,b,c,d,e,f):new self.Lg(a,b,c,d,e);a.Ra.push(c);await md(c);a.ag.has(b)||(l(a,"buffer-metadata",{originalUrl:b,duration:c.Ma()}),a.ag.add(b));return c}
function nd(a,b){return a===b||a.normalize().toLowerCase()===b.normalize().toLowerCase()}function od(a,b){return(b=a.Sa.get(b.toLowerCase()))?b[0].da():a.La()}function gd(a,b){b=b.toLowerCase();let c=a.La();var d=a.Sa.get(b);if(d&&d.length){c=d[0].da();for(let f=0,g=d.length;f<g;++f){var e=d[f];f+1===g?e.ka(a.La()):e.ka(d[f+1].da())}}for(const f of pd(a,b))d=c,e=f.Ja||f.P||f.R,e.disconnect(),e.connect(d);a.Db&&a.Pe===b&&(a.Db.disconnect(),a.Db.connect(c))}
function*pd(a,b){if(b)for(const c of a.U)nd(0<c.Wa.length?c.Wa[0]:"",b)&&(yield c);else a.ha&&!a.ha.ea()&&(yield a.ha)}function qd(a,b,c){return c?a.B.yh(b).then(d=>{const e=a.h.createBuffer(1,d.length,48E3);e.getChannelData(0).set(d);return e}):new Promise((d,e)=>{a.h.decodeAudioData(b,d,e)})}function rd(a,b){let c=0;for(let d=0,e=a.U.length;d<e;++d){const f=a.U[d];a.U[c]=f;f.ga===b?f.o():++c}a.U.length=c}
function*U(a,b){if(0<b.length)for(const d of a.U){a:{a=d.Wa;var c=b;for(const e of c){c=!1;for(const f of a)if(nd(f,e)){c=!0;break}if(!c){a=!1;break a}}a=!0}a&&(yield d)}else a.ha&&!a.ha.ea()&&(yield a.ha)}async function Tc(a,b,c,d,e,f){for(const g of a.U)if(g.ic()===c&&(g.Rd()||f))return g.Wa=e,g;b=await Qc(a,b,c,d,f);e="html5"===b.qe?new self.Mg(b.F,b,e):new self.Sg(b.F,b,e);a.U.push(e);return e}
function Sc(a,b){b=b.join(" ");let c=a.Lc.get(b);if(!c){let d=null;c={hf:0,promise:new Promise(e=>d=e),resolve:d};a.Lc.set(b,c)}c.hf++}function $c(a,b){return(a=a.Lc.get((0===b.length?a.Wf:b).join(" ")))?a.promise:Promise.resolve()}function ad(a){if(0<a.Lb.size)fa(a);else for(const b of a.U)if(!b.W&&!b.ea()){fa(a);break}}function sd(a,b,c,d){l(a,"trigger",{type:b,tags:c,aiid:d})}function hd(a){a.Je||(a.Je=!0,Promise.resolve().then(()=>td(a)))}
function td(a){const b={};for(const [c,d]of a.Sa)b[c]=d.map(e=>e.hc());l(a,"fxstate",{fxstate:b});a.Je=!1}
async function jd(a,b,c){if(3!==c){var d=b.bufferOriginalUrl,e=b.bufferUrl,f=b.bufferType,g=b.isMusic,h=b.tags,k=b.isLooping,v=b.volume,p=b.playbackTime;if(!g||1!==c)if(g||2!==c){c=null;try{c=await Tc(a,d,e,f,h,g)}catch(D){console.error("[Construct] Audio: error loading audio state: ",D);return}a=c;(d=b.pan)?(Uc(a,!0),e=a.P,f=d.pos,a.Ub[0]=f[0],a.Ub[1]=f[1],a.Ub[2]=f[2],f=d.orient,a.Tb[0]=f[0],a.Tb[1]=f[1],a.Tb[2]=f[2],e.setPosition(...a.Ub),e.setOrientation(...a.Tb),a.ab[0]=d.cia,a.ab[1]=d.coa,a.ab[2]=
d.cog,e.coneInnerAngle=d.cia,e.coneOuterAngle=d.coa,e.coneOuterGain=d.cog,a.Ya=d.uid):Uc(a,!1);a=c;d=b.stereoPan;"number"!==typeof d?Wc(a,!1):(Wc(a,!0),Xc(a,d));c.Play(k,v,p,0);b.isPlaying||c.kc();c.ie(b)}}}function ld(a){console.error("[Audio] Offline rendering error: ",a)}
self.fc=class extends self.Gb{constructor(a){super(a,"audio");this.Mb=this.h=null;this.kd=this.De=!1;this.ob=()=>{if(!this.De){var b=this.h;"suspended"===b.state&&b.resume&&b.resume();var c=b.createBuffer(1,220,22050),d=b.createBufferSource();d.buffer=c;d.connect(b.destination);d.start(0);"running"===b.state&&this.kd&&(this.De=!0,window.removeEventListener("pointerup",this.ob,!0),window.removeEventListener("touchend",this.ob,!0),window.removeEventListener("click",this.ob,!0),window.removeEventListener("keydown",
this.ob,!0),this.kd=!1)}};this.Ra=[];this.U=[];this.ha=null;this.Wf=[];this.ag=new Set;this.Zf=-1;this.Lc=new Map;this.td=1;this.kb=!1;this.af=0;this.Ed=1;this.Ae=0;this.dg="HRTF";this.Jf="inverse";this.fg=600;this.cg=1E4;this.hg=1;this.ya=[0,0,0];this.Ga=[0,0,-1,0,1,0];this.Rf=this.yd=!1;this.kg=this.B.Xg();this.Sa=new Map;this.Lb=new Set;this.Sf=this.Je=!1;this.Pe="";this.Db=null;self.C3Audio_OnMicrophoneStream=(b,c)=>{this.Db&&this.Db.disconnect();this.Pe=c.toLowerCase();this.Db=this.h.createMediaStreamSource(b);
this.Db.connect(od(this,this.Pe))};this.ed=null;self.C3Audio_GetOutputStream=()=>{this.ed||(this.ed=this.h.createMediaStreamDestination(),this.Mb.connect(this.ed));return this.ed.stream};self.C3Audio_DOMInterface=this;ea(this,[["create-audio-context",b=>Oc(this,b)],["play",b=>Rc(this,b)],["stop",b=>{b=b.tags;for(const c of U(this,b))c.qb()}],["stop-all",()=>{for(const b of this.U)b.qb()}],["set-paused",b=>{const c=b.tags;b=b.paused;for(const d of U(this,c))b?d.kc():d.Vc();ad(this)}],["set-volume",
b=>{const c=b.tags;b=b.vol;for(const d of U(this,c))ud(d,b)}],["fade-volume",b=>Zc(this,b)],["set-master-volume",b=>{this.td=b.vol;this.Mb.gain.value=this.td}],["set-muted",b=>{const c=b.tags;b=b.isMuted;for(const d of U(this,c))vd(d,b)}],["set-silent",b=>{this.kb=b.isSilent;this.B.Wc(this.kb);for(const c of this.U)c.$c()}],["set-looping",b=>{const c=b.tags;b=b.isLooping;for(const d of U(this,c))d.ae(b)}],["set-playback-rate",b=>bd(this,b)],["set-stereo-pan",b=>{const c=b.tags;b=b.p;for(const d of U(this,
c))Wc(d,!0),Xc(d,b)}],["seek",b=>cd(this,b)],["preload",b=>dd(this,b)],["unload",b=>ed(this,b)],["unload-all",()=>{for(const b of this.Ra)b.o();this.Ra.length=0}],["set-suspended",b=>{b=b.isSuspended;!b&&this.h.resume&&this.h.resume();for(const c of this.U)c.be(b);b&&this.h.suspend&&this.h.suspend()}],["add-effect",b=>fd(this,b)],["set-effect-param",b=>{var c=b.tags;const d=b.index,e=b.param,f=b.value,g=b.ramp;b=b.time;for(const h of c)c=this.Sa.get(h.toLowerCase()),!c||0>d||d>=c.length||c[d].ua(e,
f,g,b);hd(this)}],["remove-effects",b=>{b=b.tags;for(const c of b){b=c.toLowerCase();const d=this.Sa.get(b);if(!d||!d.length)break;for(const e of d)e.o();this.Sa.delete(b);gd(this,b)}}],["tick",b=>{this.Ed=b.timeScale;this.Ae=b.gameTime;this.Zf=b.tickCount;if(0!==this.af)for(var c of this.U)c.ub();!(c=b.listenerPos)||this.ya[0]===c[0]&&this.ya[1]===c[1]&&this.ya[2]===c[2]||(this.ya[0]=c[0],this.ya[1]=c[1],this.ya[2]=c[2],this.h.listener.setPosition(c[0],c[1],c[2]));if((c=b.listenerOrientation)&&(this.Ga[0]!==
c[0]||this.Ga[1]!==c[1]||this.Ga[2]!==c[2]||this.Ga[3]!==c[3]||this.Ga[4]!==c[4]||this.Ga[5]!==c[5])){for(let d=0;6>d;++d)this.Ga[d]=c[d];this.h.listener.setOrientation(...this.Ga)}for(const d of b.instPans){b=d.uid;for(const e of this.U)e.Ya===b&&Vc(e,d.x,d.y,d.z,d.angle)}}],["load-state",b=>id(this,b)],["offline-render-audio",b=>kd(this,b)],["offline-render-finish",()=>{this.h.resume()}]])}la(){return this.h}La(){return this.Mb}GetAudioContextExtern(){return this.la()}GetDestinationNodeExtern(){return this.La()}Uc(){return this.kb}rb(a){this.B.rb(a)}Jb(a){this.B.Jb(a)}na(){for(var a of this.Lb)a.na();
a=this.h.currentTime;for(var b of this.U)b.na(a);b=this.U.filter(c=>!c.W&&!c.ea()).map(c=>c.hc());l(this,"state",{tickCount:this.Zf,outputLatency:this.h.outputLatency||0,audioInstances:b,analysers:[...this.Lb].map(c=>({tag:c.cb,index:c.tc,peak:c.Vb,rms:c.gg,binCount:c.v.frequencyBinCount,freqBins:c.Pf}))});0===b.length&&0===this.Lb.size&&this.ld&&(this.B.wh(this.lg),this.ld=!1)}static bh(a){return a*Nc}static nf(a){return Math.max(Math.min(Math.pow(10,a/20),1),0)}static $g(a){return Math.log(Math.max(Math.min(a,
1),0))/Math.log(10)*20}};self.ib.ec(self.fc);"use strict";function md(a){a.rd||(a.rd=a.he());return a.rd}self.kf=class{constructor(a,b,c,d,e){this.F=a;this.Gh=b;this.Eb=c;this.ja=d;this.Ah=e;this.qe="";this.rd=null}o(){this.rd=this.F=null}he(){}la(){return this.F.la()}Vd(){return this.Gh}ic(){return this.Eb}Ud(){return this.ja}pb(){return this.Ah}Ma(){}};"use strict";
self.Lg=class extends self.kf{constructor(a,b,c,d,e){super(a,b,c,d,e);this.qe="html5";this.ba=new Audio;this.ba.crossOrigin="anonymous";this.ba.autoplay=!1;this.ba.preload="auto";this.Bc=this.Cc=null;this.ba.addEventListener("canplaythrough",()=>!0);this.Jc=this.la().createGain();this.Ec=null;this.ba.addEventListener("canplay",()=>{this.Cc&&(this.Cc(),this.Bc=this.Cc=null);!this.Ec&&this.ba&&(this.Ec=this.la().createMediaElementSource(this.ba),this.Ec.connect(this.Jc))});this.onended=null;this.ba.addEventListener("ended",
()=>{if(this.onended)this.onended()});this.ba.addEventListener("error",f=>{console.error(`[Construct] Audio '${this.Eb}' error: `,f);this.Bc&&(this.Bc(f),this.Bc=this.Cc=null)})}o(){rd(this.F,this);this.Jc.disconnect();this.Jc=null;this.Ec.disconnect();this.Ec=null;this.ba&&!this.ba.paused&&this.ba.pause();this.ba=this.onended=null;super.o()}he(){return new Promise((a,b)=>{this.Cc=a;this.Bc=b;this.ba.src=this.Eb})}ma(){return this.ba}Ma(){return this.ba.duration}};"use strict";
async function wd(a){if(a.vb)return a.vb;var b=a.F.B;if("cordova"===b.G&&b.sf(a.Eb)&&b.md)a.vb=await b.Tc(a.Eb);else{b=await fetch(a.Eb);if(!b.ok)throw Error(`error fetching audio data: ${b.status} ${b.statusText}`);a.vb=await b.arrayBuffer()}}async function xd(a){if(a.Qa)return a.Qa;a.Qa=await qd(a.F,a.vb,a.Eh);a.vb=null}
self.Rg=class extends self.kf{constructor(a,b,c,d,e,f){super(a,b,c,d,e);this.qe="webaudio";this.Qa=this.vb=null;this.Eh=!!f}o(){rd(this.F,this);this.Qa=this.vb=null;super.o()}async he(){try{await wd(this),await xd(this)}catch(a){console.error(`[Construct] Failed to load audio '${this.Eb}': `,a)}}Ma(){return this.Qa?this.Qa.duration:0}};"use strict";let yd=0;
function Uc(a,b){b=!!b;a.wc!==b&&(a.wc=b,a.wc?(Wc(a,!1),a.P||(a.P=a.la().createPanner(),a.P.panningModel=a.F.dg,a.P.distanceModel=a.F.Jf,a.P.refDistance=a.F.fg,a.P.maxDistance=a.F.cg,a.P.rolloffFactor=a.F.hg),a.R.disconnect(),a.R.connect(a.P),a.P.connect(a.La())):(a.P.disconnect(),a.R.disconnect(),a.R.connect(a.La())))}
function Wc(a,b){b=!!b;a.nd!==b&&(a.nd=b,a.nd?(Uc(a,!1),a.Ja=a.la().createStereoPanner(),a.R.disconnect(),a.R.connect(a.Ja),a.Ja.connect(a.La())):(a.Ja.disconnect(),a.Ja=null,a.R.disconnect(),a.R.connect(a.La())))}function Xc(a,b){a.nd&&a.Ze!==b&&(a.Ja.pan.value=b,a.Ze=b)}function ud(a,b){a.Fb=b;a.R.gain.cancelScheduledValues(0);a.Nb=-1;a.R.gain.value=a.Wd()}function vd(a,b){b=!!b;a.Pb!==b&&(a.Pb=b,a.$c())}
function Vc(a,b,c,d,e){if(a.wc){var f=a.Ub,g=a.Tb,h=Math.cos(e);e=Math.sin(e);if(f[0]!==b||f[1]!==c||f[2]!==d)f[0]=b,f[1]=c,f[2]=d,a.P.setPosition(...f);if(g[0]!==h||g[1]!==e||0!==g[2])g[0]=h,g[1]=e,g[2]=0,a.P.setOrientation(...g)}}function zd(a){return a.Ke?a.F.Ae:performance.now()/1E3}
self.lf=class{constructor(a,b,c){this.F=a;this.ga=b;this.Wa=c;this.ad=yd++;this.R=this.la().createGain();this.R.connect(this.La());this.P=null;this.wc=!1;this.Ub=[0,0,0];this.Tb=[0,0,0];this.ab=[0,0,0];this.Ja=null;this.nd=!1;this.Ze=0;this.W=!0;this.ra=this.bb=this.Z=!1;this.Fb=1;this.Pb=!1;this.Ua=1;a=this.F.af;this.Ke=1===a&&!this.pb()||2===a;this.Nb=this.Ya=-1;this.jg=!1}o(){this.ga=this.F=null;this.P&&(this.P.disconnect(),this.P=null);this.Ja&&(this.Ja.disconnect(),this.Ja=null);this.R.disconnect();
this.R=null}la(){return this.F.la()}La(){return od(this.F,0<this.Wa.length?this.Wa[0]:"")}Vd(){return this.ga.Vd()}ic(){return this.ga.ic()}Ud(){return this.ga.Ud()}pb(){return this.ga.pb()}ea(){}Rd(){}IsPlaying(){return!this.W&&!this.Z&&!this.ea()}Hb(){}Ma(){return this.ga.Ma()}Play(){}qb(){}kc(){}Vc(){}na(a){-1!==this.Nb&&a>=this.Nb&&(this.Nb=-1,this.jg&&this.qb(),sd(this.F,"fade-ended",this.Wa,this.ad))}Wd(){const a=this.Fb;return isFinite(a)?a:0}Uc(){return this.F.Uc()}$c(){}ae(){}ub(){}$d(){}be(){}Xd(){}hc(){var a=
this.ad,b=this.Wa,c=this.Ma(),d=-1===this.Nb?this.Fb:this.R.gain.value,e=this.IsPlaying();if(this.P){var f=this.P;f={pos:this.Ub,orient:this.Tb,cia:f.coneInnerAngle,coa:f.coneOuterAngle,cog:f.coneOuterGain,uid:this.Ya}}else f=null;return{aiid:a,tags:b,duration:c,volume:d,isPlaying:e,playbackTime:this.Hb(),playbackRate:this.Ua,uid:this.Ya,bufferOriginalUrl:this.Vd(),bufferUrl:"",bufferType:this.Ud(),isMusic:this.pb(),isLooping:this.ra,isMuted:this.Pb,resumePosition:this.Xd(),pan:f,stereoPan:this.Ja?
this.Ze:null}}ie(a){var b=a.playbackRate;this.Ua!==b&&(this.Ua=b,this.ub());vd(this,a.isMuted)}};"use strict";
self.Mg=class extends self.lf{constructor(a,b,c){super(a,b,c);this.ga.Jc.connect(this.R);this.ga.onended=()=>this.le()}o(){this.qb();this.ga.Jc.disconnect();super.o()}ma(){return this.ga.ma()}le(){this.W=!0;this.Ya=-1;sd(this.F,"ended",this.Wa,this.ad)}ea(){return this.ma().ended}Rd(){return this.W?!0:this.ea()}Hb(){let a=this.ma().currentTime;this.ra||(a=Math.min(a,this.Ma()));return a}Play(a,b,c){const d=this.ma();1!==d.playbackRate&&(d.playbackRate=1);d.loop!==a&&(d.loop=a);ud(this,b);d.muted&&
(d.muted=!1);if(d.currentTime!==c)try{d.currentTime=c}catch(e){console.warn(`[Construct] Exception seeking audio '${this.ga.ic()}' to position '${c}': `,e)}this.F.rb(d);this.Z=this.W=!1;this.ra=a;this.Ua=1}qb(){const a=this.ma();a.paused||a.pause();this.F.Jb(a);this.W=!0;this.Z=!1;this.Ya=-1}kc(){if(!(this.Z||this.W||this.ea())){var a=this.ma();a.paused||a.pause();this.F.Jb(a);this.Z=!0}}Vc(){!this.Z||this.W||this.ea()||(this.F.rb(this.ma()),this.Z=!1)}$c(){this.ma().muted=this.Pb||this.Uc()}ae(a){a=
!!a;this.ra!==a&&(this.ra=a,this.ma().loop=a)}ub(){let a=this.Ua;this.Ke&&(a*=this.F.Ed);try{this.ma().playbackRate=a}catch(b){console.warn(`[Construct] Unable to set playback rate '${a}':`,b)}}$d(a){if(!this.W&&!this.ea())try{this.ma().currentTime=a}catch(b){console.warn(`[Construct] Error seeking audio to '${a}': `,b)}}Xd(){return this.Hb()}be(a){a?this.IsPlaying()?(this.ma().pause(),this.bb=!0):this.bb=!1:this.bb&&(this.F.rb(this.ma()),this.bb=!1)}};"use strict";
function Ad(a){a.C&&(a.C.onended=null,a.C.disconnect(),a.C.buffer=null);a.C=null;a.mc=null}
self.Sg=class extends self.lf{constructor(a,b,c){super(a,b,c);this.C=null;this.vd=d=>this.le(d);this.Ce=!0;this.mc=null;this.ia=this.xd=this.zd=0;this.Qe=1}o(){this.qb();Ad(this);this.vd=null;super.o()}le(a){this.Z||this.bb||a.target!==this.mc||(this.W=this.Ce=!0,this.Ya=-1,Ad(this),sd(this.F,"ended",this.Wa,this.ad))}ea(){return!this.W&&this.C&&this.C.loop||this.Z?!1:this.Ce}Rd(){return!this.C||this.W?!0:this.ea()}Hb(){let a;a=this.Z?this.ia:this.xd+(zd(this)-this.zd)*this.Ua;this.ra||(a=Math.min(a,
this.Ma()));return a}Play(a,b,c,d){this.Qe=1;ud(this,b);Ad(this);this.C=this.la().createBufferSource();this.C.buffer=this.ga.Qa;this.C.connect(this.R);this.mc=this.C;this.C.onended=this.vd;this.C.loop=a;this.C.start(d,c);this.Z=this.W=this.Ce=!1;this.ra=a;this.Ua=1;this.zd=zd(this);this.xd=c}qb(){if(this.C)try{this.C.stop(0)}catch(a){}this.W=!0;this.Z=!1;this.Ya=-1}kc(){this.Z||this.W||this.ea()||(this.ia=this.Hb(),this.ra&&(this.ia%=this.Ma()),this.Z=!0,this.C.stop(0))}Vc(){!this.Z||this.W||this.ea()||
(Ad(this),this.C=this.la().createBufferSource(),this.C.buffer=this.ga.Qa,this.C.connect(this.R),this.mc=this.C,this.C.onended=this.vd,this.C.loop=this.ra,ud(this,this.Fb),this.ub(),this.C.start(0,this.ia),this.zd=zd(this),this.xd=this.ia,this.Z=!1)}Wd(){return super.Wd()*this.Qe}$c(){this.Qe=this.Pb||this.Uc()?0:1;ud(this,this.Fb)}ae(a){a=!!a;this.ra!==a&&(this.ra=a,this.C&&(this.C.loop=a))}ub(){let a=this.Ua;this.Ke&&(a*=this.F.Ed);this.C&&(this.C.playbackRate.value=a)}$d(a){this.W||this.ea()||(this.Z?
this.ia=a:(this.kc(),this.ia=a,this.Vc()))}Xd(){return this.ia}be(a){a?this.IsPlaying()?(this.bb=!0,this.ia=this.Hb(),this.ra&&(this.ia%=this.Ma()),this.C.stop(0)):this.bb=!1:this.bb&&(Ad(this),this.C=this.la().createBufferSource(),this.C.buffer=this.ga.Qa,this.C.connect(this.R),this.mc=this.C,this.C.onended=this.vd,this.C.loop=this.ra,ud(this,this.Fb),this.ub(),this.C.start(0,this.ia),this.zd=zd(this),this.xd=this.ia,this.bb=!1)}ie(a){super.ie(a);this.ia=a.resumePosition}};"use strict";
function X(a){return a.h.createGain()}function Y(a,b,c,d,e){b.cancelScheduledValues(0);if(0===e)b.value=c;else switch(a=a.h.currentTime,e+=a,d){case 0:b.setValueAtTime(c,e);break;case 1:b.setValueAtTime(b.value,a);b.linearRampToValueAtTime(c,e);break;case 2:b.setValueAtTime(b.value,a),b.exponentialRampToValueAtTime(c,e)}}class Z{constructor(a){this.F=a;this.h=a.la();this.tc=-1;this.ja=this.cb="";this.A=null}o(){this.h=null}da(){}ka(){}hc(){return{type:this.ja,tag:this.cb,params:this.A}}}
self.Eg=class extends Z{constructor(a,b,c,d,e,f,g){super(a);this.ja="filter";this.A=[b,c,d,e,f,g];this.H=X(this);this.l=X(this);this.l.gain.value=g;this.j=X(this);this.j.gain.value=1-g;this.M=this.h.createBiquadFilter();this.M.type=b;this.M.frequency.value=c;this.M.detune.value=d;this.M.Q.value=e;this.M.gain.vlaue=f;this.H.connect(this.M);this.H.connect(this.j);this.M.connect(this.l)}o(){this.H.disconnect();this.M.disconnect();this.l.disconnect();this.j.disconnect();super.o()}ka(a){this.l.disconnect();
this.l.connect(a);this.j.disconnect();this.j.connect(a)}da(){return this.H}ua(a,b,c,d){switch(a){case 0:b=Math.max(Math.min(b/100,1),0);this.A[5]=b;Y(this,this.l.gain,b,c,d);Y(this,this.j.gain,1-b,c,d);break;case 1:this.A[1]=b;Y(this,this.M.frequency,b,c,d);break;case 2:this.A[2]=b;Y(this,this.M.detune,b,c,d);break;case 3:this.A[3]=b;Y(this,this.M.Q,b,c,d);break;case 4:this.A[4]=b,Y(this,this.M.gain,b,c,d)}}};
self.Cg=class extends Z{constructor(a,b,c,d){super(a);this.ja="delay";this.A=[b,c,d];this.H=X(this);this.l=X(this);this.l.gain.value=d;this.j=X(this);this.j.gain.value=1-d;this.Dc=X(this);this.qa=this.h.createDelay(b);this.qa.delayTime.value=b;this.rc=X(this);this.rc.gain.value=c;this.H.connect(this.Dc);this.H.connect(this.j);this.Dc.connect(this.l);this.Dc.connect(this.qa);this.qa.connect(this.rc);this.rc.connect(this.Dc)}o(){this.H.disconnect();this.l.disconnect();this.j.disconnect();this.Dc.disconnect();
this.qa.disconnect();this.rc.disconnect();super.o()}ka(a){this.l.disconnect();this.l.connect(a);this.j.disconnect();this.j.connect(a)}da(){return this.H}ua(a,b,c,d){const e=self.fc.nf;switch(a){case 0:b=Math.max(Math.min(b/100,1),0);this.A[2]=b;Y(this,this.l.gain,b,c,d);Y(this,this.j.gain,1-b,c,d);break;case 4:this.A[1]=e(b);Y(this,this.rc.gain,e(b),c,d);break;case 5:this.A[0]=b,Y(this,this.qa.delayTime,b,c,d)}}};
self.Bg=class extends Z{constructor(a,b,c,d){super(a);this.ja="convolution";this.A=[c,d];this.Gf=this.Ff="";this.H=X(this);this.l=X(this);this.l.gain.value=d;this.j=X(this);this.j.gain.value=1-d;this.pc=this.h.createConvolver();this.pc.normalize=c;this.pc.buffer=b;this.H.connect(this.pc);this.H.connect(this.j);this.pc.connect(this.l)}o(){this.H.disconnect();this.pc.disconnect();this.l.disconnect();this.j.disconnect();super.o()}ka(a){this.l.disconnect();this.l.connect(a);this.j.disconnect();this.j.connect(a)}da(){return this.H}ua(a,
b,c,d){switch(a){case 0:b=Math.max(Math.min(b/100,1),0),this.A[1]=b,Y(this,this.l.gain,b,c,d),Y(this,this.j.gain,1-b,c,d)}}hc(){const a=super.hc();a.bufferOriginalUrl=this.Ff;a.bufferUrl="";a.bufferType=this.Gf;return a}};
self.Fg=class extends Z{constructor(a,b,c,d,e,f){super(a);this.ja="flanger";this.A=[b,c,d,e,f];this.H=X(this);this.j=X(this);this.j.gain.value=1-f/2;this.l=X(this);this.l.gain.value=f/2;this.sc=X(this);this.sc.gain.value=e;this.qa=this.h.createDelay(b+c);this.qa.delayTime.value=b;this.J=this.h.createOscillator();this.J.frequency.value=d;this.$=X(this);this.$.gain.value=c;this.H.connect(this.qa);this.H.connect(this.j);this.qa.connect(this.l);this.qa.connect(this.sc);this.sc.connect(this.qa);this.J.connect(this.$);
this.$.connect(this.qa.delayTime);this.J.start(0)}o(){this.J.stop(0);this.H.disconnect();this.qa.disconnect();this.J.disconnect();this.$.disconnect();this.j.disconnect();this.l.disconnect();this.sc.disconnect();super.o()}ka(a){this.l.disconnect();this.l.connect(a);this.j.disconnect();this.j.connect(a)}da(){return this.H}ua(a,b,c,d){switch(a){case 0:b=Math.max(Math.min(b/100,1),0);this.A[4]=b;Y(this,this.l.gain,b/2,c,d);Y(this,this.j.gain,1-b/2,c,d);break;case 6:this.A[1]=b/1E3;Y(this,this.$.gain,
b/1E3,c,d);break;case 7:this.A[2]=b;Y(this,this.J.frequency,b,c,d);break;case 8:this.A[3]=b/100,Y(this,this.sc.gain,b/100,c,d)}}};
self.Hg=class extends Z{constructor(a,b,c,d,e,f,g){super(a);this.ja="phaser";this.A=[b,c,d,e,f,g];this.H=X(this);this.j=X(this);this.j.gain.value=1-g/2;this.l=X(this);this.l.gain.value=g/2;this.M=this.h.createBiquadFilter();this.M.type="allpass";this.M.frequency.value=b;this.M.detune.value=c;this.M.Q.value=d;this.J=this.h.createOscillator();this.J.frequency.value=f;this.$=X(this);this.$.gain.value=e;this.H.connect(this.M);this.H.connect(this.j);this.M.connect(this.l);this.J.connect(this.$);this.$.connect(this.M.frequency);
this.J.start(0)}o(){this.J.stop(0);this.H.disconnect();this.M.disconnect();this.J.disconnect();this.$.disconnect();this.j.disconnect();this.l.disconnect();super.o()}ka(a){this.l.disconnect();this.l.connect(a);this.j.disconnect();this.j.connect(a)}da(){return this.H}ua(a,b,c,d){switch(a){case 0:b=Math.max(Math.min(b/100,1),0);this.A[5]=b;Y(this,this.l.gain,b/2,c,d);Y(this,this.j.gain,1-b/2,c,d);break;case 1:this.A[0]=b;Y(this,this.M.frequency,b,c,d);break;case 2:this.A[1]=b;Y(this,this.M.detune,b,
c,d);break;case 3:this.A[2]=b;Y(this,this.M.Q,b,c,d);break;case 6:this.A[3]=b;Y(this,this.$.gain,b,c,d);break;case 7:this.A[4]=b,Y(this,this.J.frequency,b,c,d)}}};self.Gg=class extends Z{constructor(a,b){super(a);this.ja="gain";this.A=[b];this.v=X(this);this.v.gain.value=b}o(){this.v.disconnect();super.o()}ka(a){this.v.disconnect();this.v.connect(a)}da(){return this.v}ua(a,b,c,d){const e=self.fc.nf;switch(a){case 4:this.A[0]=e(b),Y(this,this.v.gain,e(b),c,d)}}};
self.Jg=class extends Z{constructor(a,b){super(a);this.ja="stereopan";this.A=[b];this.v=this.h.createStereoPanner();this.v.pan.value=b}o(){this.v.disconnect();super.o()}ka(a){this.v.disconnect();this.v.connect(a)}da(){return this.v}ua(a,b,c,d){b=Math.min(Math.max(b/100,-1),1);switch(a){case 9:this.A[0]=b,Y(this,this.v.pan,b,c,d)}}};
self.Kg=class extends Z{constructor(a,b,c){super(a);this.ja="tremolo";this.A=[b,c];this.v=X(this);this.v.gain.value=1-c/2;this.J=this.h.createOscillator();this.J.frequency.value=b;this.$=X(this);this.$.gain.value=c/2;this.J.connect(this.$);this.$.connect(this.v.gain);this.J.start(0)}o(){this.J.stop(0);this.J.disconnect();this.$.disconnect();this.v.disconnect();super.o()}ka(a){this.v.disconnect();this.v.connect(a)}da(){return this.v}ua(a,b,c,d){switch(a){case 0:b=Math.max(Math.min(b/100,1),0);this.A[1]=
b;Y(this,this.v.gain,1-b/2,c,d);Y(this,this.$.gain,b/2,c,d);break;case 7:this.A[0]=b,Y(this,this.J.frequency,b,c,d)}}};
self.Ig=class extends Z{constructor(a,b,c){super(a);this.ja="ringmod";this.A=[b,c];this.H=X(this);this.l=X(this);this.l.gain.value=c;this.j=X(this);this.j.gain.value=1-c;this.Nc=X(this);this.Nc.gain.value=0;this.J=this.h.createOscillator();this.J.frequency.value=b;this.J.connect(this.Nc.gain);this.J.start(0);this.H.connect(this.Nc);this.H.connect(this.j);this.Nc.connect(this.l)}o(){this.J.stop(0);this.J.disconnect();this.Nc.disconnect();this.H.disconnect();this.l.disconnect();this.j.disconnect();
super.o()}ka(a){this.l.disconnect();this.l.connect(a);this.j.disconnect();this.j.connect(a)}da(){return this.H}ua(a,b,c,d){switch(a){case 0:b=Math.max(Math.min(b/100,1),0);this.A[1]=b;Y(this,this.l.gain,b,c,d);Y(this,this.j.gain,1-b,c,d);break;case 7:this.A[0]=b,Y(this,this.J.frequency,b,c,d)}}};
self.Dg=class extends Z{constructor(a,b,c,d,e,f){super(a);this.ja="distortion";this.A=[b,c,d,e,f];this.H=X(this);this.Bd=X(this);this.Ad=X(this);a=d;.01>a&&(a=.01);this.Bd.gain.value=a;this.Ad.gain.value=Math.pow(1/a,.6)*e;this.l=X(this);this.l.gain.value=f;this.j=X(this);this.j.gain.value=1-f;this.Id=this.h.createWaveShaper();this.ue=new Float32Array(65536);for(e=0;32768>e;++e)f=e/32768,a=1.05*c*b-b,d=0>f?-f:f,d<b?a=d:(d=1-Math.exp(-(1/a)*(d-b)),a=b+a*d),f=a*(0>f?-1:1),this.ue[32768+e]=f,this.ue[32768-
e-1]=-f;this.Id.curve=this.ue;this.H.connect(this.Bd);this.H.connect(this.j);this.Bd.connect(this.Id);this.Id.connect(this.Ad);this.Ad.connect(this.l)}o(){this.H.disconnect();this.Bd.disconnect();this.Id.disconnect();this.Ad.disconnect();this.l.disconnect();this.j.disconnect();super.o()}ka(a){this.l.disconnect();this.l.connect(a);this.j.disconnect();this.j.connect(a)}da(){return this.H}ua(a,b,c,d){switch(a){case 0:b=Math.max(Math.min(b/100,1),0),this.A[4]=b,Y(this,this.l.gain,b,c,d),Y(this,this.j.gain,
1-b,c,d)}}};self.Ag=class extends Z{constructor(a,b,c,d,e,f){super(a);this.ja="compressor";this.A=[b,c,d,e,f];this.v=this.h.createDynamicsCompressor();this.v.threshold.value=b;this.v.knee.value=c;this.v.ratio.value=d;this.v.attack.value=e;this.v.release.value=f}o(){this.v.disconnect();super.o()}ka(a){this.v.disconnect();this.v.connect(a)}da(){return this.v}ua(){}};
self.zg=class extends Z{constructor(a,b,c){super(a);this.ja="analyser";this.A=[b,c];this.v=this.h.createAnalyser();this.v.fftSize=b;this.v.smoothingTimeConstant=c;this.Pf=new Float32Array(this.v.frequencyBinCount);this.ig=new Uint8Array(b);this.gg=this.Vb=0;a=this.F;a.Lb.add(this);ad(a)}o(){this.F.Lb.delete(this);this.v.disconnect();super.o()}na(){this.v.getFloatFrequencyData(this.Pf);this.v.getByteTimeDomainData(this.ig);const a=this.v.fftSize;let b=this.Vb=0;for(var c=0;c<a;++c){let d=(this.ig[c]-
128)/128;0>d&&(d=-d);this.Vb<d&&(this.Vb=d);b+=d*d}c=self.fc.$g;this.Vb=c(this.Vb);this.gg=c(Math.sqrt(b/a))}ka(a){this.v.disconnect();this.v.connect(a)}da(){return this.v}ua(){}};"use strict";
self.ib.ec(class extends self.Gb{constructor(a){super(a,"mouse");ea(this,[["cursor",b=>{document.documentElement.style.cursor=b}],["request-pointer-lock",()=>{this.B.V.requestPointerLock()}],["release-pointer-lock",()=>{document.exitPointerLock()}]]);document.addEventListener("pointerlockchange",()=>{l(this,"pointer-lock-change",{"has-pointer-lock":!!document.pointerLockElement})});document.addEventListener("pointerlockerror",()=>{l(this,"pointer-lock-error",{"has-pointer-lock":!!document.pointerLockElement})})}});
"use strict";function Bd(){}function Cd(a){window.C3_RegisterSW&&window.OfflineClientInfo&&window.OfflineClientInfo.SetMessageCallback(b=>l(a,"sw-message",b.data))}
function Dd(a){a=a.orientation;if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(a).catch(b=>console.warn("[Construct] Failed to lock orientation: ",b));else try{let b=!1;screen.lockOrientation?b=screen.lockOrientation(a):screen.webkitLockOrientation?b=screen.webkitLockOrientation(a):screen.mozLockOrientation?b=screen.mozLockOrientation(a):screen.msLockOrientation&&(b=screen.msLockOrientation(a));b||console.warn("[Construct] Failed to lock orientation")}catch(b){console.warn("[Construct] Failed to lock orientation: ",
b)}}
self.ib.ec(class extends self.Gb{constructor(a){super(a,"browser");this.G="";ea(this,[["get-initial-state",b=>{this.G=b.exportType;return{location:location.toString(),isOnline:!!navigator.onLine,referrer:document.referrer,title:document.title,isCookieEnabled:!!navigator.cookieEnabled,screenWidth:screen.width,screenHeight:screen.height,windowOuterWidth:window.outerWidth,windowOuterHeight:window.outerHeight,isConstructArcade:"undefined"!==typeof window.is_scirra_arcade}}],["ready-for-sw-messages",()=>
Cd(this)],["alert",b=>this.je(b)],["close",()=>this.ke()],["set-focus",b=>this.me(b)],["vibrate",b=>{navigator.vibrate&&navigator.vibrate(b.pattern)}],["lock-orientation",b=>Dd(b)],["unlock-orientation",()=>{try{screen.orientation&&screen.orientation.unlock?screen.orientation.unlock():screen.unlockOrientation?screen.unlockOrientation():screen.webkitUnlockOrientation?screen.webkitUnlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()}catch(b){}}],
["navigate",b=>{var c=b.type;if("back"===c)navigator.app&&navigator.app.backHistory?navigator.app.backHistory():window.history.back();else if("forward"===c)window.history.forward();else if("reload"===c)location.reload();else if("url"===c){c=b.url;const d=b.target;b=b.exportType;self.cordova&&self.cordova.InAppBrowser?self.cordova.InAppBrowser.open(c,"_system"):"preview"===b||this.B.hb()?window.open(c,"_blank"):this.bi||(2===d?window.top.location=c:1===d?window.parent.location=c:window.location=c)}else"new-window"===
c&&(c=b.url,b=b.tag,self.cordova&&self.cordova.InAppBrowser?self.cordova.InAppBrowser.open(c,"_system"):window.open(c,b))}],["request-fullscreen",b=>{if(this.B.hb()||"macos-wkwebview"===this.G)self.ib.Zc(!0),this.B.sb({type:"set-fullscreen",fullscreen:!0});else{const c={navigationUI:"auto"};b=b.navUI;1===b?c.navigationUI="hide":2===b&&(c.navigationUI="show");b=document.documentElement;let d;b.requestFullscreen?d=b.requestFullscreen(c):b.mozRequestFullScreen?d=b.mozRequestFullScreen(c):b.msRequestFullscreen?
d=b.msRequestFullscreen(c):b.webkitRequestFullScreen&&(d="undefined"!==typeof Element.ALLOW_KEYBOARD_INPUT?b.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):b.webkitRequestFullScreen());d instanceof Promise&&d.catch(Bd)}}],["exit-fullscreen",()=>{if(this.B.hb()||"macos-wkwebview"===this.G)self.ib.Zc(!1),this.B.sb({type:"set-fullscreen",fullscreen:!1});else{let b;document.exitFullscreen?b=document.exitFullscreen():document.mozCancelFullScreen?b=document.mozCancelFullScreen():document.msExitFullscreen?
b=document.msExitFullscreen():document.webkitCancelFullScreen&&(b=document.webkitCancelFullScreen());b instanceof Promise&&b.catch(Bd)}}],["set-hash",b=>{location.hash=b.hash}],["set-document-css-style",b=>{const c=b.prop,d=b.value;var e=b.selector;b=b["is-all"];try{if(e)if(b)var f=Array.from(document.querySelectorAll(e));else{var g=document.querySelector(e);f=g?[g]:[]}else f=[document.documentElement];e=f;for(const h of e)c.startsWith("--")?h.style.setProperty(c,d):h.style[c]=d}catch(h){console.warn("[Browser] Failed to set style: ",
h)}}],["get-document-css-style",b=>{{const d=b.prop;b=b.selector;try{const e=document.querySelector(b);var c=e?{isOk:!0,result:window.getComputedStyle(e).getPropertyValue(d)}:{isOk:!1}}catch(e){console.warn("[Browser] Failed to get style: ",e),c={isOk:!1}}}return c}]]);window.addEventListener("online",()=>{l(this,"online-state",{isOnline:!0})});window.addEventListener("offline",()=>{l(this,"online-state",{isOnline:!1})});window.addEventListener("hashchange",()=>{l(this,"hashchange",{location:location.toString()})});
document.addEventListener("backbutton",()=>{l(this,"backbutton")})}je(a){alert(a.message)}ke(){navigator.app&&navigator.app.exitApp?navigator.app.exitApp():navigator.device&&navigator.device.exitApp?navigator.device.exitApp():window.close()}me(a){a=a.isFocus;if("nwjs"===this.G){const b="nwjs"===this.G?nw.Window.get():null;a?b.focus():b.blur()}else a?window.focus():window.blur()}});
